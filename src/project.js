window.__require=function e(t,o,n){function i(r,s){if(!o[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}}var u=o[r]={exports:{}};t[r][0].call(u.exports,function(e){return i(t[r][1][e]||e)},u,u.exports,e,t,o,n)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({ADSNode:[function(e,t,o){"use strict";cc._RF.push(t,"9e3ce7Wn7BBB4gI/6vr8m6Z","ADSNode");var n=e("sdk"),i=-1;cc.Class({extends:cc.Component,properties:{btn:cc.Node,icon:cc.Sprite,_intervalTime:0},onLoad:function(){this.node.scale;this.btn.runAction(cc.sequence(cc.delayTime(2),cc.rotateBy(.05,-15),cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.rotateBy(.1,15)).repeatForever()),this.btn.active="undefined"==typeof wx,this.btn.on("touchend",this._btnCallback,this)},onDestroy:function(){this.btn.off("touchend",this._btnCallback,this)},start:function(){var e=this;"undefined"!=typeof wx&&(this.showAds(),this.schedule(function(){e.showAds()},WxSDK.insideAds_refresh_time))},showAds:function(){var e=this;this._showInsideAds(!1,this.icon,function(){e.btn.active=!0},function(){e.btn.active=!1})},hideAds:function(){this.btn.active=!1},_btnCallback:function(){var e=this;this._showInsideAds(!0,this.icon,function(){e.btn.active=!0},function(){e.btn.active=!1})},_showInsideAds:function(e,t,o,a){var r=this;if(e){var s=n.insideAds.list[i],c=function(e){Server.reportClick(s.id,e)};1===s.qrcode_flag?n.showImage(s.qrcode_url,function(){c("get_list_scan")}):SDK.showInsideAds(s,function(){c("get_list")})}else(function(){if(n.insideAds.hasAds()||"undefined"==typeof wx){var e=n.insideAds.list;o&&o(),i=-1===i?0:(i+1)%e.length,r.loadImage(t,e[i].icon,function(){})}else a()})()},loadImage:function(e,t,o){var n=e.getComponent(cc.Sprite)||e;if("undefined"!=typeof wx){var i=t+"?a=a.png",a=wx.createImage();a.onload=function(){var e=new cc.Texture2D;e.initWithElement(a),e.handleLoadedTexture(),n.spriteFrame=new cc.SpriteFrame(e),o&&o()},a.src=i}}}),cc._RF.pop()},{sdk:"sdk"}],ActionBase:[function(e,t,o){"use strict";cc._RF.push(t,"7a086h524pCQrE7roC3hYRD","ActionBase"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./UnitBase");(function(e){e[e.NONE=0]="NONE",e[e.SCALE=1]="SCALE",e[e.VIBRATE=2]="VIBRATE",e[e.JELLY=3]="JELLY",e[e.FLIP_X=4]="FLIP_X",e[e.FLIP_Y=5]="FLIP_Y",e[e.FADE=6]="FADE",e[e.JUMP=7]="JUMP",e[e.FLOAT_Y=8]="FLOAT_Y",e[e.SHAKE_X=9]="SHAKE_X",e[e.MOVE_X=10]="MOVE_X",e[e.ROTATION=11]="ROTATION"})(n=o.NodeActionType||(o.NodeActionType={}));var a=["_noneAction","_scaleAction","_vibrateAction","_jellyAction","_flipXAction","_flipYAction","_fadeAction","_jumpAction","_floatYAction","_shakeXAction","_moveXAction","_rotationAction"],r=cc._decorator,s=r.ccclass,c=r.property,l=(r.executeInEditMode,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeActionType=n.NONE,t.loop=-1,t.spaceTime=0,t.rangeScale=1,t.speed=1,t.playOnLoad=!0,t.callbacks=[],t._overCallbacks=[],t._action=null,t._baseScale=1,t._baseX=0,t._baseY=0,t._baseRotation=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.getComponent(cc.Widget)&&this.node.getComponent(cc.Widget).updateAlignment(),this._baseScale=this.node.scale,this._baseX=this.node.x,this._baseY=this.node.y,this._baseRotation=this.node.degrees,this.playOnLoad&&this.playAction()},t.prototype.onEnable=function(){},t.prototype.playAction=function(e,t,o,n,i){var r=this;void 0!==e&&(this.nodeActionType=e),void 0!==t&&(this.loop=t),void 0!==o&&(this.spaceTime=o),void 0!==n&&(this.rangeScale=n),void 0!==i&&(this.speed=i),this.rangeScale<0&&(this.rangeScale=0),this.stopAction();var s,c=this[a[this.nodeActionType]](),l=cc.sequence(c.concat([cc.delayTime(this.spaceTime),cc.callFunc(function(e){r._actionOver()})]));-1===this.loop?s=cc.speed(l.repeatForever(),this.speed):0===this.loop?s=cc.speed(l,this.speed):this.loop>0&&(s=cc.speed(l.repeat(this.loop),this.speed)),this.node.runAction(s),this._action=s},t.prototype.setActionOverCallback=function(e,t){this._overCallbacks.push({callback:e,target:t})},t.prototype.stopAction=function(e){void 0===e&&(e=!0),this.node.stopAllActions(),e&&(this.node.x=this._baseX,this.node.y=this._baseY,this.node.scale=this._baseScale,this.node.angle=this._baseRotation)},t.prototype._actionOver=function(){if(this.callbacks.length>0&&cc.Component.EventHandler.emitEvents(this.callbacks,this),this._overCallbacks.length>0)for(var e=0,t=this._overCallbacks;e<t.length;e++){var o=t[e];o.target?o.callback.call(o.target):o.callback()}},t.prototype._noneAction=function(){},t.prototype._scaleAction=function(){var e=this.rangeScale,t=this._baseScale;return[cc.scaleTo(.2,t+.06*t*e),cc.scaleTo(.2,t),cc.scaleTo(.2,t-.06*t*e),cc.scaleTo(.2,t)]},t.prototype._vibrateAction=function(){var e=15*this.rangeScale;return[cc.rotateBy(.05,-e),cc.rotateBy(.1,e),cc.rotateBy(.1,-e),cc.rotateBy(.1,e),cc.rotateBy(.1,-e),cc.rotateBy(.1,e)]},t.prototype._jellyAction=function(){var e=this.rangeScale,t=this._baseScale;return[cc.scaleTo(.1,t+.2*t*e,t-.2*t*e),cc.scaleTo(.1,t-.2*t*e,t+.2*t*e),cc.scaleTo(.15,t+.1*t*e,t-.1*t*e),cc.scaleTo(.15,t-.1*t*e,t+.1*t*e),cc.scaleTo(.18,t+.05*t*e,t-.05*t*e),cc.scaleTo(.18,t-.05*t*e,t+.05*t*e),cc.scaleTo(.19,t+.02*t*e,t-.02*t*e),cc.scaleTo(.19,t-.02*t*e,t+.02*t*e),cc.scaleTo(.2,t,t)]},t.prototype._flipXAction=function(){var e=this._baseScale;return[cc.scaleTo(.2,-e,e),cc.scaleTo(.2,e,e)]},t.prototype._flipYAction=function(){var e=this._baseScale;return[cc.scaleTo(.2,e,-e),cc.scaleTo(.2,e,e)]},t.prototype._fadeAction=function(){return[cc.fadeTo(1,0),cc.fadeTo(1,255)]},t.prototype._jumpAction=function(){return[cc.jumpBy(.5,cc.v2(0,0),100*this.rangeScale,1)]},t.prototype._floatYAction=function(){var e=this.rangeScale,t=this._baseX,o=this._baseY;return[cc.moveTo(1,t,o+100*e),cc.moveTo(2,t,o-100*e),cc.moveTo(1,t,o)]},t.prototype._shakeXAction=function(){var e=this.rangeScale,t=this._baseX,o=this._baseY;return[cc.moveTo(.05,t-10*e,o),cc.moveTo(.1,t+10*e,o),cc.moveTo(.1,t-10*e,o),cc.moveTo(.1,t+10*e,o),cc.moveTo(.05,t,o)]},t.prototype._moveXAction=function(){var e=this.rangeScale,t=this._baseX,o=this._baseY;return[cc.moveTo(.5,t-50*e,o),cc.moveTo(1,t+50*e,o),cc.moveTo(.5,t,o)]},t.prototype._rotationAction=function(){var e=this.rangeScale;this._baseRotation;return[cc.rotateBy(1,10*e)]},__decorate([c({type:cc.Enum(n),tooltip:"SCALE: \u547c\u5438\u7f29\u653e\n\n            VIBRATE: \u5de6\u53f3\u6296\u52a8\n\n            JELLY: \u679c\u51bb\u6296\u52a8\n\n            FLIP_X: x\u8f74\u7ffb\u8f6c\n\n            FLIP_Y: y\u8f74\u7ffb\u8f6c\n\n            FADE: \u547c\u5438\u663e\u9690\n\n            JUMP: \u8df3\u52a8\u6548\u679c\n\n            FLOAT_Y: \u4e0a\u4e0b\u6d6e\u52a8\n\n            SHAKE_X: \u5de6\u53f3\u6643\u52a8\n\n            MOVE_X:\u5de6\u53f3\u79fb\u52a8\n\n            ROTATION:\u65cb\u8f6c"})],t.prototype,"nodeActionType",void 0),__decorate([c({tooltip:"-1\u8868\u793a\u5faa\u73af\u64ad\u653e\uff0c0\u8868\u793a\u5355\u6b21\u64ad\u653e\uff0c>0\u8868\u793a\u64ad\u653e\u6b21\u6570"})],t.prototype,"loop",void 0),__decorate([c({tooltip:"\u4e24\u6b21\u52a8\u4f5c\u4e4b\u95f4\u7684\u65f6\u95f4\u95f4\u9694"})],t.prototype,"spaceTime",void 0),__decorate([c({tooltip:"\u52a8\u4f5c\u5e45\u5ea6\u63a7\u5236"})],t.prototype,"rangeScale",void 0),__decorate([c({tooltip:"\u63a7\u5236\u52a8\u4f5c\u6574\u4f53\u901f\u7387"})],t.prototype,"speed",void 0),__decorate([c({tooltip:"\u662f\u5426\u521b\u5efa\u65f6\u5c31\u64ad\u653e\u52a8\u753b"})],t.prototype,"playOnLoad",void 0),__decorate([c],t.prototype,"callbacks",void 0),t=__decorate([s],t)}(i.default));o.default=l,cc._RF.pop()},{"./UnitBase":"UnitBase"}],AniManager:[function(e,t,o){"use strict";cc._RF.push(t,"88519IFbOZNM5SVRuC8qz5g","AniManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/UnitBase"),i=e("../../submodule/pp/PP"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boomAniPrefab=null,t.flashAniPrefab=null,t.flashCrashAniPrefab=null,t._poolMng=new Map,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){this.initPool()},t.prototype.initPool=function(){this.boomAniPool=new i.pp.NodePoolExtend(0),this.flashAniPool=new i.pp.NodePoolExtend(0),this.flashCrashAniPool=new i.pp.NodePoolExtend(0),this._poolMng.set("boom",this.boomAniPool),this._poolMng.set("flash",this.flashAniPool),this._poolMng.set("flashCrash",this.flashCrashAniPool),this.boomAniPool.create(this.boomAniPrefab,25),this.flashAniPool.create(this.flashAniPrefab,20),this.flashCrashAniPool.create(this.flashCrashAniPrefab,20)},t.prototype.playAni=function(e,t,o){void 0===o&&(o=1);var n=this._poolMng.get(e),i=n.get().getComponent(dragonBones.ArmatureDisplay);return i.addEventListener(dragonBones.EventObject.COMPLETE,function(){i.removeEventListener(dragonBones.EventObject.COMPLETE),n.put(i.node)}),i.playAnimation(t,o),i},__decorate([s(cc.Prefab)],t.prototype,"boomAniPrefab",void 0),__decorate([s(cc.Prefab)],t.prototype,"flashAniPrefab",void 0),__decorate([s(cc.Prefab)],t.prototype,"flashCrashAniPrefab",void 0),t=__decorate([r],t)}(n.default);o.default=c,cc._RF.pop()},{"../../submodule/component/UnitBase":"UnitBase","../../submodule/pp/PP":"PP"}],Base64:[function(e,t,o){"use strict";cc._RF.push(t,"479f6Y5eANDY6JJr/6ehs1W","Base64");var n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,o,i,a,r,s,c,l="",u=0;for(e=n._utf8_encode(e);u<e.length;)a=(t=e.charCodeAt(u++))>>2,r=(3&t)<<4|(o=e.charCodeAt(u++))>>4,s=(15&o)<<2|(i=e.charCodeAt(u++))>>6,c=63&i,isNaN(o)?s=c=64:isNaN(i)&&(c=64),l=l+this._keyStr.charAt(a)+this._keyStr.charAt(r)+this._keyStr.charAt(s)+this._keyStr.charAt(c);return l},decode:function(e){var t,o,i,a,r,s,c="",l=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(a=this._keyStr.indexOf(e.charAt(l++)))>>4,o=(15&a)<<4|(r=this._keyStr.indexOf(e.charAt(l++)))>>2,i=(3&r)<<6|(s=this._keyStr.indexOf(e.charAt(l++))),c+=String.fromCharCode(t),64!=r&&(c+=String.fromCharCode(o)),64!=s&&(c+=String.fromCharCode(i));return c=n._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t,o="",n=0,i=0,a=0;n<e.length;)(i=e.charCodeAt(n))<128?(o+=String.fromCharCode(i),n++):i>191&&i<224?(a=e.charCodeAt(n+1),o+=String.fromCharCode((31&i)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),t=e.charCodeAt(n+2),o+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&t),n+=3);return o}};window.Base64=t.exports=n,cc._RF.pop()},{}],Block:[function(e,t,o){"use strict";cc._RF.push(t,"61ae2JkvL9Di50un+iCy/8U","Block"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/UnitBase"),i=e("../../submodule/utils/ClassModule"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=new i.SpriteToggle,t.light=null,t.colorIdx=0,t.prop=null,t}return __extends(t,e),t.getCrashAniName=function(e){return 0===e?["purple","particle5"]:1===e?["green","particle3"]:2===e?["blue","particle4"]:3===e?["yellow","particle2"]:4===e?["red","particle"]:void 0},t.prototype.onLoad=function(){this.actionOrder=999,this.light.opacity=0},t.prototype.turnProjection=function(e){this.opacity=100,this.sprite.turn(e),this.zIndex=1,this.colorIdx=e},t.prototype.turnFade=function(){this.opacity=100,this.sprite.sprite.color=cc.Color.BLACK,this.scale=1.1,this.zIndex=5},t.prototype.turnNormal=function(e){this.opacity=255,this.sprite.turn(e),this.zIndex=2,this.colorIdx=e},t.prototype.turnColor=function(e){this.sprite.turn(e)},t.prototype.showLight=function(){this.light.opacity=100,this.light.runAction(cc.sequence(cc.fadeIn(.2),cc.fadeOut(.2)))},t.prototype.turnGray=function(e){this.sprite.sprite.setState(e?cc.Sprite.State.GRAY:cc.Sprite.State.NORMAL)},t.prototype.reuse=function(){this.actionOrder=999},t.prototype.unuse=function(){this.opacity=255,this.scale=1,this.actionOrder=999,this.sprite.sprite.color=cc.Color.WHITE,this.zIndex=0,this.turnGray(!1),this.light.stopAllActions(),this.light.opacity=0},__decorate([s(i.SpriteToggle)],t.prototype,"sprite",void 0),__decorate([s(cc.Node)],t.prototype,"light",void 0),t=__decorate([r],t)}(n.default);o.default=c,cc._RF.pop()},{"../../submodule/component/UnitBase":"UnitBase","../../submodule/utils/ClassModule":"ClassModule"}],CCActionConvert:[function(e,t,o){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}cc._RF.push(t,"ca370U0AUpEE6NVXq/RzmRW","CCActionConvert"),cc.FloatBy=cc.Class({name:"cc.FloatBy",extends:cc.ActionInterval,ctor:function(e,t,o,n){this._deltaValue=o,this._startValue=t,this._previousValue=t,this._curValue=t,this._callback=n,this._args=arguments,cc.FloatBy.prototype.initWithDuration.call(this,e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.FloatBy,[null].concat(n(this._args))));return this._cloneDecoration(e),e.initWithDuration(this._duration),e},update:function(e){e=this._computeEaseTime(e);var t=this._deltaValue*e,o=this._startValue;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var n=this._curValue;t+=o+=n-this._previousValue,this._previousValue=t,this._curValue=t,this._callback&&this._callback(this._curValue,t-n)}else this._callback&&this._callback(o+t)},reverse:function(){var e=new cc.FloatBy(this._duration,this._startValue,-this._deltaValue,this._callback);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.floatBy=function(e,t,o,n){return new cc.FloatBy(e,t,o,n)},cc.FloatTo=cc.Class({name:"cc.FloatTo",extends:cc.FloatBy,ctor:function(e,t,o,n){this._startValue=t,this._endValue=o,this._deltaValue=this._endValue-this._startValue,this._curValue=t,this._previousValue=t,this._callback=n,this._args=arguments,this.initWithDuration(e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.FloatTo,[null].concat(n(this._args))));this._cloneDecoration(e),e.initWithDuration(this._duration)}}),cc.floatTo=function(e,t,o,n){return new cc.FloatTo(e,t,o,n)},cc.CircleBy=cc.Class({name:"cc.CircleBy",extends:cc.ActionInterval,ctor:function(e,t,o,n,i){this._center=t,this._radius=o,this._deltaDegress=i,this._startDegress=n,this._previousDegress=n,this._curDegress=n,this._args=arguments,cc.CircleBy.prototype.initWithDuration.call(this,e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.CircleBy,[null].concat(n(this._args))));return this._cloneDecoration(e),e.initWithDuration(this._duration),e},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=this._deltaDegress*e,o=this._startDegress;if(cc.macro.ENABLE_STACKABLE_ACTIONS){t+=o+=this._curDegress-this._previousDegress,this._previousDegress=t,this._curDegress=t;var n=cc.misc.degreesToRadians(this._curDegress),i=this._center.x+Math.sin(n)*this._radius,a=this._center.y+Math.cos(n)*this._radius;this.target.position=cc.v2(i,a)}else{this._curDegress=o+t;var r=cc.misc.degreesToRadians(this._curDegress),s=this._center.x+Math.sin(r)*this._radius,c=this._center.y+Math.cos(r)*this._radius;this.target.position=cc.v2(s,c)}}},reverse:function(){var e=new cc.CircleBy(this._duration,this._center,this._radius,this._startDegress,-this._deltaDegress);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.circleBy=function(e,t,o,n,i){return new cc.CircleBy(e,t,o,n,i)},cc.CircleTo=cc.Class({name:"cc.CircleTo",extends:cc.CircleBy,ctor:function(e,t,o,n,i){this._center=t,this._radius=o,this._deltaDegress=i-n,this._startDegress=n,this._previousDegress=n,this._curDegress=n,this._args=arguments,this.initWithDuration(e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.CircleTo,[null].concat(n(this._args))));return this._cloneDecoration(e),e.initWithDuration(this._duration),e}}),cc.circleTo=function(e,t,o,n,i){return new cc.CircleTo(e,t,o,n,i)},cc._RF.pop()},{}],CCConvert:[function(e,t,o){"use strict";cc._RF.push(t,"61878f49S1CvKElr8guI1nM","CCConvert");var n=a(e("../utils/FileUtils")),i=a(e("../utils/SoundUtils"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperties(cc.Node.prototype,{xy:{get:function(){return this.position},set:function(e){this.position=e},configurable:!0},realWidth:{get:function(){return Math.abs(this.width*this.scaleX)},configurable:!0},realHeight:{get:function(){return Math.abs(this.height*this.scaleY)},configurable:!0},degrees:{get:function(){return this.angle},set:function(e){this.angle=e},configurable:!0}}),cc.Node.prototype.pauseSelf=function(e){if(this.active){this.getNumberOfRunningActions()>0&&(e?this.pauseAllActions():this.resumeAllActions());var t=this.getComponent(cc.Animation);t&&(e?t.pause():t.resume()),e?this.pauseSystemEvents(!0):this.resumeSystemEvents(!0)}},cc.Node.prototype.removeSelf=function(){this.parent&&this.removeFromParent(),this.destroy()},cc.Node.prototype.checkHit=function(e,t){return this._hitTest(e,t)},cc.Sprite.prototype.setURL=function(e,t){var o=this;this._url=e,null!==e?n.default.getSpriteFrameAsync(e,function(e){o.spriteFrame=e,t&&t(e,o)}):this.spriteFrame=null},cc.Sprite.prototype._url=null,Object.defineProperties(cc.Sprite.prototype,{url:{get:function(){return this._url},set:function(e){null!==e?this.setURL(e.url,e.callback):this.setURL(null)},configurable:!0}}),cc.Sprite.prototype.uniformScale=function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.spriteFrame,i=this.node;if(n&&i){this.sizeMode=cc.Sprite.SizeMode.CUSTOM;var a=n.getRect().width,r=n.getRect().height,s=a/e,c=r/t;if(!o&&(s>1||c>1))return i.width=a,void(i.height=r);s>=c?(i.width=a/s,i.height=r/s):(i.width=a/c,i.height=r/c)}},cc.Sprite.prototype.geometricScale=function(e,t){var o=this.spriteFrame,n=this.node;if(o&&n){var i=e/o.getRect().width,a=t/o.getRect().height;i>=a?(n.scaleX=a,n.scaleY=a):(n.scaleX=i,n.scaleY=i)}},cc.Button.prototype._onTouchBegan=function(e){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),e.stopPropagation(),i.default.playSFX("ButtonClick"))};var r=function(e,t){Object.defineProperty(e,t,{configurable:!0,get:function(){return this.node?this.node[t]:null},set:function(e){this.node&&(this.node[t]=e)}})},s=function(e,t){Object.defineProperty(e,t,{get:function(){return this.node?this.node[t]:null},configurable:!0})},c=!0,l=!1,u=void 0;try{for(var h,d=["x","y","z","rotationX","rotationY","scale","scaleX","scaleY","scaleZ","skewX","skewY","opacity","color","anchorX","anchorY","children","childrenCount","zIndex","active","activeInHierarchy","width","height","position","xy","parent","degrees"][Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value;r(cc.Component.prototype,p),r(cc.Label.prototype,p),r(cc.Sprite.prototype,p)}}catch(e){l=!0,u=e}finally{try{!c&&d.return&&d.return()}finally{if(l)throw u}}var f=!0,_=!1,g=void 0;try{for(var v,m=["realWidth","realHeight"][Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var y=v.value;s(cc.Component.prototype,y),s(cc.Label.prototype,y),s(cc.Sprite.prototype,y)}}catch(e){_=!0,g=e}finally{try{!f&&m.return&&m.return()}finally{if(_)throw g}}var S=!0,w=!1,b=void 0;try{for(var C,P=["addChild","getChildByName","removeFromParent","removeChild","removeAllChildren","on","once","off","targetOff","runAction","pauseAllActions","resumeAllActions","stopAllActions","stopAction","convertToNodeSpace","convertToNodeSpaceAR","convertToWorldSpace","convertToWorldSpaceAR","removeSelf","pauseSelf"][Symbol.iterator]();!(S=(C=P.next()).done);S=!0)C.value}catch(e){w=!0,b=e}finally{try{!S&&P.return&&P.return()}finally{if(w)throw b}}cc.Mask.prototype.drawRect=function(e,t,o,n){var i=this._graphics;i.rect(e,t,o,n),i.fill()};var E=[];cc.Mask.prototype.drawCircle=function(e,t,o){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,i=this._graphics,a=function(e,t,o){E.length=0;for(var n=2*Math.PI/o,i=0;i<o;++i){var a=cc.v2(t.x*Math.cos(n*i)+e.x,t.y*Math.sin(n*i)+e.y);E.push(a)}return E}(cc.v2(e,t),o,n),r=0;r<a.length;++r){var s=a[r];0===r?i.moveTo(s.x,s.y):i.lineTo(s.x,s.y)}i.close(),i.fill()},cc.Mask.prototype.clearDraw=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._graphics.clear(e)},cc._RF.pop()},{"../utils/FileUtils":"FileUtils","../utils/SoundUtils":"SoundUtils"}],ClassModule:[function(e,t,o){"use strict";cc._RF.push(t,"6485dWPT8NOcpwQyoLyJfrs","ClassModule"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../data/LanguageHandler"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(){function e(){this.sprite=null,this.spriteFrameList=[]}return Object.defineProperty(e.prototype,"node",{get:function(){return this.sprite?this.sprite.node:null},enumerable:!0,configurable:!0}),e.prototype.turn=function(e){e>=this.spriteFrameList.length||!this.sprite||(this.sprite.spriteFrame=null,this.sprite.spriteFrame=this.spriteFrameList[e])},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=0,n=e[0]instanceof Array?e[0]:e;o<n.length;o++){var i=n[o];this.spriteFrameList.push(i)}},__decorate([r(cc.Sprite)],e.prototype,"sprite",void 0),__decorate([r({visible:!1})],e.prototype,"node",null),__decorate([r([cc.SpriteFrame])],e.prototype,"spriteFrameList",void 0),e=__decorate([a("SpriteToggle")],e)}();o.SpriteToggle=s;var c=function(){function e(){this.label=null,this.stringList=[]}return Object.defineProperty(e.prototype,"node",{get:function(){return this.label?this.label.node:null},enumerable:!0,configurable:!0}),e.prototype.turn=function(e,t){if(void 0===t&&(t=!1),!(e>=this.stringList.length)&&this.label){var o=this.stringList[e];this.label.string=t?n.LanguageHandler.getLanguageData(o):o}},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=0,n=e[0]instanceof Array?e[0]:e;o<n.length;o++){var i=n[o];this.stringList.push(i)}},__decorate([r(cc.Label)],e.prototype,"label",void 0),__decorate([r([cc.String])],e.prototype,"stringList",void 0),__decorate([r({visible:!1})],e.prototype,"node",null),e=__decorate([a("LabelToggle")],e)}();o.LabelToggle=c;var l=function(){function e(){this.sprite=null,this.label=null}return e.prototype.turn=function(e){this.sprite.node.active=1===e,this.label.node.active=1===e},__decorate([r(cc.Sprite)],e.prototype,"sprite",void 0),__decorate([r(cc.Label)],e.prototype,"label",void 0),e=__decorate([a("FontToggle")],e)}();o.FontToggle=l,cc._RF.pop()},{"../data/LanguageHandler":"LanguageHandler"}],CommonNode:[function(e,t,o){"use strict";cc._RF.push(t,"d00edohh4JEM4xF6dYbBw2B","CommonNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/component/SwitchNode"),i=e("../submodule/pp/PP"),a=e("../submodule/utils/FileUtils"),r=e("./Common"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.switchLayer=null,t.fakeADS=null,t.drawCallsLabel=null,t.testButton=null,t._toastPool=null,t._toastStack=[],t._toastWaiting=!1,t._loadingNode=null,t}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){var e=this;cc.game.isPersistRootNode(this.node)||cc.game.addPersistRootNode(this.node),o.Instant=this,this.node.zIndex=999,this.fakeADS.zIndex=999,this.drawCallsLabel.active=DEBUG,this.testButton.active=DEBUG,setInterval(function(){e.runUpdate()},20),this.init()},t.prototype.init=function(){var e=this;this.switchLayer&&(this.switchLayer.active=!1),this._toastPool=new i.pp.NodePoolExtend(0,"ToastBase"),a.default.getPrefabAsync("module/toast/toastNode",function(t){e._toastPool.create(t,5)}),a.default.getPrefabAsync("module/loading/loadingNode",function(t){var o=cc.instantiate(t);e.node.addChild(o),o.active=!1,e._loadingNode=o.getComponent("LoadingNodeBase")})},t.prototype.loadScene=function(e,t,o){this.switchLayer.loadScene(e,t,o)},t.prototype.showToast=function(e,t,o){this._toastStack.push({str:e,duration:t,type:o})},t.prototype.showLoading=function(e,t){this._loadingNode.showLoading(e,t)},t.prototype.hideLoading=function(e){this._loadingNode.hideLoading(e)},t.prototype.showFakeADS=function(){DEBUG&&this.fakeADS&&(this.fakeADS.opacity=255)},t.prototype.hideFakeADS=function(){DEBUG&&this.fakeADS&&(this.fakeADS.opacity=0)},t.prototype.buttonCallback=function(e,t){switch(t){case"debug":break;case"test":var o=cc.find("Canvas").getChildByName("testPanel");o?(o.removeSelf(),this.testButton.getChildByName("Label").getComponent(cc.Label).string="\u6d4b"):(r.Common.popPanel({name:"panel/testPanel"}),this.testButton.getChildByName("Label").getComponent(cc.Label).string="\u5173")}},t.prototype.runUpdate=function(){var e=this;if(this.drawCallsLabel.active&&(this.drawCallsLabel.string=cc.renderer.drawCalls+""),this._toastStack.length>0&&!this._toastWaiting){this._toastWaiting=!0;var t=this._toastStack[0],o=this._toastPool.getWithComponent();this.node.addChild(o.node),o.show(t.str,t.duration,t.type),this.scheduleOnce(function(){e._toastStack.shift(),e._toastWaiting=!1},1.4*o.waitTime)}},t.prototype.showRewardAni=function(e,t,o,n,i,a,r,s,c){var l=this;r&&r(a),s&&s(i);var u=a/t,h=i,d=0;t.doNFunc(function(r){var p=e.get();p.parent||(p.parent=l.node),p.zIndex=50,p.xy=o;var f=l._getAroundPos(o),_=f.sub(n).mag()/500;p.runAction(cc.sequence(cc.moveTo(.5,f).easing(cc.easeIn(.5)),cc.moveTo(_,n),cc.callFunc(function(o){h+=u,e.put(p),s&&s(h),++d===t&&(s&&s(i+a),c&&c())})))})},t.prototype._getAroundPos=function(e,t){void 0===t&&(t=100);var o=cc.v2(Math.getRandom(-1,1),Math.getRandom(-1,1)).normalize(),n=Math.getRandom(-t,t);return o.mul(n).add(e)},t.Instant=null,__decorate([l(n.default)],t.prototype,"switchLayer",void 0),__decorate([l(cc.Node)],t.prototype,"fakeADS",void 0),__decorate([l(cc.Label)],t.prototype,"drawCallsLabel",void 0),__decorate([l(cc.Node)],t.prototype,"testButton",void 0),t=o=__decorate([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../submodule/component/SwitchNode":"SwitchNode","../submodule/pp/PP":"PP","../submodule/utils/FileUtils":"FileUtils","./Common":"Common"}],Common:[function(e,t,o){"use strict";cc._RF.push(t,"26653ikz5JIHrxkdd4i/aHE","Common"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./CommonNode"),i=e("../submodule/data/LanguageHandler"),a=e("../submodule/utils/FileUtils"),r=e("../submodule/utils/EventCenter"),s=e("./Define");o.Common={toast:function(e,t,o){n.default.Instant.showToast(e,t,o)},toastCode:function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.toast(i.LanguageHandler.getLanguageDataWithArgs.apply(i.LanguageHandler,[e].concat(t)))},toastDev:function(){this.toastCode("dev-state")},delayToast:function(e,t){var o=this;setTimeout(function(t){o.toast(e)},t)},showLoading:function(e,t){var o;(o=n.default.Instant).showLoading.apply(o,arguments)},hideLoading:function(e){n.default.Instant.hideLoading(e)},loadScene:function(e,t,o){n.default.Instant.loadScene(e,t,o)},popPanel:function(e){r.default.post(s.EventMsg.POP_LAYER,e)},createTypeNode:function(e,t){var o=new cc.Node;return e&&e.addChild(o),o.addComponent(t)},jumpLabel:function(e,t,o){void 0===o&&(o=!0),e.node&&t.toString()!==e.string&&(e.string=String(t),e.node.stopAllActions(),e.node.scale=1,o&&e.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))))},getDateTime:function(){return(new Date).getTime()},getDateTimeTest:function(){return(new Date).getTime()},loadRemoteImage:function(e,t,o,n){var i;i=e.getComponent(cc.Sprite)?e.getComponent(cc.Sprite):e.addComponent(cc.Sprite),cc.loader.load(t,function(e,t){if(e)return console.log("err:",e),void(n&&n());i.spriteFrame=new cc.SpriteFrame(t),o&&o(i)})},loadRemoteImageWithType:function(e,t,o,n,i){var a;a=e.getComponent(cc.Sprite)?e.getComponent(cc.Sprite):e.addComponent(cc.Sprite),cc.loader.load({url:t,type:o},function(e,t){if(e)return console.log("err:",e),void(i&&i());a.spriteFrame=new cc.SpriteFrame(t),n&&n(a)})},loadJsonAni:function(e,t){var o=a.default.getUrlWithoutAsp(t),n=o+".json";return new Promise(function(e,t){cc.loader.load(n,function(o,n){return o?t():n?e(n):t()})}).then(function(t){return new Promise(function(e,n){var i=o+".png";cc.loader.load(i,function(o,i){return o?n():i?e({json:t,png:i}):n()})}).then(function(t){var o,n=t.json,i=t.png,a=n.mc.gif.frames.map(function(e){var t=n.res[e.res];return new cc.SpriteFrame(i,cc.rect(t.x,t.y,t.w,t.h),!1,cc.v2(e.x,e.y),cc.size(t.w,t.h))});o=e.getComponent(cc.Animation)?e.getComponent(cc.Animation):e.addComponent(cc.Animation),e.getComponent(cc.Sprite)||e.addComponent(cc.Sprite);var r=n.mc.gif.frameRate,s=cc.AnimationClip.createWithSpriteFrames(a,r);return s.name="ani_frame",s.wrapMode=cc.WrapMode.Loop,o.addClip(s),o.play("ani_frame"),e})},function(){return new Promise(function(e,o){cc.loader.load(t,function(n,i){return n?(console.log("pngErr1:",n),void cc.loader.load({url:t,type:"png"},function(t,n){return t?(console.log("pngErr2:",t),o()):n?e(n):o()})):i?e(i):o()})}).then(function(t){var o=e.getComponent(cc.Sprite);return o||(o=e.addComponent(cc.Sprite)),o.spriteFrame=new cc.SpriteFrame(t),e},function(){})})}},cc._RF.pop()},{"../submodule/data/LanguageHandler":"LanguageHandler","../submodule/utils/EventCenter":"EventCenter","../submodule/utils/FileUtils":"FileUtils","./CommonNode":"CommonNode","./Define":"Define"}],ConfigHandler:[function(e,t,o){"use strict";cc._RF.push(t,"61d74JrrW1B4ou4DLI3mQm9","ConfigHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/FileUtils"),i=function(){function e(){this._configURLList=[],this._config=null}return e.prototype.onInit=function(){},e.prototype.loadConfig=function(){if(this._configURLList.length>0){for(var e={},t=0,o=this._configURLList;t<o.length;t++){var i=o[t],a=n.default.getConfigByName(i);e[i]=a}this._config=e,this.onLoadConfig(e)}else this.onLoadConfig(null)},e.prototype.onLoadConfig=function(e){},e.prototype.onLoadOver=function(){},e.prototype.getConfig=function(){return this._config},e.prototype.getConfigByKey=function(e){return this._config[e]},e}();o.default=i,cc._RF.pop()},{"../utils/FileUtils":"FileUtils"}],CouponAni:[function(e,t,o){"use strict";cc._RF.push(t,"979719VQdJIk6gDCGyInGbB","CouponAni"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../GameManager"),i=e("../../submodule/pp/PP"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this,t=cc.find("Canvas").getComponent(n.default).gameLayer.gameUI.couponButton,o=i.pp.getNodePos(t,this.node.parent);this.node.scale=0,this.node.runAction(cc.sequence(cc.scaleTo(.25,1).easing(cc.easeElasticOut(.6)),cc.delayTime(.5),cc.spawn(cc.moveTo(.3,o),cc.scaleTo(.3,.1)),cc.callFunc(function(t){e.node.removeSelf()})))},t=__decorate([r],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../submodule/pp/PP":"PP","../GameManager":"GameManager"}],DataHandler:[function(e,t,o){"use strict";cc._RF.push(t,"3b9f4WA4+pB+KF9Ec4+BSG9","DataHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/StorageUtils"),i=e("./ConfigHandler"),a=e("../utils/Base64"),r=function(e){function t(){var o=e.call(this)||this;return o._tableData=null,o._tableCopy=null,o._storageData=null,o._storageCopy=null,o.serverKeyList=[],o.serverKey=null,t.HandlerList.push(o),o.onInit(),o}return __extends(t,e),t.prototype.onDataLoadOver=function(){},t.prototype.onServerLoadOver=function(){},t.prototype.initTableData=function(e){if(e){this._tableCopy=e;var t={};for(var o in e){var n=e[o];"object"==typeof n&&void 0!==n.default?void 0!==n.secretType?(t[o]=a.encode(n.default.toString()),n.saveServer&&this.serverKeyList.push("_"+o)):(t[o]=n.default,n.saveServer&&this.serverKeyList.push(o)):t[o]=n}this._tableData=this._initTableData(this._tableKey,t),this.mergeTableProp()}},t.prototype.mergeTableProp=function(){var e=function(e){var o,n=t._tableCopy[e];if("object"==typeof n&&void 0!==n.secretType){var i=n.secretType,a="_"+e;Object.defineProperties(t,((o={})[a]={get:function(){return this._tableData[e]},set:function(t){this._tableData[e]=t}},o[e]={get:function(){return"number"===i?this._getSecretNumber(this[a]):"string"===i?this._getSecretString(this[a]):"boolean"===i?this._getSecretBool(this[a]):"object"===i?this._getSecretObject(this[a]):void 0},set:function(e){this[a]="object"!==i?this._setSecret(e):this._setSecretObject(e)}},o))}else Object.defineProperty(t,e,{get:function(){return this._tableData[e]},set:function(t){this._tableData[e]=t}})},t=this;for(var o in this._tableData)e(o)},t.prototype.getTable=function(){return this._tableData},t.prototype.saveTableData=function(){this._tableKey&&this._tableData&&n.default.setDataAsync(this._tableKey,this._tableData)},t.prototype.removeTableData=function(){this._tableKey&&this._tableData&&(n.default.removeData(this._tableKey),this._tableData=null)},t.prototype.removeStorageData=function(){if(this._storageData){for(var e in this._storageData)n.default.removeData(e);this._storageData=null}},t.prototype.initStorageData=function(e,t){if(void 0===t&&(t=!0),e)for(var o in this._storageCopy=e,this._storageData={},e){var n=e[o],i=void 0;"object"==typeof n&&void 0!==n.default?void 0!==n.secretType?(i=a.encode(n.default.toString()),n.saveServer&&this.serverKeyList.push("_"+o)):(i=n.default,n.saveServer&&this.serverKeyList.push(o)):i=n;var r=this._initStorage(o,i);this._storageData[o]=r,this.mergeStorageProp(o,t)}},t.prototype.mergeStorageProp=function(e,t){var o;if(e){var n=this._storageCopy[e];if("object"==typeof n&&void 0!==n.secretType){var i=n.secretType,a="_"+name;Object.defineProperties(this,((o={})[a]={get:function(){return this._storageData[a]},set:function(e){this.setStorageData(a,e,t)}},o[name]={get:function(){return"number"===i?this._getSecretNumber(this[a]):"string"===i?this._getSecretString(this[a]):"boolean"===i?this._getSecretBool(this[a]):"object"===i?this._getSecretObject(this[a]):void 0},set:function(e){this[a]="object"!==i?this._setSecret(e):this._setSecretObject(e)}},o))}else Object.defineProperty(this,e,{get:function(){return this._storageData[e]},set:function(o){this.setStorageData(e,o,t)}})}},t.prototype.setStorageData=function(e,t,o){void 0===o&&(o=!0),this._storageData[e]=t,o&&n.default.setDataAsync(e,t)},t.prototype._initStorage=function(e,t){return null===n.default.getData(e)?(n.default.setData(e,t),t):n.default.getData(e)},t.prototype._initTableData=function(e,t){if(null===n.default.getData(e))return n.default.setData(e,t),t;var o=n.default.getData(e);for(var i in t)-1===Object.keys(o).indexOf(i)&&(o[i]=t[i]);for(var i in o)-1===Object.keys(t).indexOf(i)&&delete o[i];return n.default.setData(e,o),o},t.prototype._getSecretNumber=function(e){if("number"==typeof e)return e;if(""===e)return 0;var t=Number(a.decode(e.toString()));return Number.isNaN(t)?0:t},t.prototype._getSecretString=function(e){return""===e?"":String(a.decode(e.toString()))},t.prototype._getSecretBool=function(e){return"boolean"==typeof e?e:""!==e&&Boolean(a.decode(e.toString()))},t.prototype._getSecretObject=function(e){return"object"==typeof e?e:""===e?null:JSON.parse(a.decode(e.toString()))},t.prototype._setSecret=function(e){return a.encode(e.toString())},t.prototype._setSecretObject=function(e){return a.encode(JSON.stringify(e))},t.prototype.initSecretList=function(e){var t=function(t){var n=e[t],i=n.key;Object.defineProperty(o,t,{get:function(){return"number"===n.type?this._getSecretNumber(this[i]):"string"===n.type?this._getSecretString(this[i]):"boolean"===n.type?this._getSecretBool(this[i]):"object"===n.type?this._getSecretObject(this[i]):void 0},set:function(e){"object"!==n.type?this[i]=this._setSecret(e):this[i]=this._setSecretObject(e)}})},o=this;for(var n in e)t(n)},t.assign=function(e,t){var o=e;for(var n in t)o.hasOwnProperty(n)||(o[n]=t[n]);return o},t.HandlerList=[],t}(i.default);o.default=r,cc._RF.pop()},{"../utils/Base64":"Base64","../utils/StorageUtils":"StorageUtils","./ConfigHandler":"ConfigHandler"}],DateTimerHandler:[function(e,t,o){"use strict";cc._RF.push(t,"57defXduFVBq5jW+9PqZ/Kw","DateTimerHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/data/DataHandler"),i=e("../submodule/pp/PP"),a=e("./ShortcutHandler"),r={dateSign:{default:-1,saveServer:!0},pddShowTime1:{default:0,saveServer:!0},pddPopTime:{default:0,saveServer:!0},video_time_day:{default:0,saveServer:!1}},s=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onInit=function(){this.serverKey="DateTimerData",this.initStorageData(r)},t.prototype.onDataLoadOver=function(){},t.prototype.onServerLoadOver=function(){},t.prototype.checkRefreshDateData=function(e){-1!==this.dateSign&&i.pp.isSameDay(this.dateSign,e)||(this.refreshDateData(),this.dateSign=e)},t.prototype.refreshDateData=function(){console.log("\u5237\u65b0\u6bcf\u65e5\u6570\u636e"),a.default.shortCutGet||(a.default.shortCutTodayShow=!1,a.default.saveTableData()),this.pddShowTime1=0,this.pddPopTime=0,this.video_time_day=0},t}(n.default));o.default=s,cc._RF.pop()},{"../submodule/data/DataHandler":"DataHandler","../submodule/pp/PP":"PP","./ShortcutHandler":"ShortcutHandler"}],Define:[function(e,t,o){"use strict";cc._RF.push(t,"c44206w6PtKAK1BKSIMbTff","Define"),Object.defineProperty(o,"__esModule",{value:!0}),o.Define={MAP_SIZE:8,BLOCK_SPACE:2,SIDE_SPACE:21,TOUCH_OFFSET_Y:200,CRASH_DELAY:.05,OVER_WAIT:.8,BOTTOM_FIVE_SCALE:.38,BOTTOM_SCALE:.4,SHOW_SCALE:.9,COLOR_NUM:5,SCORE_CHANGE_DURATION:.75,PROP_TYPE:{CRASH:0,CHANGE:1,FLASH:2,BOOM:3},TIP_DURATION:3},function(e){e.ON_SHOW="ON_SHOW",e.REWARD_ADS_LOADED="REWARD_ADS_LOADED",e.ON_CONFIG_LOADED="ON_CONFIG_LOADED",e.GET_AUTHLIST_OVER="GET_AUTHLIST_OVER",e.REWARD_ADS_SHOW="REWARD_ADS_SHOW",e.REWARD_ADS_HIDE="REWARD_ADS_HIDE",e.RANK_VIEW_CLOSE="RANK_VIEW_CLOSE",e.ON_LIMIT_CHANGE="ON_LIMIT_CHANGE",e.GO_TO_SHARE="GO_TO_SHARE",e.CANCEL_SHARE="_CANCEL_SHARE_",e.ON_VIDEO_COMPLETE="ON_VIDEO_COMPLETE",e.ON_SHARE_COMPLETE="ON_SHARE_COMPLETE",e.ON_BANNER_RESIZE="ON_BANNER_RESIZE",e.POP_LAYER="POP_LAYER",e.ON_DOOR_PROGRESS_CHANGE="ON_DOOR_PROGRESS_CHANGE",e.PRELOAD_SCENE="PRELOAD_SCENE",e.SHOW_GAME="SHOW_GAME",e.RESTART_GAME="RESTART_GAME",e.USE_PROP_CHANGE="USE_PROP_CHANGE",e.USE_PROP_CRASH="USE_PROP_CRASH",e.PROP_CRASH_CHANGE="PROP_CRASH_CHANGE",e.PROP_CHANGE_CHANGE="PROP_CHANGE_CHANGE",e.RESET_GAME="RESET_GAME",e.ON_REVIVE_SUCCESS="ON_REVIVE_SUCCESS",e.ON_REVIVE_FAIL="ON_REVIVE_FAIL",e.PROP_REWARD_GETED="PROP_REWARD_GETED",e.TRIGGER_SPECIAL_PROP="TRIGGER_SPECIAL_PROP",e.REMOVE_GUIDE_LAYER="REMOVE_GUIDE_LAYER",e.MISSION_HAVE_CHANGE="MISSION_HAVE_CHANGE",e.MISSIONS_REFRESH="MISSIONS_REFRESH",e.HONOR_UPGRADE="HONOR_UPGRADE",e.SHOW_UPGRADE="SHOW_UPGRADE",e.RESTART_GAME_EVENT="RESTART_GAME_EVENT",e.ON_SHORTCUT_SUCCESS="ON_SHORTCUT_SUCCESS",e.SHOW_COUPON_BUTTON="SHOW_COUPON_BUTTON"}(o.EventMsg||(o.EventMsg={})),function(e){e.MAIN_POP="MAIN_POP"}(o.TaskMsg||(o.TaskMsg={})),function(e){e.POP_SHORTCUT_REWARD="POP_SHORTCUT_REWARD"}(o.TaskNames||(o.TaskNames={})),cc._RF.pop()},{}],DelayShowButton:[function(e,t,o){"use strict";cc._RF.push(t,"99332lenpVPranNL5mawuqe","DelayShowButton"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../submodule/utils/EventCenter"),a=e("../../common/Define"),r=cc._decorator,s=r.ccclass,c=r.property;(function(e){e[e.NONE=0]="NONE",e[e.FADE=1]="FADE",e[e.HIDE_BANNER=2]="HIDE_BANNER"})(n||(n={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showType=n.FADE,t.buttonEvents=[],t.originY=null,t.triggerEvent=!1,t.isPlay=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.isPlay||(this.node.opacity=0),this.node.on("touchend",this.showAtOnce,this),i.default.register(a.EventMsg.ON_BANNER_RESIZE,this,function(t){var o=t.source,n=o.top;o.left;0!==e.node.opacity&&(console.log("\u8c03\u6574\u6309\u94ae\u4f4d\u7f6e!"),WxSDK.setPosNearBanner(e.node,10,n))})},t.prototype.onDestroy=function(){this.node.off("touchend",this.showAtOnce,this),i.default.removeRegister(this)},t.prototype.play=function(){var e=this;if(this.isPlay=!0,this.node.opacity=0,this.triggerEvent=!1,null===this.originY&&(this.originY=this.node.y),this.showType=WxSDK.thanks_show_type,this.showType===n.NONE)this.node.opacity=255,this.triggerEvent=!0;else if(this.showType===n.FADE){var t=WxSDK.button_fade_time/1e3;this.node.stopAllActions(),this.node.opacity=0,this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(t){t.y=e.originY,WxSDK.setPosNearBanner(t,10),e.triggerEvent=!0}),cc.fadeIn(.5)))}else if(this.showType===n.HIDE_BANNER)if(this.node.opacity=255,WxSDK.bannerExit()){WxSDK.hideBanner(),WxSDK.setPosInBanner(this.node);t=WxSDK.button_move_time/1e3;this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(t){WxSDK.showBanner(),WxSDK.setPosNearBanner(t,10),e.triggerEvent=!0})))}else this.triggerEvent=!0},t.prototype.playNormal=function(){var e=this;this.isPlay=!0,this.node.opacity=0,this.triggerEvent=!1,null===this.originY&&(this.originY=this.node.y);this.node.stopAllActions(),this.node.opacity=0,this.node.runAction(cc.sequence(cc.delayTime(0),cc.callFunc(function(t){t.y=e.originY,0!==WxSDK.thanks_show_type&&WxSDK.setPosNearBanner(t,10),e.triggerEvent=!0}),cc.fadeIn(.5)))},t.prototype.showAtOnce=function(){this.triggerEvent&&(this.node.opacity=255,this.buttonEvents.length>0&&cc.Component.EventHandler.emitEvents(this.buttonEvents,this))},t.prototype.update=function(e){this.showType===n.HIDE_BANNER&&!1===this.triggerEvent&&WxSDK.setPosInBanner(this.node)},__decorate([c({type:cc.Enum(n),tooltip:"\u6309\u94ae\u7b56\u7565"})],t.prototype,"showType",void 0),__decorate([c({type:[cc.Component.EventHandler]})],t.prototype,"buttonEvents",void 0),t=__decorate([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../common/Define":"Define","../../submodule/utils/EventCenter":"EventCenter"}],DoorLayer:[function(e,t,o){"use strict";cc._RF.push(t,"8775aLXyGlF15RwC4oC9+2K","DoorLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/UnitBase"),i=e("../../submodule/utils/EventCenter"),a=e("../../common/Define"),r=e("../../submodule/utils/SoundUtils"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.leftDoor=null,t.rightDoor=null,t.progressBar=null,t.effectDuration=1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;i.default.register(a.EventMsg.ON_DOOR_PROGRESS_CHANGE,this,function(t){e.showProgress(t.source)})},t.prototype.start=function(){this.bg.active=!0},t.prototype.onEnable=function(){this.showProgress(0)},t.prototype.show=function(e){var t=this;return void 0===e&&(e=0),new Promise(function(o,n){t.rightDoor.x=cc.winSize.width/2+t.rightDoor.width*t.rightDoor.anchorX,t.leftDoor.x=-t.rightDoor.x,t.node.active=!0,t.bg.opacity=0,t.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(e){r.default.playSFX("door")}),cc.spawn(cc.floatTo(t.effectDuration,t.leftDoor.x,0,function(e){t.leftDoor.x=e}),cc.floatTo(t.effectDuration,t.rightDoor.x,0,function(e){t.rightDoor.x=e}),cc.floatTo(t.effectDuration,0,200,function(e){t.bg.opacity=e})),cc.callFunc(function(e){o()})))})},t.prototype.hide=function(e){var t=this;return void 0===e&&(e=0),new Promise(function(o,n){t.leftDoor.x=t.rightDoor.x=0;var i=cc.winSize.width/2+t.rightDoor.width*t.rightDoor.anchorX;t.bg.opacity=200,t.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(e){r.default.playSFX("door")}),cc.spawn(cc.floatTo(t.effectDuration,0,-i,function(e){t.leftDoor.x=e}),cc.floatTo(t.effectDuration,0,i,function(e){t.rightDoor.x=e}),cc.floatTo(t.effectDuration,200,0,function(e){t.bg.opacity=e})),cc.callFunc(function(e){t.node.active=!1,o()})))})},t.prototype.showProgress=function(e){this.progressBar&&(this.progressBar.progress=e)},__decorate([l(cc.Node)],t.prototype,"bg",void 0),__decorate([l(cc.Node)],t.prototype,"leftDoor",void 0),__decorate([l(cc.Node)],t.prototype,"rightDoor",void 0),__decorate([l(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([l],t.prototype,"effectDuration",void 0),t=__decorate([c],t)}(n.default);o.default=u,cc._RF.pop()},{"../../common/Define":"Define","../../submodule/component/UnitBase":"UnitBase","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/SoundUtils":"SoundUtils"}],DragNode:[function(e,t,o){"use strict";cc._RF.push(t,"b6f12tpPjpBV72jbFTQwyRo","DragNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./UnitBase"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canOut=!1,t._isMove=!1,t._clickEvents=[],t}return __extends(t,e),t.prototype.onLoad=function(){var e=this.getComponent(cc.Button);if(e){var t=e.clickEvents.slice();this._clickEvents=t,e.clickEvents=[]}this.node.on("touchstart",this._touchStart,this),this.node.on("touchmove",this._touchMove,this),this.node.on("touchend",this._touchEnd,this)},t.prototype.onDestroy=function(){this.node.off("touchstart",this._touchStart,this),this.node.off("touchmove",this._touchMove,this),this.node.off("touchend",this._touchEnd,this)},t.prototype._touchStart=function(e){this._isMove=!1},t.prototype._touchMove=function(e){var t=e.getStartLocation(),o=e.getLocation();if(t.sub(o).mag()>5){this._isMove=!0;var n=e.getDelta();this.xy=this.xy.add(n)}},t.prototype._touchEnd=function(e){this._isMove||this._clickEvents&&cc.Component.EventHandler.emitEvents(this._clickEvents,this)},t.prototype.update=function(e){if(!this.canOut){var t=this.node.parent.convertToNodeSpaceAR(cc.v2(this.node.width/2,0)).x,o=this.node.parent.convertToNodeSpaceAR(cc.v2(cc.winSize.width-this.node.width/2,0)).x,n=this.node.parent.convertToNodeSpaceAR(cc.v2(0,cc.winSize.height-this.node.height/2)).y,i=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this.node.height/2)).y;this.x=this.x.clamp(t,o),this.y=this.y.clamp(i,n)}},__decorate([r({tooltip:"\u662f\u5426\u53ef\u4ee5\u79fb\u51fa\u5c4f\u5e55\u5916"})],t.prototype,"canOut",void 0),t=__decorate([a],t)}(n.default);o.default=s,cc._RF.pop()},{"./UnitBase":"UnitBase"}],EventCenter:[function(e,t,o){"use strict";cc._RF.push(t,"7cb68olFgdOYammvcz2F1lG","EventCenter"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(e,t){this.message=e,this.source=t}}(),i=function(){function e(){}return e.post=function(e,t,o){if(void 0===o&&(o=!1),null===e)throw"Post:name";if(o){if(this._postNotificationNames.indexOf(e)>=0)return;this._postNotificationNames.push(e)}var i=new n(e,t);this._getDelegates(e).forEach(function(e,t){e.forEach(function(e){e.call(t,i)})})},e.register=function(e,t,o,n){if(void 0===n&&(n=!1),null==e)throw"Register:name";if(null==o)throw"Register:method";if(null==t)throw"Register:target";this._addValue(e,t,o),n&&o.call(t)},e.removeRegister=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];"string"==typeof e[0]?this._removeRegister1.apply(this,e):this._removeRegister2.apply(this,e)},e.clear=function(){this._postNotificationNames=[],this._dic.forEach(function(e,t){var o=e;e.size>0?o.forEach(function(e,t){cc.log(t)}):cc.log(t+"----------- 0\u4e2a ---------")})},e._getDelegates=function(e){var t=this._valueOrDefault(this._dic,e);return null!=t?t:[]},e._addValue=function(e,t,o){var n=this._valueOrDefault(this._dic,e);if(null==n&&(n=new Map,this._dic.set(e,n)),null==this._valueOrDefault(n,t))n.set(t,[o]);else{var i=n.get(t);i.push(o),n.set(t,i)}},e._valueOrDefault=function(e,t){return null==e?null:e.has(t)?e.get(t):null},e._removeRegister1=function(e,t,o){if(void 0===t&&(t=null),void 0===o&&(o=null),null===e)throw"RemoveRegister:name";return null!=o?this._removeValue(e,t,o):null!=t?this._removeKey(e,t):this._removeKey(e)},e._removeRegister2=function(e){var t=this;return void 0===e&&(e=null),null!=e&&(this._dic.forEach(function(o,n){var i=o;null!==t._valueOrDefault(i,e)&&i.delete(e)}),!0)},e._removeValue=function(e,t,o){var n=this._valueOrDefault(this._dic,e);if(null==n)return!1;if(null==this._valueOrDefault(n,t))return!1;var i=n.get(t);return i.remove(o),n.set(t,i),!0},e._removeKey1=function(e){return this._dic.delete(e)},e._removeKey2=function(e,t){return null!=this._valueOrDefault(this._dic,e)&&this._dic.delete(t)},e._removeKey=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];1===e.length?this._removeKey1(e[0]):this._removeKey2(e[0],e[1])},e._postNotificationNames=[],e._dic=new Map,e}();o.default=i,cc._RF.pop()},{}],FeedbackBtn:[function(e,t,o){"use strict";cc._RF.push(t,"858a6a9fyVDE7U4qk6WUhC9","FeedbackBtn");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("WxBtn"));e("sdk");cc.Class({extends:n.default,properties:{},_createWxBtn:function(){if(console.log("CreateWxBtn"),"undefined"!=typeof wx&&"function"==typeof wx.createFeedbackButton){var e=wx.createFeedbackButton({type:"text",text:"\u610f\u89c1\u53cd\u9988",style:{backgroundColor:"#16161650",color:"#ffffff99",textAlign:"center",fontSize:11,borderRadius:5}});this._wxBtn=e,this.resizeButton()}}}),cc._RF.pop()},{WxBtn:"WxBtn",sdk:"sdk"}],FileUtils:[function(e,t,o){"use strict";cc._RF.push(t,"5dce2e+txZNT4XyJrpnhMeA","FileUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.resetResourceData=function(){this.ResourcesData={Config:{},Texture:{},Sound:{},Prefab:{},Font:{}}},e.getLoadUrl=function(e,t){var o=this._getRealUrl(e,t,!1);return o?this._getUrlWithoutAsp(o):null},e.getSpriteFrameAsync=function(e,t,o){var n=this._getSimpleUrlWithoutAsp(e),i=this.getTextureByName(n);if(null===i){var a=this.getLoadUrl(e,"image"),r=this;this.loadResourceAsync(a,cc.SpriteFrame,function(e){e&&(r.ResourcesData.Texture[n]=e,t(e))},o)}else t&&t(i)},e.getSoundAsync=function(e,t){var o=this._getSimpleUrlWithoutAsp(e),n=this.getSoundByName(o);if(null===n){var i=this.getLoadUrl(e,"sound"),a=this;this.loadResourceAsync(i,cc.AudioClip,function(e){e&&(a.ResourcesData.Sound[o]=e,t(e))})}else t&&t(n)},e.getConfigAsync=function(e,t){var o=this._getSimpleUrlWithoutAsp(e),n=this.getConfigByName(o);if(null===n){var i=this.getLoadUrl(e,"config"),a=this;this.loadResourceAsync(i,cc.TextAsset,function(e){e&&(a.ResourcesData.Config[o]=e,t(e))})}else t&&t(n)},e.getPrefabAsync=function(e,t,o){var n=this._getSimpleUrlWithoutAsp(e),i=this.getPrefabByName(n);if(null===i){var a=this.getLoadUrl(e,"prefab"),r=this;this.loadResourceAsync(a,cc.Prefab,function(e){e&&(r.ResourcesData.Prefab[n]=e,t(e))},o)}else t&&t(i)},e.getSpriteFramePromise=function(e){var t=this,o=this._getSimpleUrlWithoutAsp(e),n=this.getTextureByName(o);return new Promise(function(i,a){if(null===n){var r=t.getLoadUrl(e,"image");t.loadResourceAsync(r,cc.SpriteFrame,function(e){if(e)return t.ResourcesData.Texture[o]=e,void i(e);a()})}else i(n)})},e.getSoundPromise=function(e){var t=this,o=this._getSimpleUrlWithoutAsp(e),n=this.getSoundByName(o);return new Promise(function(i,a){if(null===n){var r=t.getLoadUrl(e,"sound");t.loadResourceAsync(r,cc.AudioClip,function(e){if(e)return this.ResourcesData.Sound[o]=e,void i(e);a()})}else i(n)})},e.getConfigPromise=function(e){var t=this,o=this._getSimpleUrlWithoutAsp(e),n=this.getConfigByName(o);return new Promise(function(i,a){if(null===n){var r=t.getLoadUrl(e,"config");t.loadResourceAsync(r,cc.TextAsset,function(e){if(e)return this.ResourcesData.Config[o]=e,void i(e);a()})}else i(n)})},e.getPrefabPromise=function(e){var t=this,o=this._getSimpleUrlWithoutAsp(e),n=this.getPrefabByName(o);return new Promise(function(i,a){if(null===n){var r=t.getLoadUrl(e,"prefab");t.loadResourceAsync(r,cc.Prefab,function(e){if(e)return this.ResourcesData.Prefab[o]=e,void i(e);a()})}else i(n)})},e.getTextureByName=function(e){return this.ResourcesData.Texture[e]?this.ResourcesData.Texture[e]:null},e.getConfigByName=function(e){return this.ResourcesData.Config[e]?this.ResourcesData.Config[e]:null},e.getSoundByName=function(e){return this.ResourcesData.Sound[e]?this.ResourcesData.Sound[e]:null},e.getPrefabByName=function(e){return this.ResourcesData.Prefab[e]?this.ResourcesData.Prefab[e]:null},e.getResourceByName=function(e){return this.ResourcesData[e]?this.ResourcesData[e]:null},e.loadResourceAsync=function(e,t,o,n){cc.loader.loadRes(e,t,function(e,t){if(e)return cc.error(e),void(n&&n(e));o&&o(t)})},e.releasePrefabByName=function(e){e=this._getSimpleUrlWithoutAsp(e);var t=this.ResourcesData.Prefab[e],o=cc.loader.getDependsRecursively(t);cc.log(t,o)},e._getRealUrl=function(e,t,o){return""!==e?this._getUnloadUrl(this._getTypeUrl(e,t),o):null},e._getTypeUrl=function(e,t){return e.indexOf(t)<0?t+"/"+e:e},e._getUnloadUrl=function(e,t){if(t){if(e.indexOf("resources")<0)return e.indexOf("unload")<0?"resources/unload/"+e:"resources/"+e}else if(e.indexOf("unload")<0)return"unload/"+e;return e},e.getSimpleUrlWithoutAsp=function(e){return this._getSimpleUrlWithoutAsp(e)},e.getUrlWithoutAsp=function(e){return this._getUrlWithoutAsp(e)},e.getSimpleUrl=function(e){return this._getSimpleUrl(e)},e._getSimpleUrl=function(e){return e.split("/").pop()},e._getSimpleUrlWithoutAsp=function(e){var t=this._getSimpleUrl(e);return this._getUrlWithoutAsp(t)},e._getUrlWithoutAsp=function(e){var t=e.lastIndexOf(".");return t>=0?e.substring(0,t):e},e.ResourcesData={Config:{},Texture:{},Sound:{},Prefab:{},Font:{}},e}();o.default=n,cc._RF.pop()},{}],FollowController:[function(e,t,o){"use strict";cc._RF.push(t,"5c86e3HlP5I9Kv6OoA8h+j3","FollowController"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.target=null,t.pos=cc.v2(),t.followX=!0,t.followY=!0,t}return __extends(t,e),t.prototype.update=function(e){if(this.target){var t=this.target.convertToWorldSpaceAR(this.pos),o=this.node.parent.convertToNodeSpaceAR(t);this.followX&&(this.node.x=o.x),this.followY&&(this.node.y=o.y)}},__decorate([a(cc.Node)],t.prototype,"target",void 0),__decorate([a(cc.Vec2)],t.prototype,"pos",void 0),__decorate([a],t.prototype,"followX",void 0),__decorate([a],t.prototype,"followY",void 0),t=__decorate([i],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],GameClubBtn:[function(e,t,o){"use strict";cc._RF.push(t,"41191UbuEFDp455tDaexDYd","GameClubBtn");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("WxBtn"));e("sdk");cc.Class({extends:n.default,properties:{},_createWxBtn:function(){if("undefined"!=typeof wx&&"function"==typeof wx.createGameClubButton){var e=wx.createGameClubButton({type:"text",text:" ",style:{backgroundColor:"#16161601",color:"#ffffff01"},icon:"green"});this._wxBtn=e,this.resizeButton()}}}),cc._RF.pop()},{WxBtn:"WxBtn",sdk:"sdk"}],GameHandler:[function(e,t,o){"use strict";cc._RF.push(t,"0d317dWX8ZCIagJkA/l8X5k","GameHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/data/DataHandler"),i=e("./HonorMission"),a=e("../common/Define"),r=e("../submodule/utils/EventCenter"),s=e("./HonorHandler"),c=e("./ShortcutHandler"),l={playCount:{default:0,saveServer:!0},bestScore:{default:0,saveServer:!0,secretType:"number"}},u={doGuide:{default:!0,saveServer:!0},doGuide2:{default:!0,saveServer:!0},propChangeFree:{default:!0,saveServer:!0},propCrashFree:{default:!0,saveServer:!0},propChangeCount:{default:0,saveServer:!1},propCrashCount:{default:0,saveServer:!1},propSpecialFree:{default:!0,saveServer:!0},backupsData:{default:null,saveServer:!1}},h=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasCoupon=!1,t}return __extends(t,e),t.prototype.onInit=function(){this.serverKey="gameData",this._tableKey="GameTable",this.initTableData(l),this.initStorageData(u)},t.prototype.onDataLoadOver=function(){WxSDK.level=this.playCount},t.prototype.getScoreByAddition=function(e){var t=c.default.shortCutGet?WxSDK.shortcut_reward/100:0;return(s.default.getCurAddition()+1+t)*e},t.prototype.getScoreByLine=function(e){return this.getScoreByAddition([10,30,60,100,150,210][e-1])},t.prototype.saveGameTemp=function(e){for(var t=[],o=0,n=e.blockList;o<n.length;o++){var i=n[o];t.push({row:i.mapRow,col:i.mapCol,colorIdx:i.colorIdx})}for(var a=[],r=0,s=e.shapeList;r<s.length;r++){var c=s[r];null!==c&&a.push(c.type)}for(var l=[],u=0,h=e.propList;u<h.length;u++){var d=h[u],p=d.targetBlock,f=p.mapRow,_=p.mapCol,g=d.type;l.push({row:f,col:_,type:g})}var v={score:Math.floor(e.score),shapeArr:a,blockDataList:t,propChangeTime:e.propChangeTime,propCrashTime:e.propCrashTime,reviveTime:e.reviveTime,propArr:l};this.backupsData=v},t.prototype.getGameTemp=function(){return null!==this.backupsData?this.backupsData:null},t.prototype.cleanGameTemp=function(){this.backupsData=null,cc.log("clean")},t.prototype.checkIsNewRecord=function(e){var t=!1;return(e=Math.floor(e))>this.bestScore&&(this.bestScore=e,t=!0,r.default.post(a.EventMsg.MISSION_HAVE_CHANGE,i.HonorMissionType.BEST_SCORE)),this.updateScore(),t},t.prototype.updateScore=function(){var e;console.log("\u63d0\u4ea4\u5f97\u5206\u6bb5\u4f4d\u4fe1\u606f\u5230\u6392\u884c\u699c");var t=this.bestScore,o=s.default.honorId;WxSDK.updateScore(((e={})[WxSDK.bestScore]=t,e.honorId=o,e),t)},t.prototype.checkRevive=function(e){if(console.log("\u68c0\u6d4b\u590d\u6d3b:",e,WxSDK.revive_time),e<WxSDK.revive_time){var t=WxSDK.hasReward();if(console.log("\u662f\u5426\u5b58\u5728\u6fc0\u52b1:",t),t)return!0}return!1},t.prototype.addPlayCount=function(){this.playCount++,WxSDK.level=this.playCount},t}(n.default));o.default=h,cc._RF.pop()},{"../common/Define":"Define","../submodule/data/DataHandler":"DataHandler","../submodule/utils/EventCenter":"EventCenter","./HonorHandler":"HonorHandler","./HonorMission":"HonorMission","./ShortcutHandler":"ShortcutHandler"}],GameLayer:[function(e,t,o){"use strict";cc._RF.push(t,"933d5wNWPVNe5Abvf11i5is","GameLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../common/Define"),a=e("../../submodule/component/UnitBase"),r=e("../../submodule/pp/PP"),s=e("../../data/ShapeBlocks"),c=e("../unit/Block"),l=e("../../data/GameHandler"),u=e("../../common/Common"),h=e("../../submodule/utils/EventCenter"),d=e("./GameUI"),p=e("../../data/ShapeFactory"),f=e("../../common/SubViewController"),_=e("../../submodule/utils/FileUtils"),g=e("../panel/GuideLayer"),v=e("../../submodule/data/LanguageHandler"),m=e("../../submodule/utils/SoundUtils"),y=e("../../data/HonorHandler"),S=e("../../data/ReportHandler"),w=e("../unit/PropNode"),b=cc._decorator,C=b.ccclass,P=b.property;(function(e){e[e.PREPARE=0]="PREPARE",e[e.GAME=1]="GAME"})(n=o.GameState||(o.GameState={}));var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameUI=null,t.db=null,t.blockDb=null,t.dbNode=null,t.rect=null,t.bottomRect=null,t.blockNode=null,t.blockPrefab=null,t.tipBlockPrefab=null,t.effectPrefab=null,t.scoreShowLabel=null,t.gameScoreLabel=null,t.hammer=null,t.propCrashNode=null,t.stepOverView=null,t.propPrefab=null,t.propList=[],t.hammerBlockList=[],t.hammerValid=!1,t.gameState=n.PREPARE,t.isPlayAni=!1,t.blockList=[],t.shapeList=[],t.projectionList=[],t.projectionVector=[],t.turnColorList=[],t.tipBlockList=[],t.effectList=[],t.guideLayer=null,t.hammerCanCrash=!1,t._tipsList=[],t._chooseShape=null,t._score="",t._fistNew250=!1,t._showScore=0,t.easyMode=0,t.reviveTime=0,t.propChangeTime=0,t.propCrashTime=0,t.showPopRound=!0,t}return __extends(t,e),Object.defineProperty(t.prototype,"score",{get:function(){if(""===this._score)return 0;var e=Number(Base64.decode(this._score));return isNaN(e)?0:e},set:function(e){0===l.default.playCount&&!S.default.new250&&e>=250&&(S.default.new250=!0,WxSDK.reportEvent(WxSDK.ReportMsg.NEW_250),this._fistNew250=!0);var t=Base64.encode(e+"");this._score=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showScore",{get:function(){return this._showScore},set:function(e){var t=this._showScore;this._showScore=e,this.gameUI.refreshScoreLabel(t,e)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;h.default.register(i.EventMsg.USE_PROP_CHANGE,this,this.usePropChange),h.default.register(i.EventMsg.RESET_GAME,this,this.reset),h.default.register(i.EventMsg.ON_REVIVE_SUCCESS,this,this.revive),h.default.register(i.EventMsg.ON_REVIVE_FAIL,this,function(){e.showResult()}),h.default.register(i.EventMsg.PROP_CRASH_CHANGE,this,this.checkBottomState),h.default.register(i.EventMsg.PROP_CHANGE_CHANGE,this,this.checkBottomState),h.default.register(i.EventMsg.PROP_REWARD_GETED,this,this.checkRewardGeted),h.default.register(i.EventMsg.TRIGGER_SPECIAL_PROP,this,function(t){var o=t.source;e.gameState===n.GAME&&(o.type===i.Define.PROP_TYPE.FLASH?e.triggerPropFlash(o):o.type===i.Define.PROP_TYPE.BOOM&&e.triggerPropBoom(o))}),h.default.register(i.EventMsg.REMOVE_GUIDE_LAYER,this,function(){e.guideLayer&&(e.guideLayer.node.removeSelf(),e.guideLayer=null)})},t.prototype.start=function(){this.initPool(),this.initUI(),this.initMap(),this.addTouchEvent()},t.prototype.show=function(){this.node.active=!0,WxSDK.showBanner(),l.default.doGuide?this.refreshGuideScene():null!==l.default.backupsData?this.initWithData():this.refresh()},t.prototype.onDisable=function(){this.clean()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.removeTouchEvent()},t.prototype.refresh=function(){var e=this;this.makeBottomShapes(),this.playDbEffectOut().then(function(){e.gameState=n.GAME,e.gameUI.playScrollAni()}),this.score=0,this.showScore=0,this.easyMode=0,this.reviveTime=0,this.propCrashTime=0,this.propChangeTime=0,l.default.propChangeCount=0,this.gameUI.refresh()},t.prototype.initWithData=function(){var e=this,t=l.default.getGameTemp();this.score=t.score,this.showScore=t.score,this.propChangeTime=t.propChangeTime,this.propCrashTime=t.propCrashTime,this.reviveTime=t.reviveTime,this.gameUI.refresh();for(var o=0,a=t.blockDataList;o<a.length;o++){var r=a[o],s=this.makeBlock(r.row,r.col);s.turnNormal(r.colorIdx),s.opacity=0,this.blockList.push(s),this.blockMap[r.row][r.col]=s}var c=[];i.Define.COLOR_NUM.doNFunc(function(e){c.push(e)});var u=t.shapeArr,h=c.getRandomCount(u.length);this.shapeList=[];for(var d=0;d<3;d++)if(d>=u.length)this.shapeList.push(null);else{var f=u[d],_=p.default.getShapeByType(f);this.makeBottomSingleShape(d,_,h[d])}this.checkBottomCanPut(),this.playDbEffectOut().then(function(){if(e.gameState=n.GAME,e.gameUI.playScrollAni(),t.propArr)for(var o=0,a=t.propArr;o<a.length;o++){var r=a[o],s=r.row,c=r.col,u=r.type;if(s<0||s>i.Define.MAP_SIZE||c<0||c>i.Define.MAP_SIZE)return;var h=e.blockMap[s][c];h&&e.createProp(h,u)}l.default.doGuide&&e.playGuide()})},t.prototype.clean=function(){for(var e=i.Define.MAP_SIZE,t=0;t<e;t++)for(var o=0;o<e;o++){this.dbMap[t][o].opacity=0;var n=this.blockMap[t][o];null!==n&&(this.blockPool.put(n.node),this.blockMap[t][o]=null,n.prop&&(n.prop.node.removeSelf(),n.prop=null))}this.blockList=[],this.propList=[],this.cleanBottomShapes()},t.prototype.reset=function(){var e=this;if(this.gameState===n.GAME){l.default.checkIsNewRecord(this.score),this.gameState=n.PREPARE,this.isPlayAni=!0,this.gameUI.playScrollAniIn();for(var t=0,o=this.effectList;t<o.length;t++){var i=o[t];i.stopAllActions(),this.effectPool.put(i)}this.effectList=[],this.playDbEffectIn().then(function(){e.clean(),e.refresh()}),l.default.cleanGameTemp()}},t.prototype.initUI=function(){this.scoreShowLabel.active=!1,this.scoreShowLabel.zIndex=15,this.hammer.zIndex=10,this.stepOverView.node.active=!1},t.prototype.initPool=function(){this.blockPool=new r.pp.NodePoolExtend(1,"Block"),this.blockPool.create(this.blockPrefab,10,this.blockNode),this.tipBlockPool=new r.pp.NodePoolExtend(1),this.tipBlockPool.create(this.tipBlockPrefab,9,this.blockNode),this.effectPool=new r.pp.NodePoolExtend(1),this.effectPool.create(this.effectPrefab,40,this.blockNode)},t.prototype.initMap=function(){this.blockNode.width=cc.winSize.width,this.blockNode.height=cc.winSize.height,this.db.getComponent(cc.Sprite).uniformScale(cc.winSize.width,this.dbNode.height),this.rect.getComponent(cc.Widget).updateAlignment();var e=this.rect.width,t=e/i.Define.MAP_SIZE,o=t-i.Define.BLOCK_SPACE;this.mapWidth=e,this.blockWidth=t,this.shapeWidth=o,this.bottomSpace=this.bottomRect.width/3.05,this.bottomPos=r.pp.getNodePos(this.bottomRect,this.blockNode),this.mapPos=r.pp.getNodePos(this.rect,this.blockNode);var n=this.blockPrefab.data.width;this.blockUniformScale=this.blockWidth/n;var a=i.Define.MAP_SIZE;this.blockMap=[],this.dbMap=[];for(var s=0;s<a;s++){this.blockMap[s]=[],this.dbMap[s]=[];for(var c=0;c<a;c++){this.blockMap[s][c]=null;var l=cc.instantiate(this.blockDb),u=this._getBlockPos(s,c);this.blockNode.addChild(l),l.position=u,l.width=l.height=this.shapeWidth,l.opacity=0,this.dbMap[s][c]=l}}},t.prototype.addTouchEvent=function(){this.node.on("touchstart",this._onTouchStart,this),this.node.on("touchmove",this._onTouchMove,this),this.node.on("touchend",this._onTouchEnd,this),this.node.on("touchcancel",this._onTouchEnd,this)},t.prototype.removeTouchEvent=function(){this.node.off("touchStart",this._onTouchStart,this),this.node.off("touchmove",this._onTouchMove,this),this.node.off("touchend",this._onTouchEnd,this),this.node.off("touchcancel",this._onTouchEnd,this)},t.prototype.delayShowTip=function(){this.unschedule(this.showRandomTip),this.scheduleOnce(this.showRandomTip,i.Define.TIP_DURATION)},t.prototype.unShowTip=function(){this.unschedule(this.showRandomTip)},t.prototype.saveStep=function(){l.default.saveGameTemp({score:Math.floor(this.score),shapeList:this.shapeList,blockList:this.blockList,propChangeTime:this.propChangeTime,propCrashTime:this.propCrashTime,reviveTime:this.reviveTime,propList:this.propList})},t.prototype.roundOver=function(){this.gameState===n.GAME&&this.saveStep()},t.prototype.startEasyMode=function(){this.easyMode=WxSDK.easy_time},t.prototype.hasPropChange=function(){return this.propChangeTime<WxSDK.prop_change_time},t.prototype.hasPropCrash=function(){return this.propCrashTime<WxSDK.prop_crash_time},t.prototype.usePropChange=function(){this.hasPropChange()?(l.default.propChangeCount--,this.propChangeTime++,this.startEasyMode(),this.cleanBottomShapes(),this.makeBottomShapes(),this.saveStep()):u.Common.toastCode("prop_change_use_up")},t.prototype.usePropCrash=function(e){if(this.hasPropCrash()){null!==this._chooseShape&&(this._chooseShape.beRelease(this._getBottomPos(this._chooseShape.id)),this._chooseShape=null),this.gameUI.setHammerActive(!1);var t=e.add(cc.v2(0,i.Define.TOUCH_OFFSET_Y));this.showHammer(t)}else u.Common.toastCode("prop_crash_use_up")},t.prototype.getRealHammerXy=function(){},t.prototype.showHammer=function(e){this.hammer.active=!0,this.hammer.angle=0;var t=e.x+this.hammer.width*(.3-this.hammer.anchorX),o=e.y+this.hammer.height*(.5-this.hammer.anchorY);if(this.hammer.xy=e,this.hammerCanCrash){var n=this._getRowColByPos(cc.v2(t,o)),a=n.row,r=n.col;if(a<0||a>=i.Define.MAP_SIZE||r<0||r>=i.Define.MAP_SIZE)return this.hammerValid=!1,void(this.hammerBlockList.length>0&&this.hammerBlockList.forEach(function(e){e.active=!1}));if(this.hammerValid=!0,a=Math.clamp(a,1,i.Define.MAP_SIZE-2),r=Math.clamp(r,1,i.Define.MAP_SIZE-2),this.hammerBlockList.length<9)for(var s=0;s<9;s++){var c=Math.floor(s/3)-1+a,l=Math.floor(s%3)-1+r;(u=this.blockPool.getWithComponent()).turnFade(),this.hammerBlockList.push(u),u.xy=this._getBlockPos(c,l),u.mapRow=c,u.mapCol=l}else for(s=0;s<9;s++){var u;c=Math.floor(s/3)-1+a,l=Math.floor(s%3)-1+r;(u=this.hammerBlockList[s]).active=!0,u.turnFade(),u.xy=this._getBlockPos(c,l),u.mapRow=c,u.mapCol=l}}},t.prototype.hideHammer=function(){this.hammer.active=!1,this.hammerBlockList.length>0&&this.hammerBlockList.forEach(function(e){e.active=!1})},t.prototype.checkHammerCrash=function(){var e=this;if(!this.hammerCanCrash||!this.hammerValid)return this.hideHammer(),void this.gameUI.setHammerActive(!0);for(var t=[],o=0,n=this.hammerBlockList;o<n.length;o++){var i=(c=n[o]).mapRow,a=c.mapCol;null!==this.blockMap[i][a]&&t.push(this.blockMap[i][a])}if(t.length>0){m.default.playSFX("hammer"),this.hammer.stopAllActions(),this.hammer.runAction(cc.sequence(cc.rotateTo(.1,-10),cc.rotateTo(.1,30),cc.delayTime(.1),cc.callFunc(function(t){e.hideHammer()})));for(var r=0,s=t;r<s.length;r++){var c=s[r];this.crashEffect2(c),this.blockMap[c.mapRow][c.mapCol]=null,this.blockList.remove(c),this.checkPropRemove(c)}var h=l.default.getScoreByAddition(t.length);this.score+=h,this.showScore+=h,this.addScore(t,h),l.default.propCrashCount--,this.propCrashTime++,this.gameUI.refreshPropCrash(),this.startEasyMode(),this.saveStep(),this.checkBottomCanPut()}else u.Common.toastCode("prop_crash_warning"),this.hideHammer(),this.gameUI.setHammerActive(!0)},t.prototype.makeBlock=function(e,t){var o=this.blockPool.get();o.width=o.height=this.blockWidth;var n=o.getComponent("Block");n.mapRow=e,n.mapCol=t;var i=this._getBlockPos(e,t);return o.xy=i,n},t.prototype.makeBottomShapes=function(){var e;this.showPopRound=!0,this.shapeList=[],this.easyMode>0?(e=p.default.getShapesByRange([5,8]),this.easyMode--):e=p.default.getShapesByScore(this.score);var t=[];i.Define.COLOR_NUM.doNFunc(function(e){t.push(e)});for(var o=t.getRandomCount(3),n=0;n<e.length;n++){var a=e[n],r=o[n];this.makeBottomSingleShape(n,a,r)}this.checkBottomCanPut()},t.prototype.makeBottomSingleShape=function(e,t,o){var n=new s.default(t,this.blockPool,this.blockWidth,o);this.shapeList.push(n),n.scale=s.default.getBottomScale(n);var i=this._getBottomPos(e);n.id=e,n.xy=i.sub(cc.v2(0,30)),n.opacity=0,n.runAction(cc.sequence(cc.delayTime(.1*e),cc.spawn(cc.fadeIn(.5),cc.floatTo(.3,n.xy.y,i.y,function(e){n.xy=cc.v2(n.xy.x,e)}))))},t.prototype.testMakeShape=function(e){var t=p.default.ShapeList[e],o=this.shapeList[2];null!==o&&o.remove(!0),this.shapeList.pop(),this.makeBottomSingleShape(2,t,Math.getRandomInt(0,5)),this.checkBottomCanPut()},t.prototype.checkPopProp=function(){if(!WxSDK.hasReward())return console.log("\u4e0d\u5b58\u5728\u89c6\u9891\u5206\u4eab\uff0c\u4e0d\u5f39\u7a97\uff01"),!1;var e=this.hasPropChange(),t=this.hasPropCrash(),o=null;return e&&t?o=Math.getRandomBool()?i.Define.PROP_TYPE.CHANGE:i.Define.PROP_TYPE.CRASH:t?o=i.Define.PROP_TYPE.CRASH:e&&(o=i.Define.PROP_TYPE.CHANGE),null!==o&&(this.scheduleOnce(function(e){u.Common.popPanel({name:"panel/propGetPanel",callback:function(e){e.init(o)}})},.3),!0)},t.prototype.checkRewardGeted=function(e){var t=e.source,o=l.default.propChangeCount,n=l.default.propCrashCount;console.log("\u83b7\u5f97\u5931\u8d25:",t,this.bottomState.allCant,o,n),!t&&this.bottomState.allCant&&0===o&&0===n&&this.gameOver()},t.prototype.removeBottomShape=function(e){this.shapeList[e.id]=null,e.remove(),e=null},t.prototype.cleanBottomShapes=function(){for(var e=function(e){if(null===e)return"continue";e.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.floatBy(.2,e.xy.y,-30,function(t){e.xy=cc.v2(e.xy.x,t)})),cc.callFunc(function(t){e.remove(!0),e=null})))},t=0,o=this.shapeList;t<o.length;t++){e(o[t])}this.shapeList=[]},t.prototype._getBottomPos=function(e){var t=this.bottomSpace,o=this.bottomPos;return cc.v2(o.x-t+t*e,o.y)},t.prototype._getBlockPos=function(e,t){var o=this.mapPos,n=-this.mapWidth/2+t*this.blockWidth+this.blockWidth/2,i=o.y-this.mapWidth/2+e*this.blockWidth+this.blockWidth/2;return cc.v2(n,i)},t.prototype._getRowColByPos=function(e){var t=this.mapPos,o=Math.floor((e.x+this.mapWidth/2)/this.blockWidth);return{row:Math.floor((e.y-t.y+this.mapWidth/2)/this.blockWidth),col:o}},t.prototype.playDbEffectOut=function(){var e=this;m.default.playSFX("startBgm");var t=Math.floor(i.Define.MAP_SIZE/2),o=.1,n=this;return new Promise(function(i,a){function r(e,t,a){for(var r=function(r){var s=e[r],c=s[0],l=s[1],u=n.dbMap[l][c],h=n.blockMap[l][c];u.scale=0,u.runAction(cc.sequence(cc.delayTime(t*o),cc.spawn(cc.fadeIn(.3),cc.scaleTo(.5,1).easing(cc.easeBackOut())),cc.callFunc(function(o){t===a&&r===e.length-1&&i()}))),null!==h&&(h.scale=0,h.node.runAction(cc.sequence(cc.delayTime(t*o),cc.spawn(cc.fadeIn(.3),cc.scaleTo(.5,1).easing(cc.easeBackOut())))))},s=0;s<e.length;s++)r(s)}if(t%2==0)for(var s=t-1,c=t;s>=0;s--,c++){r(e._findRound(s,c),t-s,t)}else for(var l=t,u=t;l>=0;l--,u++){r(e._findRound(l,u),t-l,t)}})},t.prototype.playDbEffectIn=function(){var e=this,t=Math.floor(i.Define.MAP_SIZE/2),o=.1,n=this;return new Promise(function(a,r){function s(e,t,i){for(var r=function(r){var s=e[r],c=s[0],l=s[1],u=n.dbMap[l][c],h=n.blockMap[l][c];u.runAction(cc.sequence(cc.delayTime(t*o),cc.spawn(cc.fadeOut(.5),cc.scaleTo(.5,0).easing(cc.easeBackIn())),cc.callFunc(function(o){t===i&&r===e.length-1&&a()}))),null!==h&&h.node.runAction(cc.sequence(cc.delayTime(t*o),cc.spawn(cc.fadeOut(.5),cc.scaleTo(.5,0).easing(cc.easeBackIn()))))},s=0;s<e.length;s++)r(s)}for(var c=0,l=i.Define.MAP_SIZE-1;c<t;c++,l--){s(e._findRound(c,l),c+1,t)}})},t.prototype.gameOver=function(){var e=this;this.gameState=n.PREPARE,this.manager.node.getChildByName("propUsePanel")&&this.manager.node.getChildByName("propUsePanel").removeSelf(),WxSDK.fetchRank(),this.showOverAni().then(function(){m.default.playSFX("over"),u.Common.toastCode("game_over"),l.default.cleanGameTemp();var t=e.manager,o=Math.floor(e.score),n=l.default.checkIsNewRecord(o);t.showDoor(1.5).then(function(){l.default.checkRevive(e.reviveTime)?(e.reviveTime++,u.Common.popPanel({name:"panel/revivePanel",callback:function(e){e.init(o,n)}})):e.showResult()})})},t.prototype.showOverAni=function(){return this.turnGrayAni(!0)},t.prototype.showResult=function(){var e=Math.floor(this.score),t=l.default.checkIsNewRecord(e);l.default.addPlayCount(),l.default.saveTableData(),y.default.saveTableData(),this.node.active=!1,u.Common.popPanel({name:"panel/resultPanel",callback:function(o){o.init(e,l.default.bestScore,t)}})},t.prototype._findRound=function(e,t){if(e===t)return[[e,e]];for(var o=[],n=e,i=e;i<t;i++)o.push([i,n]);for(i=t,n=e;n<t;n++)o.push([i,n]);for(n=t,i=t;i>e;i--)o.push([i,n]);for(i=e,n=t;n>e;n--)o.push([i,n]);return o},t.prototype.checkProjection=function(){var e=this.checkCanPut();if(!1!==e){for(var t=!1,o=0,n=e=e;o<n.length;o++){var i=n[o];if(this.projectionVector.indexOf(i)<0){t=!0;break}}if(t){this.cleanProjection(),this.projectionVector=e;for(var a=this._chooseShape.colorIdx,r=0,s=e;r<s.length;r++){var c=(i=s[r]).split("_"),l=this.makeBlock(parseInt(c[0]),parseInt(c[1]));l.turnProjection(a),this.projectionList.push(l)}this.checkFullRowCol(this.projectionList,e,a)}}else this.cleanTurnList(),this.cleanProjection();return e},t.prototype.showTipBlocks=function(e,t){for(var o=e.list,n=0;n<o.length;n++){var i=e.getRelativePosWithFirstInMap(n,t.x,t.y),a=this._getBlockPos(i.y,i.x),r=this.tipBlockPool.get();this.tipBlockList.push(r),r.xy=a,r.zIndex=5,r.stopAllActions(),r.width=this.blockWidth,r.height=this.blockWidth,r.opacity=255,r.runAction(cc.sequence(cc.fadeOut(.5),cc.fadeIn(.5),cc.delayTime(.5)).repeatForever())}},t.prototype.cleanTipBlocks=function(){for(var e=0,t=this.tipBlockList;e<t.length;e++){var o=t[e];this.tipBlockPool.put(o)}this.tipBlockList=[]},t.prototype.checkShowSingle=function(e){var t=e.putPosList;if(1===t.length){var o=t[0];this.showTipBlocks(e,o)}},t.prototype.showRandomTip=function(){for(var e=[],t=0,o=this.shapeList;t<o.length;t++){var n=o[t];null!==n&&!1===n.isGray&&e.push(n)}if(e.length>0){var i=e.getRandomOne(),a=i.putPosList.getRandomOne();this.showTipBlocks(i,a)}},t.prototype.checkFullRowCol=function(e,t,o){this.cleanTurnList();for(var n=[],a=[],r=0,s=e;r<s.length;r++){var c=s[r],l=c.mapRow,u=c.mapCol;n.indexOf(l)<0&&n.push(l),a.indexOf(u)<0&&a.push(u)}for(var h=[],d=0,p=n;d<p.length;d++){for(var f=p[d],_=[],g=!0,v=0;v<i.Define.MAP_SIZE;v++){var m=f+"_"+v;if(null!==this.blockMap[f][v])_.push(this.blockMap[f][v]);else if(t.indexOf(m)<0){g=!1;break}}g&&(h=h.concat(_))}for(var y=0,S=a;y<S.length;y++){for(v=S[y],_=[],g=!0,f=0;f<i.Define.MAP_SIZE;f++){m=f+"_"+v;if(null!==this.blockMap[f][v])_.push(this.blockMap[f][v]);else if(t.indexOf(m)<0){g=!1;break}}g&&(h=h.concat(_))}this.turnColorList=h;for(var w=0,b=h;w<b.length;w++){b[w].turnColor(o)}h.length>0&&WxSDK.vibrate(!1)},t.prototype.cleanTurnList=function(){for(var e=0,t=this.turnColorList;e<t.length;e++){var o=t[e];o.turnColor(o.colorIdx)}this.turnColorList=[]},t.prototype.cleanProjection=function(){for(var e=0,t=this.projectionList;e<t.length;e++){var o=t[e];this.blockPool.put(o.node)}this.projectionList=[],this.projectionVector=[]},t.prototype.checkCanPut=function(){var e=this._chooseShape,t=e.list,o=t[0];if(o){var n=[],i=this._getRowColByPos(o.node.xy),a=i.row,r=i.col;if(1===g.default.GuideIdx&&(3!==a||3!==r))return!1;if(2===g.default.GuideIdx&&(3!==a||4!==r))return!1;if(this._checkPut(a,r)){n.push(a+"_"+r);for(var s=1;s<t.length;s++){var c=e.getRelativePosWithFirstInMap(s,a,r),l=c.y,u=c.x;if(!this._checkPut(l,u))return!1;n.push(l+"_"+u)}return n}return!1}},t.prototype.putToMap=function(e){var t=this;m.default.playSFX("put"),this.cleanProjection();var o=this._chooseShape,n=o.list,i=o.colorIdx;o.zIndex=1;for(var a=[],r=function(o){var r=n[o],c=e[o].split("_"),l=parseInt(c[0]),u=parseInt(c[1]);a.push({row:l,col:u});var h=s._getBlockPos(l,u);s.blockMap[l][u]=r,s.blockList.push(r),r.mapRow=l,r.mapCol=u,r.node.runAction(cc.sequence(cc.moveTo(.02,h),cc.callFunc(function(e){e.xy=h,r.showLight()}),cc.scaleTo(.1,1),cc.callFunc(function(e){0===o&&(t.checkCrash(a,i),t.checkRefreshBottom(),t.checkMakeProp(),t.roundOver())})))},s=this,c=0;c<n.length;c++)r(c);this.removeBottomShape(o)},t.prototype.checkRefreshBottom=function(){for(var e=!0,t=0,o=this.shapeList;t<o.length;t++){null!==o[t]&&(e=!1)}e?this.makeBottomShapes():this.checkBottomCanPut()},t.prototype.checkBottomCanPut=function(){for(var e=!0,t=!1,o=0;o<this.shapeList.length;o++){var n=this.shapeList[o];if(null!==n){var i=this.checkShapeCanPut(n);i.length>0?(e=!1,n.isGray=!1,n.putPosList=i):(n.isGray=!0,t=!0,n.putPosList=[])}}this.bottomState={allCant:e,hasGray:t},this.checkBottomState()},t.prototype.checkBottomState=function(){var e=this.bottomState,t=e.allCant;if(e.hasGray){var o=l.default.propChangeCount,n=l.default.propCrashCount;if(o>0)this.gameUI.showWarnTipNode(i.Define.PROP_TYPE.CHANGE),t&&u.Common.toastCode("prop_change_warn_tip");else if(n>0)this.gameUI.showWarnTipNode(i.Define.PROP_TYPE.CRASH),t&&u.Common.toastCode("prop_crash_warn_tip");else{if(this.gameUI.hideWarnTipNode(),t)this.checkPopProp()||this.gameOver();else this.showPopRound&&(this.showPopRound=!1,this.checkPopProp())}}else this.gameUI.hideWarnTipNode()},t.prototype.checkShapeCanPut=function(e){for(var t=e.getMatrix(),o=t.length,n=t[0].length,a=e.list,r=[],s=0;s<i.Define.MAP_SIZE-o+1;s++)for(var c=0;c<i.Define.MAP_SIZE-n+1;c++){for(var l=e.getFirstIndex(),u=l.y+s,h=l.x+c,d=!0,p=0;p<a.length;p++){var f=e.getRelativePosWithFirstInMap(p,u,h);if(!this._checkPut(f.y,f.x)){d=!1;break}}if(d&&(r.push(cc.v2(u,h)),r.length>1))break}return r},t.prototype.checkCrash=function(e,t){for(var o=[],n=[],a=[],r=0,s=e;r<s.length;r++){var c=s[r],u=c.row,h=c.col;o.indexOf(u)<0&&o.push(u),n.indexOf(h)<0&&n.push(h),a.push(this.blockMap[u][h])}for(var d=[],p=[],f=0,_=o;f<_.length;f++){u=_[f];var g=!0,v=[];for(h=0;h<i.Define.MAP_SIZE;h++){if(null===this.blockMap[u][h]){g=!1;break}v.push(this.blockMap[u][h])}g&&d.push(v)}for(var m=0,y=n;m<y.length;m++){h=y[m],g=!0;var S=[];for(u=0;u<i.Define.MAP_SIZE;u++){if(null===this.blockMap[u][h]){g=!1;break}S.push(this.blockMap[u][h])}g&&p.push(S)}var w=d.length+p.length,b=l.default.getScoreByAddition(e.length);this.score+=b,this.showScore+=b,0===w||(this.doCrash(d,p,a,t),this.checkPopCoupon())},t.prototype.doCrash=function(e,t,o,n){var a=this,r=e.length+t.length;m.default.playSFX("be"+Math.getRandomInt(1,7));var s=[],u=[],h=[],d=[];function p(e,t){t<e.actionOrder&&(e.actionOrder=t,u.indexOf(e)<0&&u.push(e))}for(var f=0,_=e;f<_.length;f++){var g=_[f],v=[],S=g[0].mapRow;d.push(S);for(var w=0,b=g;w<b.length;w++){var C=b[w];o.indexOf(C)>=0&&(v.push(C.mapCol),s.indexOf(C)<0&&s.push(C))}if(v.length%2==0){for(var P=v.sum()/v.length,E=Math.floor(P),T=Math.ceil(P),D=E;D>=0;D--){p(this.blockMap[S][D],E-D)}for(D=T;D<i.Define.MAP_SIZE;D++){p(this.blockMap[S][D],D-T)}}else{P=v.sum()/v.length;p(this.blockMap[S][P],0);for(T=P+1,D=E=P-1;D>=0;D--){p(this.blockMap[S][D],E-D+1)}for(D=T;D<i.Define.MAP_SIZE;D++){p(this.blockMap[S][D],D-T+1)}}}for(var L=0,A=t;L<A.length;L++){var x=A[L];v=[],D=x[0].mapCol;h.push(D);for(var R=0,O=x;R<O.length;R++){C=O[R];o.indexOf(C)>=0&&(v.push(C.mapRow),s.indexOf(C)<0&&s.push(C))}if(v.length%2==0){for(P=v.sum()/v.length,E=Math.floor(P),T=Math.ceil(P),S=E;S>=0;S--){p(this.blockMap[S][D],E-S)}for(S=T;S<i.Define.MAP_SIZE;S++){p(this.blockMap[S][D],S-T)}}else{P=v.sum()/v.length;p(this.blockMap[P][D],0);for(T=P+1,S=E=P-1;S>=0;S--){p(this.blockMap[S][D],E-S+1)}for(S=T;S<i.Define.MAP_SIZE;S++){p(this.blockMap[S][D],S-T+1)}}}var k=l.default.getScoreByLine(r);y.default["addCrash"+r+"Time"](),this.score+=k,this.showScore+=k;for(var M=c.default.getCrashAniName(n),I=0,B=u;I<B.length;I++){C=B[I];this.blockMap[C.mapRow][C.mapCol]=null,this.blockList.remove(C),this.checkPropRemove(C),this.crashEffect2(C,M[1])}this.makeLight2(h,d,M[0]),this.addScore(s,Math.floor(k)),this.scheduleOnce(function(){a.gameUI.showScoreEffect(r)},.8)},t.prototype.crashEffect2=function(e,t){var o=this,n=this.effectPool.get(),i=n.getComponent(dragonBones.ArmatureDisplay);i.addEventListener(dragonBones.EventObject.COMPLETE,function(){i.removeEventListener(dragonBones.EventObject.COMPLETE),o.effectPool.put(n)}),t=t||c.default.getCrashAniName(e.colorIdx)[1],i.playAnimation(t,1),n.xy=e.xy,n.zIndex=10,this.effectList.push(n),this.crashBlock(e)},t.prototype.crashBlock=function(e,t){var o=this;void 0===t&&(t=.5),e.node.runAction(cc.sequence(cc.scaleTo(t,0).easing(cc.easeBackIn()),cc.callFunc(function(e){o.blockPool.put(e)})))},t.prototype.makeLight2=function(e,t,o){var n=this;function a(e,t){var i=n.effectPool.get(),a=i.getComponent(dragonBones.ArmatureDisplay);a.addEventListener(dragonBones.EventObject.COMPLETE,function(){a.removeEventListener(dragonBones.EventObject.COMPLETE),n.effectPool.put(i)}),a.playAnimation(o,1),i.xy=e,i.angle=t,i.zIndex=9}for(var r=0,s=e;r<s.length;r++){var c=s[r],l=(i.Define.MAP_SIZE-1)/2;a(this._getBlockPos(l,c),90)}for(var u=0,h=t;u<h.length;u++){l=h[u],c=(i.Define.MAP_SIZE-1)/2;a(this._getBlockPos(l,c),0)}},t.prototype.crashEffect=function(e,t){var o=this,n=0;t>0&&(n=e.actionOrder),e.node.stopAllActions(),e.node.zIndex=i.Define.MAP_SIZE-n,e.node.runAction(cc.sequence(cc.delayTime(n*i.Define.CRASH_DELAY),cc.callFunc(function(n){t>0&&o.makeLight(e,t)}),cc.scaleTo(.6,0).easing(cc.easeBackIn()),cc.callFunc(function(e){o.blockPool.put(e)})))},t.prototype.makeLight=function(e,t){var o=this,n=this.effectPool.get();n.getComponent(cc.ParticleSystem).resetSystem(),n.xy=e.xy,n.zIndex=10,this.effectList.push(n);var i=n.xy;n.stopAllActions(),n.runAction(cc.sequence(cc.delayTime(.2),cc.floatTo(1,0,1,function(e,t){var a=r.pp.getNodePos(o.gameUI.scorePBLight,o.blockNode).sub(i);n.xy=i.add(a.mul(e))}).easing(cc.easeBackIn()),cc.callFunc(function(e){o.showScore+=t,e.getComponent(cc.ParticleSystem).stopSystem(),o.scheduleOnce(function(t){o.effectPool.put(e),o.effectList.remove(e)},1)})))},t.prototype.addScore=function(e,t){for(var o=0,n=0,a=i.Define.MAP_SIZE-1,r=i.Define.MAP_SIZE-1,s=0,c=e;s<c.length;s++){var l=c[s],u=l.mapRow,h=l.mapCol;u<a&&(a=u),u>o&&(o=u),h<r&&(r=h),h>n&&(n=h)}var d=(a+o)/2,p=(r+n)/2,f=this._getBlockPos(d,p);this.scoreShowLabel.active=!0,this.scoreShowLabel.scale=0,this.scoreShowLabel.string="+"+Math.floor(t),this.scoreShowLabel.position=f,this.scoreShowLabel.node.stopAllActions(),this.scoreShowLabel.node.runAction(cc.sequence(cc.scaleTo(.5,1).easing(cc.easeElasticOut(.5)),cc.delayTime(.5),cc.scaleTo(.5,0).easing(cc.easeElasticIn(.5))))},t.prototype.checkAnyShapeCanPut=function(){},t.prototype.revive=function(){var e=this;this.startEasyMode(),this.manager.hideDoor().then(function(){e.showReviveAni().then(function(){e.gameState=n.GAME;for(var t=Math.getRandomInt(20,31),o=0,i=e.blockList.getRandomCount(t).slice();o<i.length;o++){var a=i[o];e.crashEffect2(a),e.blockMap[a.mapRow][a.mapCol]=null,e.blockList.remove(a),e.checkPropRemove(a)}e.cleanBottomShapes(),e.makeBottomShapes(),e.saveStep()})})},t.prototype.showReviveAni=function(){return this.turnGrayAni(!1)},t.prototype.turnGrayAni=function(e){var t=this;return new Promise(function(o,n){var i=t.blockList.slice().upset();if(0!==i.length)for(var a=function(n){var a=t.blockList[n];a.node.runAction(cc.sequence(cc.delayTime(.025*n),cc.callFunc(function(t){a.turnGray(e),n===i.length-1&&o()})))},r=0;r<i.length;r++)a(r);else o()})},t.prototype._checkPut=function(e,t){return!(e<0||e>=i.Define.MAP_SIZE)&&(!(t<0||t>=i.Define.MAP_SIZE)&&null===this.blockMap[e][t])},t.prototype._onTouchStart=function(e){if(this.gameState!==n.PREPARE){var t=e.getLocation(),o=this.node.convertToNodeSpaceAR(t);if(3!==g.default.GuideIdx){if(0===g.default.GuideIdx&&this.propCrashNode.checkHit(t,this)&&l.default.propCrashCount>=0&&!this.hammer.active)return this.hammerCanCrash=!1,void this.usePropCrash(o);var i=this;if(null===this._chooseShape)for(var a=this.bottomSpace,r=this.bottomState.allCant,s=0;s<3;s++){if(cc.rect(this.bottomPos.x-a-a/2+a*s,this.bottomPos.y-this.bottomRect.height/2,1*a,this.bottomRect.height).contains(o)){var c=this.shapeList[s];if(null!==c){if(!1===c.isGray){if(1===g.default.GuideIdx){0===s&&(h(c),c.zIndex=15,this.guideLayer.hideFinger());break}if(2===g.default.GuideIdx){1===s&&(h(c),c.zIndex=15,this.guideLayer.hideFinger());break}h(c);break}if(r){if(l.default.propChangeCount>0){u.Common.toastCode("prop_change_warn_tip");break}if(l.default.propCrashCount>0){u.Common.toastCode("prop_crash_warn_tip");break}}}}}}}function h(e){m.default.playSFX("hand"),i._chooseShape=e,e.beChoose(o),i.checkProjection(),i.checkShowSingle(e)}},t.prototype._onTouchMove=function(e){if(this.gameState!==n.PREPARE){var t=e.getDelta();if(this.hammer.active)return t.mag()>5&&(this.hammerCanCrash=!0),void this.showHammer(this.hammer.xy.add(t));if(null!==this._chooseShape){var o=this._chooseShape;o.xy=o.xy.add(t),this.checkProjection()}}},t.prototype._onTouchEnd=function(e){if(this.gameState!==n.PREPARE){if(this.hammer.active&&this.checkHammerCrash(),null!==this._chooseShape){var t=this._chooseShape,o=this.checkProjection();!1===o?(t.beRelease(this._getBottomPos(t.id)),1!==g.default.GuideIdx&&2!==g.default.GuideIdx||this.guideLayer.moveFinger()):(this.putToMap(o),1===g.default.GuideIdx?this.showGuide2():2===g.default.GuideIdx&&this.showGuide3()),this._chooseShape=null}this.cleanTipBlocks()}},t.prototype.checkPopCoupon=function(){},t.prototype.checkMakeProp=function(e){return!(this.score<WxSDK.special_prop_show_limit)&&((e||Math.getRandom(0,100))<=WxSDK.special_prop_chance&&this.propList.length<WxSDK.special_prop_max&&!l.default.doGuide&&(this.makeProp(),!0))},t.prototype.makeProp=function(){if(this.blockList.length>0){for(var e=[],t=0,o=this.blockList;t<o.length;t++){var n=o[t];null===n.prop&&e.push(n)}if(e.length>0){var a=e.getRandomOne();if(a&&null!==this.blockMap[a.mapRow][a.mapCol]){var r=[i.Define.PROP_TYPE.BOOM,i.Define.PROP_TYPE.FLASH].getRandomOne();this.createProp(a,r),l.default.doGuide2&&this.showPropGuide1(a)}}}},t.prototype.createProp=function(e,t){var o=cc.instantiate(this.propPrefab);this.blockNode.addChild(o),o.zIndex=3;var n=o.getComponent(w.default);n.manager=this,n.targetBlock=e,n.xy=e.xy,n.type=t,e.prop=n,this.propList.push(n)},t.prototype.triggerPropFlash=function(e){var t=this;this._chooseShape&&this._onTouchEnd(null);var o=e.targetBlock;if(o&&null!==this.blockMap[o.mapRow][o.mapCol]){for(var n=o.colorIdx,i=this.blockList.filter(function(e){return e.colorIdx===n}),a=function(e){var n=e.mapRow,i=e.mapCol;r.blockMap[n][i]=null,r.blockList.remove(e),r.checkPropRemove(e),e.node.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(n){var i=t.manager,a=i.aniManager.playAni("flashCrash","Sprite",1);if(t.blockNode.addChild(a.node,10),a.node.xy=e.xy,o!==e){a=i.aniManager.playAni("flash","Sprite",1),t.blockNode.addChild(a.node,11),a.node.xy=e.xy;var r=5*t.blockWidth,s=e.xy.sub(o.xy).mag()/r,c=e.xy.sub(o.xy),l=(c=cc.v2(c.x,c.y)).angle(cc.v2(1,0)),u=cc.misc.radiansToDegrees(c.y>0?l:-l);a.node.scaleX=s*(Math.getRandomBool()?-1:1),a.node.degrees=u,a.xy=cc.v2((e.x+o.x)/2,(e.y+o.y)/2)}t.crashBlock(e,.3)})))},r=this,s=0,c=i;s<c.length;s++){a(c[s])}var u=l.default.getScoreByAddition(i.length);this.score+=u,this.showScore+=u,this.addScore([o],u),m.default.playSFX("flash"),this.checkBottomCanPut(),this.saveStep()}},t.prototype.triggerPropBoom=function(e){var t=this;this._chooseShape&&this._onTouchEnd(null);var o=e.targetBlock;if(o&&null!==this.blockMap[o.mapRow][o.mapCol]){for(var n=o.mapRow,a=o.mapCol,r=[],s=-2;s<=2;s++)for(var c=function(e){if(n+s<0||n+s>=i.Define.MAP_SIZE||a+e<0||a+e>=i.Define.MAP_SIZE)return"continue";var o=u.blockMap[n+s][a+e];null!==o&&(r.push(o),u.blockMap[n+s][a+e]=null,u.blockList.remove(o),u.checkPropRemove(o),o.node.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(e){var n=t.manager.aniManager.playAni("boom","Sprite",1);t.blockNode.addChild(n.node,10),n.node.xy=o.xy,t.crashBlock(o,.3)}))))},u=this,h=-2;h<=2;h++)c(h);var d=l.default.getScoreByAddition(r.length);this.score+=d,this.showScore+=d,this.addScore([o],d),m.default.playSFX("boom"),this.checkBottomCanPut(),this.saveStep()}},t.prototype.checkPropRemove=function(e){if(e.prop){var t=e.prop;t.targetBlock=null,e.prop=null,this.propList.remove(t),t.remove(),3===g.default.GuideIdx&&(g.default.GuideIdx=0,l.default.doGuide2=!1,h.default.post(i.EventMsg.REMOVE_GUIDE_LAYER))}},t.prototype.showPropGuide1=function(e){var t=this;console.log("\u5c55\u793a\u9053\u5177\u5f15\u5bfc"),this.showGuide().then(function(){t.guideLayer.drawMask.active=!0,t.guideLayer.drawMask.clearDraw();var o=e.xy.sub(cc.v2(t.blockWidth/2,t.blockWidth/2));t.guideLayer.drawMask.drawRect(o.x,o.y,t.blockWidth,t.blockWidth),t.guideLayer.touchFinger(e.xy.sub(cc.v2(0,t.blockWidth/3))),t.guideLayer.showLabel(v.LanguageHandler.getLanguageData("prop_guide_tip1"),cc.v2(0,500)),g.default.GuideIdx=3})},t.prototype.refreshGuideScene=function(){l.default.backupsData={score:0,shapeArr:[5,5],blockDataList:[{row:3,col:0,colorIdx:0},{row:3,col:1,colorIdx:0},{row:3,col:2,colorIdx:0},{row:3,col:5,colorIdx:1},{row:3,col:6,colorIdx:1},{row:3,col:7,colorIdx:1},{row:4,col:0,colorIdx:2},{row:4,col:1,colorIdx:2},{row:4,col:2,colorIdx:2},{row:4,col:5,colorIdx:3},{row:4,col:6,colorIdx:3},{row:4,col:7,colorIdx:3}],propChangeTime:0,propCrashTime:0,reviveTime:0,propArr:[]},this.initWithData(),g.default.GuideIdx=1},t.prototype.showGuide=function(){var e=this;return new Promise(function(t,o){_.default.getPrefabAsync("panel/guideLayer",function(o){var n=cc.instantiate(o);n.xy=cc.v2(),e.blockNode.addChild(n,10),e.guideLayer=n.getComponent("GuideLayer"),t()})})},t.prototype.playGuide=function(){var e=this;this.showGuide().then(function(t){e.showGuide1()})},t.prototype.showGuide1=function(){this.guideLayer.drawMask.active=!0,this.guideLayer.drawMask.clearDraw();var e=this._getBlockPos(3,0).sub(cc.v2(this.blockWidth/2,this.blockWidth/2));this.guideLayer.drawMask.drawRect(e.x,e.y,this.mapWidth,2*this.blockWidth),e=this._getBottomPos(0),this.guideLayer.drawMask.drawCircle(e.x,e.y,cc.v2(75,75));var t=this._getBlockPos(3,3).add(cc.v2(0,this.blockWidth/2));this.guideLayer.showTipKuang(t,this.blockWidth,2*this.blockWidth),this.guideLayer.showLabel(v.LanguageHandler.getLanguageData("guide_tip1")),this.guideLayer.moveFinger(e,t)},t.prototype.showGuide2=function(){g.default.GuideIdx=2,this.guideLayer.drawMask.clearDraw();var e=this._getBlockPos(3,0).sub(cc.v2(this.blockWidth/2,this.blockWidth/2));this.guideLayer.drawMask.drawRect(e.x,e.y,this.mapWidth,2*this.blockWidth),e=this._getBottomPos(1),this.guideLayer.drawMask.drawCircle(e.x,e.y,cc.v2(75,75));var t=this._getBlockPos(3,4).add(cc.v2(0,this.blockWidth/2));this.guideLayer.showTipKuang(t,this.blockWidth,2*this.blockWidth),this.guideLayer.showLabel(v.LanguageHandler.getLanguageData("guide_tip2")),this.guideLayer.moveFinger(e,t)},t.prototype.showGuide3=function(){this.guideLayer.node.removeSelf(),this.guideLayer=null,g.default.GuideIdx=0,l.default.doGuide=!1,u.Common.delayToast(v.LanguageHandler.getLanguageData("guide_tip3"),2e3)},__decorate([P(d.default)],t.prototype,"gameUI",void 0),__decorate([P(cc.Node)],t.prototype,"db",void 0),__decorate([P(cc.Prefab)],t.prototype,"blockDb",void 0),__decorate([P(cc.Node)],t.prototype,"dbNode",void 0),__decorate([P(cc.Node)],t.prototype,"rect",void 0),__decorate([P(cc.Node)],t.prototype,"bottomRect",void 0),__decorate([P(cc.Node)],t.prototype,"blockNode",void 0),__decorate([P(cc.Prefab)],t.prototype,"blockPrefab",void 0),__decorate([P(cc.Prefab)],t.prototype,"tipBlockPrefab",void 0),__decorate([P(cc.Prefab)],t.prototype,"effectPrefab",void 0),__decorate([P(cc.Label)],t.prototype,"scoreShowLabel",void 0),__decorate([P(cc.Label)],t.prototype,"gameScoreLabel",void 0),__decorate([P(cc.Node)],t.prototype,"hammer",void 0),__decorate([P(cc.Node)],t.prototype,"propCrashNode",void 0),__decorate([P(f.default)],t.prototype,"stepOverView",void 0),__decorate([P(cc.Prefab)],t.prototype,"propPrefab",void 0),t=__decorate([C],t)}(a.default);o.default=E,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../common/SubViewController":"SubViewController","../../data/GameHandler":"GameHandler","../../data/HonorHandler":"HonorHandler","../../data/ReportHandler":"ReportHandler","../../data/ShapeBlocks":"ShapeBlocks","../../data/ShapeFactory":"ShapeFactory","../../submodule/component/UnitBase":"UnitBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/pp/PP":"PP","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/FileUtils":"FileUtils","../../submodule/utils/SoundUtils":"SoundUtils","../panel/GuideLayer":"GuideLayer","../unit/Block":"Block","../unit/PropNode":"PropNode","./GameUI":"GameUI"}],GameManager:[function(e,t,o){"use strict";cc._RF.push(t,"e53947PYRFAr6OD4GihGbrZ","GameManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./SceneBase"),i=e("./logic/DoorLayer"),a=e("./logic/LoadingLayer"),r=e("../submodule/utils/EventCenter"),s=e("../common/Define"),c=e("../submodule/utils/FileUtils"),l=e("../submodule/utils/LoaderUtils"),u=e("../common/Common"),h=e("../data/ServerHandler"),d=e("../data/HonorHandler"),p=e("../data/ShortcutHandler"),f=e("../submodule/utils/TaskStackHandler"),_=e("./logic/AniManager"),g=e("../data/DateTimerHandler"),v=cc._decorator,m=v.ccclass,y=v.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.doorLayer=null,t.loadingLayer=null,t.gameLayer=null,t.aniManager=null,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),"undefined"!=typeof wx&&wx.onHide(function(){h.default.doSaveData()}),f.TaskStackHandler.createTask(s.TaskMsg.MAIN_POP),r.default.register(s.EventMsg.REWARD_ADS_SHOW,this,function(){g.default.video_time_day++,console.log("\u4eca\u65e5\u89c2\u770b\u89c6\u9891\u6b21\u6570:",g.default.video_time_day),10===g.default.video_time_day&&WxSDK.reportEvent(WxSDK.ReportMsg.SHOW_VIDEO_10)}),r.default.register(s.EventMsg.PRELOAD_SCENE,this,this.init),r.default.register(s.EventMsg.SHOW_GAME,this,function(){t.loadingLayer&&t.loadingLayer.node&&(t.loadingLayer.node.removeSelf(),t.loadingLayer=null),t.doorLayer.hide().then(function(){t.gameLayer&&t.gameLayer.show(),r.default.register(s.EventMsg.ON_SHOW,t,t._onBackShow),t._onBackShow()})}),r.default.register(s.EventMsg.RESTART_GAME,this,function(){t.gameLayer&&(t.gameLayer.active=!0,t.doorLayer.hide().then(function(){t.gameLayer.show()}))}),r.default.register(s.EventMsg.ON_SHARE_COMPLETE,this,function(){d.default.addShareTime()}),r.default.register(s.EventMsg.ON_VIDEO_COMPLETE,this,function(){d.default.addVideoTime()}),r.default.register(s.EventMsg.HONOR_UPGRADE,this,function(){t.node.getChildByName("honorPanel")||u.Common.popPanel({name:"panel/honorPanel",callback:function(e){e.showUpgradeNode()}})}),this.doorLayer.manager=this,this.loadingLayer.manager=this,this.loadingLayer.active=!0},t.prototype.start=function(){this.doorLayer.zIndex=2,this.loadingLayer.zIndex=3,this.aniManager=this.getComponent(_.default),this.aniManager.manager=this},t.prototype.init=function(){var e=this;c.default.getPrefabAsync("layer/gameLayer",function(t){var o=cc.instantiate(t);e.node.addChild(o,1),o.xy=cc.v2(),e.gameLayer=o.getComponent("GameLayer"),e.gameLayer.manager=e;var n=l.default.loadProgress.loadScene;l.default.initBasePercent(n)})},t.prototype.showDoor=function(e){return this.doorLayer.show(e)},t.prototype.hideDoor=function(e){return this.doorLayer.hide(e)},t.prototype._onBackShow=function(e){var t=e?e.source:WxSDK.onShowEventList;console.log("######\u5904\u7406\u540e\u53f0\u4e8b\u4ef6#########:",t);for(var o=0,n=t;o<n.length;o++){var i=n[o];if(i&&i.flag)switch(i.flag){case"shortcut":this._checkShortcut(i)}}},t.prototype._checkShortcut=function(e){p.default.shortCutGet||(p.default.shortCutGet=!0,WxSDK.reportEvent(WxSDK.ReportMsg.SHORTCUT),h.default.doSaveData(),console.log("\u6536\u85cf\u6210\u529f"),f.TaskStackHandler.addTask(s.TaskMsg.MAIN_POP,{name:s.TaskNames.POP_SHORTCUT_REWARD,callback:function(){console.log("pop_panel"),u.Common.popPanel({name:"panel/shortcutGetPanel"})}}))},__decorate([y(i.default)],t.prototype,"doorLayer",void 0),__decorate([y(a.default)],t.prototype,"loadingLayer",void 0),t=__decorate([m],t)}(n.default);o.default=S,cc._RF.pop()},{"../common/Common":"Common","../common/Define":"Define","../data/DateTimerHandler":"DateTimerHandler","../data/HonorHandler":"HonorHandler","../data/ServerHandler":"ServerHandler","../data/ShortcutHandler":"ShortcutHandler","../submodule/utils/EventCenter":"EventCenter","../submodule/utils/FileUtils":"FileUtils","../submodule/utils/LoaderUtils":"LoaderUtils","../submodule/utils/TaskStackHandler":"TaskStackHandler","./SceneBase":"SceneBase","./logic/AniManager":"AniManager","./logic/DoorLayer":"DoorLayer","./logic/LoadingLayer":"LoadingLayer"}],GameUI:[function(e,t,o){"use strict";cc._RF.push(t,"cf1d139VQVEVJvMioeSAq3A","GameUI"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/UnitBase"),i=e("../../data/GameHandler"),a=e("../../common/Common"),r=e("../../submodule/utils/EventCenter"),s=e("../../common/Define"),c=e("../../submodule/pp/PP"),l=e("../../submodule/data/SettingHandler"),u=e("../../custom-complete/PPToggle"),h=e("../panel/GuideLayer"),d=e("./GameLayer"),p=e("../unit/ScoreEffect"),f=e("../../submodule/data/LanguageHandler"),_=e("../unit/HonorIcon"),g=e("../../data/HonorHandler"),v=e("../../submodule/component/ActionBase"),m=cc._decorator,y=m.ccclass,S=m.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.bestScoreLabel=null,t.propCountLabel=null,t.candleLight=null,t.dbProgressBar=null,t.scroll=null,t.scrollButtonList=[],t.scoreProgressBar=null,t.scoreDbNode=null,t.scorePBLight=null,t.propCrashButton=null,t.propChangeButton=null,t.propCrashGetLabel=null,t.propHammerNode=null,t.soundButton=null,t.warnTipNode=null,t.scoreEffectPrefab=null,t.honorButton=null,t.honorIcon=null,t.couponButton=null,t._buttonOriginPosList=[],t}return __extends(t,e),t.prototype.onLoad=function(){r.default.register(s.EventMsg.PROP_CRASH_CHANGE,this,this.refreshPropCrash),r.default.register(s.EventMsg.PROP_CHANGE_CHANGE,this,this.refreshPropCountLabel),r.default.register(s.EventMsg.MISSIONS_REFRESH,this,this.checkHonorButton),r.default.register(s.EventMsg.SHOW_COUPON_BUTTON,this,this.checkShowCouponButton),r.default.register(s.EventMsg.ON_CONFIG_LOADED,this,this.checkConfig),this.manager=this.getComponent("GameLayer")},t.prototype.onDisable=function(){for(var e=0;e<this.scrollButtonList.length;e++){var t=this.scrollButtonList[e];t.opacity=0,t.xy=this._buttonOriginPosList[e]}this.dbProgressBar.progress=.2,this.scoreProgressBar.progress=0,this.scroll.x=this.dbProgressBar.progress*this.dbProgressBar.width-this.dbProgressBar.width/2},t.prototype.start=function(){this.init(),this.checkShowCouponButton(),this.checkHonorButton(),this.soundButton.isCheck=l.default.musicState,this.warnTipNode.active=!1},t.prototype.refresh=function(){this.refreshPropCountLabel(),this.refreshPropCrash(),this.refreshBestScoreLabel(),this.hideWarnTipNode()},t.prototype.init=function(){this.scoreLabel.string=String(0);var e=this;(function t(){e.candleLight.runAction(cc.sequence(cc.fadeTo(2,0),cc.fadeTo(3,255),cc.delayTime(Math.getRandom(3,5)),cc.callFunc(function(e){t()})))})();for(var t=0,o=this.scrollButtonList;t<o.length;t++){var n=o[t];n.opacity=0,this._buttonOriginPosList.push(n.xy)}this.dbProgressBar.progress=.2,this.scoreProgressBar.progress=0,this.scorePBLight.opacity=0},t.prototype.showScoreEffect=function(e){if(!(e<2)){var t=cc.instantiate(this.scoreEffectPrefab),o=this.manager;o.blockNode.addChild(t,20);var n=t.getComponent(p.default);return t.xy=cc.v2(-50,o.mapPos.y),n.show(e),t}},t.prototype.playScrollAni=function(){for(var e=this,t=0,o=this.scrollButtonList;t<o.length;t++){(i=o[t]).stopAllActions(),i.opacity=0}this.dbProgressBar.node.runAction(cc.sequence(cc.floatTo(.5,.2,1,function(t){e.dbProgressBar.progress=t,e.scroll.x=t*e.dbProgressBar.width-e.dbProgressBar.width/2}),cc.callFunc(function(e){})));for(var n=0;n<this.scrollButtonList.length;n++){var i=this.scrollButtonList[n],a=this._buttonOriginPosList[n].x;i.x=a-100,i.runAction(cc.sequence(cc.delayTime(.125*(n+1)),cc.spawn(cc.fadeIn(.3),cc.moveTo(.5,a,i.y).easing(cc.easeBackOut()))))}},t.prototype.playScrollAniIn=function(){for(var e=this,t=0,o=this.scrollButtonList;t<o.length;t++){(i=o[t]).stopAllActions()}this.dbProgressBar.node.runAction(cc.sequence(cc.floatTo(.5,1,.2,function(t){e.dbProgressBar.progress=t,e.scroll.x=t*e.dbProgressBar.width-e.dbProgressBar.width/2}),cc.callFunc(function(e){})));for(var n=0;n<this.scrollButtonList.length;n++){var i=this.scrollButtonList[n],a=this._buttonOriginPosList[n].x;i.runAction(cc.sequence(cc.delayTime(.125*(this.scrollButtonList.length-1-n)),cc.spawn(cc.fadeOut(.3),cc.moveTo(.3,a-100,i.y))))}},t.prototype.showWarnTipNode=function(e){var t;e===s.Define.PROP_TYPE.CHANGE?t=c.pp.getNodePos(this.propChangeButton.node,this.node).add(cc.v2(0,this.propChangeButton.height/2)):e===s.Define.PROP_TYPE.CRASH&&(t=c.pp.getNodePos(this.propCrashButton.node,this.node).add(cc.v2(0,this.propCrashButton.height/2))),this.warnTipNode.active=!0,this.warnTipNode.xy=t},t.prototype.hideWarnTipNode=function(){this.warnTipNode.active=!1},t.prototype.refreshScoreLabel=function(e,t){var o=this;if(0===t)return this.scoreLabel.string=f.LanguageHandler.getLanguageDataWithArgs("title_score",t.toString()),void this.refreshScoreProgressBar();var n=Math.min(s.Define.SCORE_CHANGE_DURATION,.05*Math.abs(t-e));this.scoreProgressBar.node.stopAllActions(),this.scoreProgressBar.node.runAction(cc.sequence(cc.floatTo(n,e,t,function(e){var t=Math.floor(e);a.Common.jumpLabel(o.scoreLabel,f.LanguageHandler.getLanguageDataWithArgs("title_score",t)),o.refreshBestScoreLabel(t);var n=Math.min(e/i.default.bestScore,1);o.refreshScoreProgressBar(n)}),cc.callFunc(function(e){var n=Math.floor(t).toString();o.scoreLabel.string=f.LanguageHandler.getLanguageDataWithArgs("title_score",n),o.refreshBestScoreLabel(n);var a=Math.min(t/i.default.bestScore,1);o.refreshScoreProgressBar(a)})))},t.prototype.refreshScoreProgressBar=function(e){void 0===e&&(e=0),isNaN(e)&&(e=1),this.scoreDbNode.opacity=e>0?255:0,this.scorePBLight.opacity=e>0?255:0,this.scoreProgressBar.progress=e;var t=this.scoreProgressBar.barSprite.node,o=.98*t.width,n=t.x-o*t.anchorX+e*o;this.scorePBLight.y=t.y,this.scorePBLight.x=n;var i=c.pp.getNodePos(t,this.node);this.scoreDbNode.x=i.x-o*t.anchorX+e*o,this.scoreDbNode.y=i.y-5},t.prototype.refreshBestScoreLabel=function(e){void 0===e?this.bestScoreLabel.string=f.LanguageHandler.getLanguageDataWithArgs("title_score",i.default.bestScore.toString()):Number(e)>i.default.bestScore&&a.Common.jumpLabel(this.bestScoreLabel,f.LanguageHandler.getLanguageDataWithArgs("title_score",e))},t.prototype.refreshPropCountLabel=function(){var e=i.default.propChangeCount+"/"+WxSDK.prop_change_count;a.Common.jumpLabel(this.propCountLabel,e);var t=this.manager.hasPropChange();this.buttonTurnGray(this.propChangeButton.node,!t)},t.prototype.refreshPropCrash=function(){var e=this.manager;if(i.default.propCrashCount>0)this.propCrashGetLabel.active=!1,this.propHammerNode.active=!0,this.propCrashButton.enabled=!1,this.buttonTurnGray(this.propCrashButton.node,!1);else{var t=e.hasPropCrash();this.propCrashGetLabel.active=t,this.buttonTurnGray(this.propCrashButton.node,!t),this.propHammerNode.active=!1,this.propCrashButton.enabled=!0}},t.prototype.setHammerActive=function(e){this.propHammerNode.active=e},t.prototype.buttonTurnGray=function(e,t){var o=t?cc.Sprite.State.GRAY:cc.Sprite.State.NORMAL,n=t?cc.color().fromHEX("#B0B0B0"):cc.color().fromHEX("#D7DE88");c.pp.setChildrenGreyState(e,o,n)},t.prototype.checkConfig=function(){this.checkShowCouponButton()},t.prototype.checkShowCouponButton=function(){WxSDK.pdd_toggle&&i.default.hasCoupon?this.couponButton.active=!0:this.couponButton.active=!1},t.prototype.checkHonorButton=function(){var e=g.default.getMissionComplete();this.honorIcon.show(g.default.honorId),e?(this.honorButton.playAction(),this.honorButton.node.getChildByName("red").active=!0):(this.honorButton.stopAction(),this.honorButton.node.getChildByName("red").active=!1)},t.prototype.buttonCallback=function(e,t){if(0===h.default.GuideIdx){var o=this.manager;if(o.gameState===d.GameState.GAME)switch(t){case"prop_crash":if(i.default.propCrashCount<=0){if(!o.hasPropCrash())return void a.Common.toastCode("prop_crash_use_up");a.Common.popPanel({name:"panel/propGetPanel",callback:function(e){e.init(s.Define.PROP_TYPE.CRASH)}})}break;case"prop_change":if(i.default.propChangeCount>0)r.default.post(s.EventMsg.USE_PROP_CHANGE),this.refreshPropCountLabel();else{if(!o.hasPropChange())return void a.Common.toastCode("prop_change_use_up");a.Common.popPanel({name:"panel/propGetPanel",callback:function(e){e.init(s.Define.PROP_TYPE.CHANGE)}})}break;case"reset":a.Common.popPanel({name:"panel/tipsPanel",callback:function(e){e.init({text:f.LanguageHandler.getLanguageData("reset_tip"),showCancel:!0,confirm:function(){r.default.post(s.EventMsg.RESET_GAME)}})}});break;case"rank":a.Common.popPanel({name:"panel/rankPanel",callback:function(e){e.init(SubViewType.FRIEND_RANK)}});break;case"turn_sound":l.default.turnSound(e.isCheck);break;case"openHonor":a.Common.popPanel({name:"panel/honorPanel"});break;case"coupon":a.Common.popPanel({name:"panel/pddCouponPanel"})}}},__decorate([S(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([S(cc.Label)],t.prototype,"bestScoreLabel",void 0),__decorate([S(cc.Label)],t.prototype,"propCountLabel",void 0),__decorate([S(cc.Node)],t.prototype,"candleLight",void 0),__decorate([S(cc.ProgressBar)],t.prototype,"dbProgressBar",void 0),__decorate([S(cc.Node)],t.prototype,"scroll",void 0),__decorate([S([cc.Node])],t.prototype,"scrollButtonList",void 0),__decorate([S(cc.ProgressBar)],t.prototype,"scoreProgressBar",void 0),__decorate([S(cc.Node)],t.prototype,"scoreDbNode",void 0),__decorate([S(cc.Node)],t.prototype,"scorePBLight",void 0),__decorate([S(cc.Button)],t.prototype,"propCrashButton",void 0),__decorate([S(cc.Button)],t.prototype,"propChangeButton",void 0),__decorate([S(cc.Node)],t.prototype,"propCrashGetLabel",void 0),__decorate([S(cc.Node)],t.prototype,"propHammerNode",void 0),__decorate([S(u)],t.prototype,"soundButton",void 0),__decorate([S(cc.Node)],t.prototype,"warnTipNode",void 0),__decorate([S(cc.Prefab)],t.prototype,"scoreEffectPrefab",void 0),__decorate([S(v.default)],t.prototype,"honorButton",void 0),__decorate([S(_.default)],t.prototype,"honorIcon",void 0),__decorate([S(cc.Node)],t.prototype,"couponButton",void 0),t=__decorate([y],t)}(n.default);o.default=w,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../custom-complete/PPToggle":"PPToggle","../../data/GameHandler":"GameHandler","../../data/HonorHandler":"HonorHandler","../../submodule/component/ActionBase":"ActionBase","../../submodule/component/UnitBase":"UnitBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/data/SettingHandler":"SettingHandler","../../submodule/pp/PP":"PP","../../submodule/utils/EventCenter":"EventCenter","../panel/GuideLayer":"GuideLayer","../unit/HonorIcon":"HonorIcon","../unit/ScoreEffect":"ScoreEffect","./GameLayer":"GameLayer"}],GuideLayer:[function(e,t,o){"use strict";cc._RF.push(t,"dfe3ffPj4hDhYU9M6+QhPwl","GuideLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/Common"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rectMask=null,t.circleMask=null,t.tipLabel=null,t.drawMask=null,t.finger=null,t.fingerSavePos1=cc.v2(),t.fingerSavePos2=cc.v2(),t.tipKuang=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.rectMask.active=!1,this.circleMask.active=!1,this.tipLabel.active=!1,this.drawMask.active=!1,this.finger.active=!1,this.tipKuang.active=!1},t.prototype.showCircleMask=function(e,t){return this.circleMask.active=!0,this.circleMask.width=e,this.circleMask.height=e,this.circleMask.xy=t,this.circleMask},t.prototype.hideCircleMask=function(){this.circleMask.active=!1},t.prototype.showRectMask=function(e,t,o,n){return this.rectMask.active=!0,this.rectMask.width=o,this.rectMask.height=n,this.rectMask.x=e+o/2,this.rectMask.y=t+n/2,this.rectMask},t.prototype.hideRectMask=function(){this.rectMask.active=!1},t.prototype.showLabel=function(e,t){return this.tipLabel.node.active=!0,t&&(this.tipLabel.node.xy=t),n.Common.jumpLabel(this.tipLabel,e),this.tipLabel},t.prototype.moveFinger=function(e,t){return void 0===e&&(e=this.fingerSavePos1),void 0===t&&(t=this.fingerSavePos2),this.finger.active=!0,this.finger.xy=e,this.finger.scale=1.2,this.finger.stopAllActions(),this.finger.runAction(cc.sequence(cc.scaleTo(.5,1),cc.moveTo(1,t),cc.spawn(cc.scaleTo(.5,1.2),cc.moveTo(.5,e))).repeatForever()),this.fingerSavePos1=e,this.fingerSavePos2=t,this.finger},t.prototype.touchFinger=function(e){return void 0===e&&(e=this.fingerSavePos1),this.finger.active=!0,this.finger.xy=e,this.finger.scale=1.1,this.finger.stopAllActions(),this.finger.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(.2),cc.scaleTo(.2,1.1)).repeatForever()),this.fingerSavePos1=e,this.finger},t.prototype.hideFinger=function(){this.finger.active=!1},t.prototype.showTipKuang=function(e,t,o){return this.tipKuang.active=!0,this.tipKuang.stopAllActions(),this.tipKuang.opacity=255,this.tipKuang.runAction(cc.sequence(cc.fadeOut(1),cc.fadeIn(1)).repeatForever()),this.tipKuang.xy=e,this.tipKuang.width=t,this.tipKuang.height=o,this.tipKuang},t.GuideIdx=0,__decorate([r(cc.Node)],t.prototype,"rectMask",void 0),__decorate([r(cc.Node)],t.prototype,"circleMask",void 0),__decorate([r(cc.Label)],t.prototype,"tipLabel",void 0),__decorate([r(cc.Mask)],t.prototype,"drawMask",void 0),__decorate([r(cc.Node)],t.prototype,"finger",void 0),__decorate([r(cc.Node)],t.prototype,"tipKuang",void 0),t=__decorate([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../../common/Common":"Common"}],HonorHandler:[function(e,t,o){"use strict";cc._RF.push(t,"9e76ffNqKVB2YtglO4ihI0l","HonorHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/data/DataHandler"),i=e("../submodule/utils/EventCenter"),a=e("../common/Define"),r=e("./HonorMission"),s=e("../common/Common"),c=e("./ServerHandler"),l=e("./GameHandler"),u={crash1Data:{default:{time:0,received:0},saveServer:!0},crash2Data:{default:{time:0,received:0},saveServer:!0},crash3Data:{default:{time:0,received:0},saveServer:!0},crash4Data:{default:{time:0,received:0},saveServer:!0},crash5Data:{default:{time:0,received:0},saveServer:!0},crash6Data:{default:{time:0,received:0},saveServer:!0},videoData:{default:{time:0,received:0},saveServer:!0},shareData:{default:{time:0,received:0},saveServer:!0},bestScoreData:{default:{received:0},saveServer:!0},otherAddition:{default:0,saveServer:!0}},h=function(){return function(e){this.id=e.id,this.iconUrl="honor/honorIcon"+(e.icon_id-1),this.star=e.star,this.needExp=e.needScore,this.addition=e.addition,this.nameUrl="honor/title"+this.id}}();o.HonorData=h;var d=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._honorConfig=new Map,t._missionMap=new Map,t}return __extends(t,e),Object.defineProperty(t.prototype,"honorExp",{get:function(){for(var e=0,t=0,o=Array.from(this._missionMap.values());t<o.length;t++){e+=o[t].getTotalRecivedExp()}return e+=this.otherAddition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"honorId",{get:function(){for(var e=this._honorConfig.size,t=0,o=Array.from(this._honorConfig.values());t<o.length;t++){var n=o[t];if(this.honorExp<n.needExp)return n.id}return e},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this._configURLList=["honor","honorMission"],this.serverKey="honorData",this._tableKey="HonorKey",this.initTableData(u)},t.prototype.onLoadConfig=function(e){var t=e.honor.config,o=e.honorMission.config;for(var n in t){var i=t[n];this._honorConfig.set(i.id,new h(i))}for(var n in this._missionMap.set(r.HonorMissionType.CRASH1,new r.HonorMissionCrash1),this._missionMap.set(r.HonorMissionType.CRASH2,new r.HonorMissionCrash2),this._missionMap.set(r.HonorMissionType.CRASH3,new r.HonorMissionCrash3),this._missionMap.set(r.HonorMissionType.CRASH4,new r.HonorMissionCrash4),this._missionMap.set(r.HonorMissionType.CRASH5,new r.HonorMissionCrash5),this._missionMap.set(r.HonorMissionType.CRASH6,new r.HonorMissionCrash6),this._missionMap.set(r.HonorMissionType.VIDEO_TIME,new r.HonorMissionVideo),this._missionMap.set(r.HonorMissionType.SHARE_TIME,new r.HonorMissionShare),this._missionMap.set(r.HonorMissionType.BEST_SCORE,new r.HonorMissionBestScore),o){var a=o[n],s=new r.HonorMissionData(a);s.type===r.HonorMissionType.CRASH1?this._missionMap.get(r.HonorMissionType.CRASH1).missionMap.set(s.level,s):s.type===r.HonorMissionType.CRASH2?this._missionMap.get(r.HonorMissionType.CRASH2).missionMap.set(s.level,s):s.type===r.HonorMissionType.CRASH3?this._missionMap.get(r.HonorMissionType.CRASH3).missionMap.set(s.level,s):s.type===r.HonorMissionType.CRASH4?this._missionMap.get(r.HonorMissionType.CRASH4).missionMap.set(s.level,s):s.type===r.HonorMissionType.CRASH5?this._missionMap.get(r.HonorMissionType.CRASH5).missionMap.set(s.level,s):s.type===r.HonorMissionType.CRASH6?this._missionMap.get(r.HonorMissionType.CRASH6).missionMap.set(s.level,s):s.type===r.HonorMissionType.VIDEO_TIME?this._missionMap.get(r.HonorMissionType.VIDEO_TIME).missionMap.set(s.level,s):s.type===r.HonorMissionType.SHARE_TIME?this._missionMap.get(r.HonorMissionType.SHARE_TIME).missionMap.set(s.level,s):s.type===r.HonorMissionType.BEST_SCORE&&this._missionMap.get(r.HonorMissionType.BEST_SCORE).missionMap.set(s.level,s)}this._missionMap.forEach(function(e){e.init()}),console.log(t)},t.prototype.onDataLoadOver=function(){this._oldHonorId=this.honorId},t.prototype.getHonorDataById=function(e){return this._honorConfig.get(e)},t.prototype.getCurHonorData=function(){return this._honorConfig.get(this.honorId)},t.prototype.getCurAddition=function(){return this.getCurHonorData().addition/100},t.prototype.getNexHonorData=function(){var e=this.honorId+1;return e>this._honorConfig.size?null:this._honorConfig.get(e)},t.prototype.addHonorExp=function(e){return this.checkUpgrade()?(c.default.doSaveData(),i.default.post(a.EventMsg.HONOR_UPGRADE),!0):(d.saveTableData(),!1)},t.prototype.addOtherExp=function(e){this.otherAddition+=e,s.Common.toast("\u589e\u52a0"+e+"\u70b9\u6210\u5c31\u70b9"),this.addHonorExp(),i.default.post(a.EventMsg.MISSIONS_REFRESH)},t.prototype.checkUpgrade=function(){return this._oldHonorId!==this.honorId&&(console.log("\u5347\u7ea7\u4e86\uff1a",this._oldHonorId,this.honorId),l.default.updateScore(),this._oldHonorId=this.honorId,!0)},t.prototype.getMission=function(e){return this._missionMap.get(e)},t.prototype.getSortMissions=function(){var e=this._missionMap.values(),t=Array.from(e);return t.sort(function(e,t){var o=e.type,n=t.type;return 10*(e.curState===r.MissionState.COMPLETE?1:e.curState===r.MissionState.PROGRESS?2:3)+o-(10*(t.curState===r.MissionState.COMPLETE?1:t.curState===r.MissionState.PROGRESS?2:3)+n)}),t},t.prototype.getMissionComplete=function(){for(var e=0,t=Array.from(this._missionMap.values());e<t.length;e++){if(t[e].curState===r.MissionState.COMPLETE)return!0}return!1},t.prototype.addCrash1Time=function(e){void 0===e&&(e=1),this.crash1Data.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.CRASH1)},t.prototype.addCrash2Time=function(e){void 0===e&&(e=1),this.crash2Data.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.CRASH2)},t.prototype.addCrash3Time=function(e){void 0===e&&(e=1),this.crash3Data.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.CRASH3)},t.prototype.addCrash4Time=function(e){void 0===e&&(e=1),this.crash4Data.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.CRASH4)},t.prototype.addCrash5Time=function(e){void 0===e&&(e=1),this.crash5Data.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.CRASH5)},t.prototype.addCrash6Time=function(e){void 0===e&&(e=1),this.crash6Data.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.CRASH6)},t.prototype.addVideoTime=function(e){void 0===e&&(e=1),this.videoData.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.VIDEO_TIME)},t.prototype.addShareTime=function(e){void 0===e&&(e=1),this.shareData.time+=e,i.default.post(a.EventMsg.MISSION_HAVE_CHANGE,r.HonorMissionType.SHARE_TIME)},t}(n.default));o.default=d,cc._RF.pop()},{"../common/Common":"Common","../common/Define":"Define","../submodule/data/DataHandler":"DataHandler","../submodule/utils/EventCenter":"EventCenter","./GameHandler":"GameHandler","./HonorMission":"HonorMission","./ServerHandler":"ServerHandler"}],HonorIcon:[function(e,t,o){"use strict";cc._RF.push(t,"3129aUVeSFKlbrR5gVsNJ9T","HonorIcon"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../data/HonorHandler"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.nameLabel=null,t.starLayer=null,t}return __extends(t,e),t.prototype.show=function(e){var t=n.default.getHonorDataById(e);this.icon.url={url:t.iconUrl,callback:null},this.nameLabel.url={url:t.nameUrl,callback:null};for(var o=t.star,i=0;i<this.starLayer.children.length;++i){this.starLayer.children[i].active=i<o}},t.prototype.start=function(){},__decorate([r(cc.Sprite)],t.prototype,"icon",void 0),__decorate([r(cc.Sprite)],t.prototype,"nameLabel",void 0),__decorate([r(cc.Node)],t.prototype,"starLayer",void 0),t=__decorate([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../../data/HonorHandler":"HonorHandler"}],HonorMissionCell:[function(e,t,o){"use strict";cc._RF.push(t,"116cabRiSlFkK53P07oQRpo","HonorMissionCell"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../custom-complete/tableView/viewCell"),i=e("../../data/HonorMission"),a=e("../../submodule/utils/EventCenter"),r=e("../../common/Define"),s=e("../../submodule/pp/PP"),c=e("../../common/CommonNode"),l=e("../../data/HonorHandler"),u=e("../../common/Common"),h=e("../../submodule/utils/SoundUtils"),d=e("../GameManager"),p=e("../logic/GameLayer"),f=cc._decorator,_=f.ccclass,g=f.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.iconFrames=[],t.termLabel=null,t.progressBar=null,t.progressLabel=null,t.expRewardLabel=null,t.finishNode=null,t.completeNode=null,t.progressNode=null,t.starLayout=null,t}return __extends(t,e),t.prototype.start=function(){a.default.register(r.EventMsg.MISSION_HAVE_CHANGE,this,this._checkMissionChange)},t.prototype.init=function(e,t,o,n){var i=t.array[e];this._missionData=i,this._manager=t.manager,this.refresh()},t.prototype.refresh=function(){var e=this._missionData;this.termLabel.string=e.termStr;for(var t=0;t<this.starLayout.children.length;++t){this.starLayout.children[t].children[0].active=t+1<=e.curRecived}var o=e.curHave,n=e.curNeed;this.progressBar.progress=o/n,this.progressLabel.string=o+"/"+n;var a,r=e.curState;this.progressNode.active=r===i.MissionState.PROGRESS,this.completeNode.active=r===i.MissionState.COMPLETE,this.finishNode.active=r===i.MissionState.FINISHED,this.expRewardLabel.string=e.curExp+"",a=r===i.MissionState.FINISHED?this.iconFrames[3]:e.type===i.HonorMissionType.VIDEO_TIME?this.iconFrames[1]:e.type===i.HonorMissionType.SHARE_TIME?this.iconFrames[2]:e.type===i.HonorMissionType.BEST_SCORE?this.iconFrames[4]:this.iconFrames[0],this.icon.spriteFrame=a},t.prototype._checkMissionChange=function(e){var t=e.source;this._missionData&&t===this._missionData.type&&this.refresh()},t.prototype.buttonCallback=function(e,t){var o=this,n=e.target;switch(t){case"complete":this.completeNode.active=!1;var i=s.pp.getNodePos(n,c.default.Instant.node),f=s.pp.getNodePos(this._manager.expProgressBar.node,c.default.Instant.node),_=this._missionData.curExp,g=l.default.honorExp;c.default.Instant.showRewardAni(this._manager.starPool,10,i,f,g,_,function(e){},function(e){h.default.playSFX("get_diamond"),o._manager.refreshExp(e)},function(){u.Common.toastCode("exp_add",_);o._missionData.completeMission();a.default.post(r.EventMsg.MISSIONS_REFRESH)});break;case"progress":cc.find("Canvas").getComponent(d.default).gameLayer.gameState===p.GameState.PREPARE?(this._manager.setCustomCloseCallback(function(){a.default.post(r.EventMsg.RESTART_GAME_EVENT)}),this._manager.close()):this._manager.close()}},t.prototype.clicked=function(){},__decorate([g(cc.Sprite)],t.prototype,"icon",void 0),__decorate([g([cc.SpriteFrame])],t.prototype,"iconFrames",void 0),__decorate([g(cc.Label)],t.prototype,"termLabel",void 0),__decorate([g(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([g(cc.Label)],t.prototype,"progressLabel",void 0),__decorate([g(cc.Label)],t.prototype,"expRewardLabel",void 0),__decorate([g(cc.Node)],t.prototype,"finishNode",void 0),__decorate([g(cc.Node)],t.prototype,"completeNode",void 0),__decorate([g(cc.Node)],t.prototype,"progressNode",void 0),__decorate([g(cc.Node)],t.prototype,"starLayout",void 0),t=__decorate([_],t)}(n);o.default=v,cc._RF.pop()},{"../../common/Common":"Common","../../common/CommonNode":"CommonNode","../../common/Define":"Define","../../custom-complete/tableView/viewCell":"viewCell","../../data/HonorHandler":"HonorHandler","../../data/HonorMission":"HonorMission","../../submodule/pp/PP":"PP","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/SoundUtils":"SoundUtils","../GameManager":"GameManager","../logic/GameLayer":"GameLayer"}],HonorMission:[function(e,t,o){"use strict";cc._RF.push(t,"904aa4YyfhFAabuyG1y5p5u","HonorMission"),Object.defineProperty(o,"__esModule",{value:!0});var n,i,a=e("./HonorHandler"),r=e("../submodule/utils/EventCenter"),s=e("../common/Define"),c=e("./GameHandler"),l=e("../submodule/data/LanguageHandler");(function(e){e[e.CRASH1=1]="CRASH1",e[e.CRASH2=2]="CRASH2",e[e.CRASH3=3]="CRASH3",e[e.CRASH4=4]="CRASH4",e[e.CRASH5=5]="CRASH5",e[e.CRASH6=6]="CRASH6",e[e.VIDEO_TIME=7]="VIDEO_TIME",e[e.SHARE_TIME=8]="SHARE_TIME",e[e.BEST_SCORE=9]="BEST_SCORE"})(n=o.HonorMissionType||(o.HonorMissionType={})),function(e){e[e.PROGRESS=0]="PROGRESS",e[e.COMPLETE=1]="COMPLETE",e[e.FINISHED=2]="FINISHED"}(i=o.MissionState||(o.MissionState={}));var u=function(){return function(e){this.id=e.id,this.type=e.type,this.exp=e.score,this.level=e.level,this.need=e.need}}();o.HonorMissionData=u;var h=function(){function e(){var e=this;this.missionMap=new Map,this._oldState=null,r.default.register(s.EventMsg.MISSION_HAVE_CHANGE,this,function(t){t.source===e.type&&e._oldState!==e.curState&&(console.log("old:",e._oldState,"cur:",e.curState),e.postRefresh())})}return Object.defineProperty(e.prototype,"curLevel",{get:function(){for(var e=this.missionMap.size,t=0,o=Array.from(this.missionMap.values());t<o.length;t++){var n=o[t];if(n.level>this.curRecived+1){e=this.curRecived+1;break}this.curHave<n.need&&(e=n.level)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curMission",{get:function(){return this.missionMap.get(this.curLevel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curExp",{get:function(){return this.curMission.exp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curNeed",{get:function(){return this.curMission.need},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curState",{get:function(){var e=this._getTotalMissionCount();return this.curLevel===e&&this.curRecived===e?i.FINISHED:this.curHave>=this.curNeed?i.COMPLETE:i.PROGRESS},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._oldState=this.curState},e.prototype.postRefresh=function(){this._oldState=this.curState,r.default.post(s.EventMsg.MISSIONS_REFRESH)},e.prototype.completeMission=function(){console.log("\u4efb\u52a1\u5b8c\u6210"),this.curRecived=this.curLevel;var e=a.default.addHonorExp(this.curExp);return this._oldState=this.curState,e},e.prototype.getTotalRecivedExp=function(){for(var e=0,t=0;t<=this.curRecived;t++)this.missionMap.get(t)&&(e+=this.missionMap.get(t).exp);return e},e.prototype._getTotalMissionCount=function(){return this.missionMap.size},e}();o.HonorMission=h;var d=function(e){function t(){var t=e.call(this)||this;return t.type=n.CRASH1,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.crash1Data.received},set:function(e){a.default.crash1Data.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.crash1Data.time},set:function(e){a.default.crash1Data.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_crash").format(1,this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionCrash1=d;var p=function(e){function t(){var t=e.call(this)||this;return t.type=n.CRASH2,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.crash2Data.received},set:function(e){a.default.crash2Data.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.crash2Data.time},set:function(e){a.default.crash2Data.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_crash").format(2,this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionCrash2=p;var f=function(e){function t(){var t=e.call(this)||this;return t.type=n.CRASH3,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.crash3Data.received},set:function(e){a.default.crash3Data.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.crash3Data.time},set:function(e){a.default.crash3Data.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_crash").format(3,this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionCrash3=f;var _=function(e){function t(){var t=e.call(this)||this;return t.type=n.CRASH4,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.crash4Data.received},set:function(e){a.default.crash4Data.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.crash4Data.time},set:function(e){a.default.crash4Data.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_crash").format(4,this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionCrash4=_;var g=function(e){function t(){var t=e.call(this)||this;return t.type=n.CRASH5,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.crash5Data.received},set:function(e){a.default.crash5Data.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.crash5Data.time},set:function(e){a.default.crash5Data.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_crash").format(5,this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionCrash5=g;var v=function(e){function t(){var t=e.call(this)||this;return t.type=n.CRASH6,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.crash6Data.received},set:function(e){a.default.crash6Data.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.crash6Data.time},set:function(e){a.default.crash6Data.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_crash").format(6,this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionCrash6=v;var m=function(e){function t(){var t=e.call(this)||this;return t.type=n.VIDEO_TIME,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.videoData.received},set:function(e){a.default.videoData.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.videoData.time},set:function(e){a.default.videoData.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_video").format(this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionVideo=m;var y=function(e){function t(){var t=e.call(this)||this;return t.type=n.SHARE_TIME,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.shareData.received},set:function(e){a.default.shareData.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return a.default.shareData.time},set:function(e){a.default.shareData.time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_share").format(this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionShare=y;var S=function(e){function t(){var t=e.call(this)||this;return t.type=n.BEST_SCORE,t}return __extends(t,e),Object.defineProperty(t.prototype,"curRecived",{get:function(){return a.default.bestScoreData.received},set:function(e){a.default.bestScoreData.received=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHave",{get:function(){return c.default.bestScore},set:function(e){c.default.bestScore=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termStr",{get:function(){return l.LanguageHandler.getLanguageData("mission_best_score").format(this.curNeed)},enumerable:!0,configurable:!0}),t.prototype.onMissionChange=function(){},t}(h);o.HonorMissionBestScore=S,cc._RF.pop()},{"../common/Define":"Define","../submodule/data/LanguageHandler":"LanguageHandler","../submodule/utils/EventCenter":"EventCenter","./GameHandler":"GameHandler","./HonorHandler":"HonorHandler"}],HonorPanel:[function(e,t,o){"use strict";cc._RF.push(t,"6680aaoHd5InJeHLeAAsBiD","HonorPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../../custom-complete/tableView/tableView"),a=e("../../data/HonorHandler"),r=e("../../submodule/utils/EventCenter"),s=e("../../common/Define"),c=e("../../submodule/data/LanguageHandler"),l=e("../unit/HonorIcon"),u=e("../../submodule/pp/PP"),h=e("../unit/DelayShowButton"),d=e("../../submodule/utils/SoundUtils"),p=e("../GameManager"),f=e("../logic/GameLayer"),_=cc._decorator,g=_.ccclass,v=_.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.arrowNode=null,t.leftHonorIcon=null,t.rightHonorIcon=null,t.leftAdditionLabel=null,t.rightAdditionLabel=null,t.expProgressBar=null,t.expProgressLabel=null,t.missionTableView=null,t.starPrefab=null,t.upgradeNode=null,t.upgradeHonorIcon=null,t.shareButton=null,t.closeUpgradeButton=null,t.upgradeLight=null,t.maxLight=null,t.closeButton=null,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),r.default.register(s.EventMsg.MISSIONS_REFRESH,this,function(){var e=t._getReloadData();t.missionTableView.reload(e),t.refreshExp()}),r.default.register(s.EventMsg.HONOR_UPGRADE,this,function(){t.refreshHand(),t.showUpgradeNode()}),r.default.register(s.EventMsg.SHOW_UPGRADE,this,function(e){t.showUpgradeNode(Number(e.source))}),this.starPool=new u.pp.NodePoolExtend(0),this.starPool.create(this.starPrefab,10),this.upgradeNode.active=!1},t.prototype.start=function(){this.refreshHand();var e=this._getReloadData();this.missionTableView.initTableView(e.array.length,e),WxSDK.showBanner()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.missionTableView.clear(),a.default.saveTableData()},t.prototype.onShow=function(){this.closeButton.playNormal()},t.prototype.onClose=function(){cc.find("Canvas").getComponent(p.default).gameLayer.gameState===f.GameState.PREPARE&&WxSDK.hideBanner()},t.prototype._getReloadData=function(){return{array:a.default.getSortMissions().slice(),manager:this}},t.prototype.refreshHand=function(){var e=a.default.getCurHonorData(),t=a.default.getNexHonorData();t?(this.leftHonorIcon.show(e.id),this.rightHonorIcon.show(t.id),this.leftAdditionLabel.string=c.LanguageHandler.getLanguageData("\u5206\u6570")+" +"+e.addition+"%",this.rightAdditionLabel.string=c.LanguageHandler.getLanguageData("\u5206\u6570")+" +"+t.addition+"%",this.maxLight.active=!1):(console.log("\u6210\u529f\u767b\u9876"),this.arrowNode.active=!1,this.rightHonorIcon.node.active=!1,this.leftHonorIcon.show(e.id),this.leftAdditionLabel.node.active=!1,this.rightAdditionLabel.node.active=!1,this.expProgressBar.node.active=!1,this.leftHonorIcon.node.x=0,this.leftHonorIcon.node.y=185,this.maxLight.active=!0,this.maxLight.stopAllActions(),this.maxLight.runAction(cc.rotateBy(1,30).repeatForever())),this.refreshExp()},t.prototype.refreshExp=function(e){var t=a.default.getCurHonorData().needExp,o=e||a.default.honorExp;this.expProgressBar.progress=o/t,this.expProgressLabel.string=o+"/"+t},t.prototype.showUpgradeNode=function(e){var t=this;void 0===e&&(e=a.default.honorId),this.closeUpgradeButton.opacity=0,d.default.playSFX("upgrade"),this.window.active=!1,this.hideInputLayer(),this.upgradeNode.active=!0,this.upgradeLight.opacity=0,this.upgradeHonorIcon.show(e);var o=this.upgradeHonorIcon;o.node.scale=0;for(var n=0,i=0;i<o.starLayer.children.length;i++){var r=o.starLayer.children[i];r.active&&(n++,r.opacity=0)}o.nameLabel.node.opacity=0,this.shareButton.active=!1,o.node.runAction(cc.sequence(cc.scaleTo(.8,1).easing(cc.easeBackOut()),cc.callFunc(function(e){t.upgradeLight.stopAllActions(),t.upgradeLight.runAction(cc.sequence(cc.fadeIn(.5),cc.callFunc(function(e){e.runAction(cc.rotateBy(1,30).repeatForever())})));for(var i=function(e){var t=o.starLayer.children[e];o.node.runAction(cc.sequence(cc.delayTime(.2*e),cc.callFunc(function(e){t.opacity=255,t.scale=2,t.runAction(cc.scaleTo(.3,1))})))},a=0;a<n;a++)i(a)}),cc.delayTime(.5),cc.callFunc(function(e){o.nameLabel.node.runAction(cc.fadeIn(.5))}),cc.delayTime(.5),cc.callFunc(function(e){t.shareButton.active=!0,t.closeUpgradeButton.play()})))},t.prototype.closeUpgradeNode=function(){this.window.active=!0,this.upgradeNode.active=!1},t.prototype.buttonCallback=function(e,t){var o=this;switch(t){case"closeUpgrade":this.closeUpgradeNode();break;case"share":WxSDK.resultShare(),this.scheduleOnce(function(){o.closeUpgradeNode()},.2);break;case"close":this.close()}},__decorate([v(cc.Node)],t.prototype,"arrowNode",void 0),__decorate([v(l.default)],t.prototype,"leftHonorIcon",void 0),__decorate([v(l.default)],t.prototype,"rightHonorIcon",void 0),__decorate([v(cc.Label)],t.prototype,"leftAdditionLabel",void 0),__decorate([v(cc.Label)],t.prototype,"rightAdditionLabel",void 0),__decorate([v(cc.ProgressBar)],t.prototype,"expProgressBar",void 0),__decorate([v(cc.Label)],t.prototype,"expProgressLabel",void 0),__decorate([v(i)],t.prototype,"missionTableView",void 0),__decorate([v(cc.Prefab)],t.prototype,"starPrefab",void 0),__decorate([v(cc.Node)],t.prototype,"upgradeNode",void 0),__decorate([v(l.default)],t.prototype,"upgradeHonorIcon",void 0),__decorate([v(cc.Node)],t.prototype,"shareButton",void 0),__decorate([v(h.default)],t.prototype,"closeUpgradeButton",void 0),__decorate([v(cc.Node)],t.prototype,"upgradeLight",void 0),__decorate([v(cc.Node)],t.prototype,"maxLight",void 0),__decorate([v(h.default)],t.prototype,"closeButton",void 0),t=__decorate([g],t)}(n.default);o.default=m,cc._RF.pop()},{"../../common/Define":"Define","../../custom-complete/tableView/tableView":"tableView","../../data/HonorHandler":"HonorHandler","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/pp/PP":"PP","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/SoundUtils":"SoundUtils","../GameManager":"GameManager","../logic/GameLayer":"GameLayer","../unit/DelayShowButton":"DelayShowButton","../unit/HonorIcon":"HonorIcon"}],InsideAds2:[function(e,t,o){"use strict";cc._RF.push(t,"59d24cuyvZB/7uah6K2qVsO","InsideAds2");var n=e("sdk"),i=e("JNodePool");window.INSIDEADS_SHOW="insideAds_show",window.INSIDEADS_HIDE="insideAds_hide";var a=n.game_id+"insideAdsShowList",r=cc.Class({extends:cc.Component,properties:{mask:cc.Node,pnl:cc.Node,btn:cc.Node,arrow:cc.Node,layer:cc.Node,content:cc.Node,iconPrefab:cc.Prefab,popDuration:.3,_showList:[]},onLoad:function(){var e=this,t=this.node;n.ADS2=t,this.pool=new i(this.iconPrefab,5),this.node.zIndex=9999,this.pnl.active=!1,this.mask.active=!1,this.mask.opacity=0,this._list=[],this._status="hide",this.layer.active=!1;var o=cc.sys.localStorage.getItem(a);this._localList=o?JSON.parse(o):[],this._checkStatus(),this.btn.on("touchend",function(){"hide"==e._status?e._showMore():e._hideMore()},this),this.mask.on("touchstart",function(){e._hideMore()})},start:function(){var e=this;this._onDataChanged(),n.insideAds.onChanged=function(){e._onDataChanged()}},onDestroy:function(){cc.game.removePersistRootNode(this.node),n.ADS2=null,n.insideAds.onChanged=null},_onDataChanged:function(){n.insideAds.hasAds()||"undefined"==typeof wx?(this._list=n.insideAds.list,this.pnl.active=!0,this._updateContent()):(this._list=[],this.pnl.active=!1),this._checkRedShow()},_updateContent:function(){var e=this;Array.isArray(this._list)&&this._list.length>0&&(this.checkShowListDiff()&&(this._clearContent(),this._list.forEach(function(t,o){e.content.addChild(e._createIcon(t,o))}),this._showList=this._list.slice()))},checkShowListDiff:function(){if(this._list.length===this._showList.length){for(var e=0;e<this._list.length;++e){var t=this._list[e],o=this._showList[e];if(!(t.app_id.toString()+t.app_path.toString()===o.app_id.toString()+o.app_path.toString()))return!0}return!1}return!0},_clearContent:function(){for(var e=this.content.children,t=e.length-1;t>=0;--t){var o=e[t];this.pool.put(o)}},_createIcon:function(e,t){var o=this,i=this.pool.get(),r=i.getChildByName("icon").getComponent(cc.Sprite),s=i.getChildByName("label").getComponent(cc.Label),c=i.getChildByName("red");r.active=!1,i.runAction(cc.sequence(cc.delayTime(.1*t),cc.callFunc(function(t){o._loadAni(r,e.icon,r.node.width,r.node.height)}))),s.string=e.name.substr(0,5),i.targetOff(this),i.on("touchend",function(){var t=function(t){if(e.app_id&&void 0!==e.app_path){var n=e.app_id.toString()+e.app_path.toString();o._localList.indexOf(n)<0&&(o._localList.push(n),c.active=!1,cc.sys.localStorage.setItem(a,JSON.stringify(o._localList)),o._checkRedShow())}Server.reportClick(e.id,t)};1===e.qrcode_flag?n.showImage(e.qrcode_url,function(){t("get_list_scan")}):n.showInsideAds(e,function(){t("get_list")})},this);var l=e.app_id.toString()+e.app_path.toString();return c.active=this._localList.indexOf(l)<0,i},_loadImage:function(e,t,o,n){if(window.wx){var i=wx.createImage();i.onload=function(){var t=new cc.Texture2D;t.initWithElement(i),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t),e.node.width=o,e.node.height=n},i.src=t}},_loadAni:function(e,t,o,n){this.loadIamge(e,t).then(function(e){e.active=!0}).catch(function(e){})},_showMore:function(){var e=this;if("hide"===this._status){cc.systemEvent.emit(INSIDEADS_SHOW,this),this._status="none",this._checkStatus(),this.layer.active=!0;var t=this.pnl.x,o=-cc.winSize.width/2+540,n=this.popDuration;this._runAnimation(this.pnl,t,o,n,cc.easeSineOut(),function(){e._status="show"}),this.arrow.stopAllActions(),this.arrow.runAction(cc.rotateTo(n,180)),this.mask.active=!0,this.mask.runAction(cc.fadeTo(n,150))}},_hideMore:function(){var e=this;if("show"===this._status){cc.systemEvent.emit(INSIDEADS_HIDE,this),this._status="none";var t=this.pnl.x,o=-cc.winSize.width/2,n=this.popDuration;this._runAnimation(this.pnl,t,o,n,cc.easeSineIn(),function(){e.layer.active=!1,e._status="hide",e._checkStatus()}),this.arrow.stopAllActions(),this.arrow.runAction(cc.rotateTo(n,0)),this.mask.runAction(cc.sequence(cc.fadeTo(n,0),cc.callFunc(function(t){t.active=!1,e.layer.active=!1})))}},_runAnimation:function(e,t,o,n,i,a){e.stopAllActions(),e.x=t;var r=cc.moveTo(n,o,e.y);i&&r.easing(i),e.runAction(cc.sequence(r,cc.callFunc(function(){a&&a()})))},_checkStatus:function(){"hide"===this._status?(this.btn.stopAllActions(),this.btn.runAction(cc.sequence(cc.scaleTo(1,1.15),cc.scaleTo(1,1)).repeatForever()),this.btn.getChildByName("red1").active=this._checkAppIdListDifference()):(this.btn.stopAllActions(),this.btn.getChildByName("red1").active=!1)},_checkRedShow:function(){this.btn.getChildByName("red1").active=this._checkAppIdListDifference()&&"hide"===this._status},_checkAppIdListDifference:function(){var e=!0,t=!1,o=void 0;try{for(var n,i=this._list[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var a=n.value,r=a.app_id.toString()+a.app_path.toString();if(this._localList.indexOf(r)<0)return!0}}catch(e){t=!0,o=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw o}}return!1},loadIamge:function(e,t){return new Promise(function(o,n){var i=t+"?aaa=aa.png";cc.loader.load(i,function(t,i){if(t)return console.log("pngErr:",t),n();if(i){var a=e.getComponent(cc.Sprite);return a||(a=e.addComponent(cc.Sprite)),a.spriteFrame=new cc.SpriteFrame(i),o(e)}return n()})})},loadJsonAni:function(e,t){var o=this.getUrlWithoutAsp(t),n=o+".json";return new Promise(function(e,t){cc.loader.load(n,function(o,n){return o?t():n?e(n):t()})}).then(function(t){return new Promise(function(e,n){var i=o+".png";cc.loader.load(i,function(o,i){return o?n():i?e({json:t,png:i}):n()})}).then(function(t){var o=t.json,n=t.png,i=o.mc.gif.frames.map(function(e){var t=o.res[e.res];return new cc.SpriteFrame(n,cc.rect(t.x,t.y,t.w,t.h),!1,cc.v2(e.x,e.y),cc.size(t.w,t.h))}),a=void 0;a=e.getComponent(cc.Animation)?e.getComponent(cc.Animation):e.addComponent(cc.Animation),e.getComponent(cc.Sprite)||e.addComponent(cc.Sprite);var r=o.mc.gif.frameRate,s=cc.AnimationClip.createWithSpriteFrames(i,r);return s.name="ani_frame",s.wrapMode=cc.WrapMode.Loop,a.addClip(s),a.play("ani_frame"),e})},function(){return new Promise(function(e,o){cc.loader.load(t,function(n,i){return n?(console.log("pngErr1:",n),void cc.loader.load({url:t,type:"png"},function(t,n){return t?(console.log("pngErr2:",t),o()):n?e(n):o()})):i?e(i):o()})}).then(function(t){var o=e.getComponent(cc.Sprite);return o||(o=e.addComponent(cc.Sprite)),o.spriteFrame=new cc.SpriteFrame(t),e},function(){})})},getUrlWithoutAsp:function(e){var t=e.lastIndexOf(".");return t>=0?e.substring(0,t):e}});window.InsideAds2=t.exports=r,n.ADS2=null,n.setADS2=function(e){n.ADS2=e},n.createADS2=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cc.director.getScene();arguments[2],arguments[3];if(n.ADS2);else{var o=cc.instantiate(e);o.parent=t,n.ADS2=o}},n.showADS2=function(e,t){cc.log("show"),n.ADS2&&cc.isValid(n.ADS2)?(n.ADS2.active=!0,e&&e()):(console.log("ads2\u4e0d\u5b58\u5728"),n.ADS2=null,t&&t())},n.hideADS2=function(e,t){cc.log("hide"),n.ADS2&&cc.isValid(n.ADS2)?(n.ADS2.active=!1,e&&e()):(console.log("ads2\u4e0d\u5b58\u5728"),n.ADS2=null,t&&t())},n.destroyADS2=function(e,t){n.ADS2?(n.ADS2.destroy(),e&&e()):(console.log("ads2\u4e0d\u5b58\u5728"),t&&t()),n.ADS2=null},cc._RF.pop()},{JNodePool:"JNodePool",sdk:"sdk"}],JNodePool:[function(e,t,o){"use strict";cc._RF.push(t,"5737cUrOatAn7FxRg7M1FC8","JNodePool"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();var i=function(){function e(t,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.mPrefab=t,this.mNodePool=new cc.NodePool;for(var n=0;n<o;++n){var i=cc.instantiate(this.mPrefab);this.mNodePool.put(i)}}return n(e,[{key:"size",value:function(){return this.mNodePool.size()}},{key:"get",value:function(){return 0<this.mNodePool.size()?this.mNodePool.get():cc.instantiate(this.mPrefab)}},{key:"put",value:function(e){this.mNodePool.put(e)}}]),e}();o.default=i,t.exports=o.default,cc._RF.pop()},{}],LanguageController:[function(e,t,o){"use strict";cc._RF.push(t,"a7cdeWGgXlH56Ug3mT2NqXd","LanguageController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../data/LanguageHandler"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="",t.text="",t}return __extends(t,e),t.prototype.start=function(){if(this.key){var e=n.LanguageHandler.getLanguageData(this.key);this.text=e}var t=this.getComponent(cc.Label);t&&(t.string=this.text)},__decorate([r],t.prototype,"key",void 0),t=__decorate([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../data/LanguageHandler":"LanguageHandler"}],LanguageHandler:[function(e,t,o){"use strict";cc._RF.push(t,"74cbaNsJRpJ8rVkzvC/ZCDa","LanguageHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./DataHandler"),i=e("./SettingHandler"),a=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onInit=function(){this._configURLList=["language"]},t.prototype.onLoadConfig=function(e){this._languageConfig=e.language.config},t.prototype.getLanguageData=function(e,t){if(void 0===t&&(t=!1),!this._languageConfig[e])return e;var o=this._languageConfig[e][i.default.language];return""!==o&&null!==o?t?o.toUpperCase():o:e},t.prototype.getLanguageDataWithArgs=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=this.getLanguageData(e);return n=n.format.apply(n,t)},t}(n.default));o.LanguageHandler=a,cc._RF.pop()},{"./DataHandler":"DataHandler","./SettingHandler":"SettingHandler"}],LoaderUtils:[function(e,t,o){"use strict";cc._RF.push(t,"59c83ira6BJ1K5OGs7eDBqt","LoaderUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./FileUtils"),i=e("./EventCenter"),a=0,r=function(){function e(){}return e.startLoad=function(e){void 0===e&&(e="loadSubpackage"),a=0,this[e]()},e.loadSubpackage=function(){var e=this,t=this.loadProgress.loadSubPackage;function o(){e.initBasePercent(t),console.timeEnd("\u5206\u5305\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u5206\u5305\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadConfig()}if(a+=t,console.time("\u5206\u5305\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),"undefined"!=typeof wx&&void 0!==window.subPackages&&0!==window.subPackages.length)if("undefined"!=typeof wx&&void 0!==wx.loadSubpackage){var n=window.subPackages,i=0,r=t/n.length;(function t(){var a=n[i].name;console.log("load"+a+"start,loadIdx:",i),wx.loadSubpackage({name:a,success:function(e){console.log("load "+a+" Success:",e),i++,console.log("loadIdx:",i,"length:",n.length),i>=n.length?o():t()},fail:function(e){console.log("load "+a+" Fail",e)}}).onProgressUpdate(function(t){console.log(a+"\u4e0b\u8f7d\u8fdb\u5ea6",t.progress),e.initProgress(t.progress/100,(i+1)*r)})})()}else o();else o()},e.loadConfig=function(){var e=this,t=this.loadProgress.loadConfig;a+=t,console.time("config\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("config",function(o,n,i){e.initProgress(o/n,t)},function(o,i,r){if(o)cc.error(o);else{for(var s=[],c=0,l=i;c<l.length;c++){var u=l[c];if(u.constructor===cc.JsonAsset)s.push(u);else if(u.constructor===cc.TextAsset)u.text}for(var h=0,d=s;h<d.length;h++){var p=d[h];n.default.ResourcesData.Config[p.name]||(n.default.ResourcesData.Config[p.name]=p.json)}e.initBasePercent(t),console.timeEnd("config\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("config\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadImage()}})},e.loadImage=function(){var e=this,t=this.loadProgress.loadTexture;a+=t,console.time("\u56fe\u7247\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("image",cc.SpriteFrame,function(o,n,i){e.initProgress(o/n,t)},function(o,i){if(o)cc.error(o);else{for(var r=0,s=i;r<s.length;r++){var c=s[r];n.default.ResourcesData.Texture[c.name]=c}e.initBasePercent(t),console.timeEnd("\u56fe\u7247\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u56fe\u7247\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadSound()}})},e.loadSound=function(){var e=this,t=this.loadProgress.loadSound;a+=t,console.time("\u58f0\u97f3\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("sound",cc.AudioClip,function(o,n,i){e.initProgress(o/n,t)},function(o,i,r){if(o)cc.error(o);else{for(var s=0;s<i.length;s++){var c=n.default.getSimpleUrl(r[s]);n.default.ResourcesData.Sound[c]=i[s]}e.initBasePercent(t),console.timeEnd("\u58f0\u97f3\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u58f0\u97f3\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadPrefab()}})},e.loadPrefab=function(){var e=this,t=this.loadProgress.loadPrefab;a+=t,console.time("\u9884\u5236\u4ef6\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("prefab",cc.Prefab,function(o,n,i){e.initProgress(o/n,t)},function(o,i,r){if(o)cc.error(o);else{for(var s=0,c=i;s<c.length;s++){var l=c[s];n.default.ResourcesData.Prefab[l.name]=l}e.initBasePercent(t),console.timeEnd("\u9884\u5236\u4ef6\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u9884\u5236\u4ef6\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadComplete()}})},e.loadComplete=function(){this.beLoaded=!0,i.default.post("load_over")},e.initProgress=function(e,t){if(e!==1/0&&!Object.is(e,NaN)){var o=e*t;this.curPercent=Math.max(this.basePercent+o,this.curPercent),i.default.post("percent_change",Math.floor(this.curPercent))}},e.initBasePercent=function(e){this.basePercent+=e,i.default.post("percent_change",Math.floor(this.basePercent))},e.basePercent=0,e.curPercent=0,e.beLoaded=!1,e.loadProgress={loadSubPackage:0,loadConfig:0,loadTexture:0,loadSound:0,loadPrefab:0},e}();o.default=r,cc._RF.pop()},{"./EventCenter":"EventCenter","./FileUtils":"FileUtils"}],LoadingLayer:[function(e,t,o){"use strict";cc._RF.push(t,"d712cu68xZOFqbWWlLOchIF","LoadingLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/UnitBase"),i=e("../../submodule/utils/EventCenter"),a=e("../../submodule/utils/FileUtils"),r=e("../../submodule/utils/LoaderUtils"),s=e("../../common/Define"),c=e("../../sdk/module/wx-btn/UserInfoBtn"),l=e("../../submodule/data/DataHandler"),u=e("../../submodule/utils/SoundUtils"),h=e("../../data/ServerHandler"),d=cc._decorator,p=d.ccclass,f=d.property;r.default.loadProgress={loadSubPackage:50,loadConfig:10,loadTexture:10,loadSound:0,loadPrefab:35,getAuth:15,loadServer:20,loadScene:25};var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.versionLabel=null,t.progressBar=null,t.loadingLabel=null,t.startButton=null,t._isAction=!1,t._totalProgress=0,t._oldProgress=0,t}return __extends(t,e),t.prototype.onLoad=function(){for(var e in i.default.register("load_over",this,this.onLoadOver),i.default.register("percent_change",this,this.onPercentChange),i.default.register(s.EventMsg.GET_AUTHLIST_OVER,this,this.onGetAuthOver),a.default.resetResourceData(),r.default.loadProgress)this._totalProgress+=r.default.loadProgress[e];r.default.initBasePercent(0)},t.prototype.start=function(){this.versionLabel.string="v"+GAME_VERSION+".0",this.progressBar.progress=0,this.startButton.node.active=!1,console.log("needAuth:",WxSDK.needAuth),WxSDK.needAuth>-1&&this.startLoad()},t.prototype.startLoad=function(){var e=r.default.loadProgress.getAuth;r.default.initBasePercent(e),this.scheduleOnce(function(){r.default.startLoad()},.25)},t.prototype.onLoadOver=function(){this.reloadConfig(),this.onDataLoadOver(),this.loadServer()},t.prototype.reloadConfig=function(){for(var e=0,t=l.default.HandlerList;e<t.length;e++){t[e].loadConfig()}for(var o=0,n=l.default.HandlerList;o<n.length;o++){n[o].onLoadOver()}},t.prototype.onDataLoadOver=function(){for(var e=0,t=l.default.HandlerList;e<t.length;e++){t[e].onDataLoadOver()}},t.prototype.loadServer=function(){var e=this;(function t(){h.default.initServerData(function(){console.log("\u62c9\u53d6\u670d\u52a1\u5668\u6570\u636e\u6210\u529f"),r.default.initBasePercent(r.default.loadProgress.loadServer),e.onServerLoadOver(),e.preloadScene()},function(){e.showModal(function(e){e.confirm&&t()})})})()},t.prototype.onServerLoadOver=function(){for(var e=0,t=l.default.HandlerList;e<t.length;e++){t[e].onServerLoadOver()}},t.prototype.onPercentChange=function(e){var t=e.source;this._setPercent(t)},t.prototype._setPercent=function(e){var t=this,o=Math.round(e/this._totalProgress*100),n=.01*Math.abs(o-this._oldProgress);n=Math.max(.2,n);var a=this._oldProgress;this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.floatTo(n,a,o,function(e){t.progressBar&&(t.progressBar.progress=e/100),t._oldProgress=e,t.loadingLabel&&(t.loadingLabel.string=""+Math.floor(e)),i.default.post(s.EventMsg.ON_DOOR_PROGRESS_CHANGE,e/100)}),cc.callFunc(function(e){i.default.post(s.EventMsg.ON_DOOR_PROGRESS_CHANGE,o/100),o>=100&&t.scheduleOnce(function(e){t.onLoadEnd()},.5)})))},t.prototype.preloadScene=function(){u.default.initLocalSetting(),i.default.post(s.EventMsg.PRELOAD_SCENE)},t.prototype.onGetAuthOver=function(){this.startLoad()},t.prototype.onLoadEnd=function(){this.showStartButton(),this.loadingLabel&&(this.loadingLabel.active=!1)},t.prototype.showStartButton=function(){var e=this;0===WxSDK.needAuth?i.default.post(s.EventMsg.SHOW_GAME):(this.startButton.node.active=!0,this.startButton.node.runAction(cc.sequence(cc.scaleTo(.5,1.05),cc.scaleTo(.5,.95)).repeatForever()),this.startButton.successFunc=function(t){WxSDK.reportAppid(1),e.hideStartButton()},this.startButton.failFunc=function(t){e.hideStartButton()})},t.prototype.hideStartButton=function(){if(!this._isAction){this._isAction=!0;var e=this.startButton.getComponent(cc.Sprite).spriteFrame,t=new cc.Node;t.addComponent(cc.Sprite).spriteFrame=e,this.startButton.node.addChild(t),t.xy=cc.v2(),this.startButton.node.stopAllActions(),t.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,2),cc.fadeOut(.3)),cc.callFunc(function(e){e.removeSelf()}))),this.startButton.node.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.scaleTo(.3,1.2),cc.fadeOut(.3)),cc.callFunc(function(e){e.removeSelf(),i.default.post(s.EventMsg.SHOW_GAME)})))}},t.prototype.showModal=function(e,t,o){"undefined"!=typeof wx&&wx.showModal({title:"",content:"\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86\uff0c\u8bf7\u91cd\u8bd5!",showCancel:!1,cancelText:"\u53d6\u6d88",confirmText:"\u91cd\u8bd5",success:e,fail:t,complete:o})},__decorate([f(cc.Label)],t.prototype,"versionLabel",void 0),__decorate([f(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([f(cc.Label)],t.prototype,"loadingLabel",void 0),__decorate([f(c)],t.prototype,"startButton",void 0),t=__decorate([p],t)}(n.default);o.default=_,cc._RF.pop()},{"../../common/Define":"Define","../../data/ServerHandler":"ServerHandler","../../sdk/module/wx-btn/UserInfoBtn":"UserInfoBtn","../../submodule/component/UnitBase":"UnitBase","../../submodule/data/DataHandler":"DataHandler","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/FileUtils":"FileUtils","../../submodule/utils/LoaderUtils":"LoaderUtils","../../submodule/utils/SoundUtils":"SoundUtils"}],LoadingManager:[function(e,t,o){"use strict";cc._RF.push(t,"7466enOEc1B4aippmweVmTx","LoadingManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/utils/FileUtils"),i=e("../submodule/utils/LoaderUtils"),a=e("../submodule/utils/EventCenter"),r=e("../submodule/data/LanguageHandler"),s=e("./SceneBase"),c=e("../common/Common"),l=cc._decorator,u=l.ccclass,h=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.versionLabel=null,t.progressBar=null,t.loadingLabel=null,t._totalProgress=0,t}return __extends(t,e),t.prototype.onLoad=function(){for(var t in e.prototype.onLoad.call(this),a.default.register("load_over",this,this.onLoadOver),a.default.register("percent_change",this,this.onPercentChange),n.default.resetResourceData(),i.default.initBasePercent(0),i.default.loadProgress)this._totalProgress+=i.default.loadProgress[t]},t.prototype.start=function(){this.versionLabel.string="v"+GAME_VERSION+".0",this.progressBar.progress=0,i.default.startLoad()},t.prototype.onLoadOver=function(){this.reloadConfig(),this.preloadScene()},t.prototype.reloadConfig=function(){r.LanguageHandler.loadConfig()},t.prototype.onPercentChange=function(e){var t=e.source;this._setPercent(t)},t.prototype._setPercent=function(e){var t=Math.round(e/this._totalProgress*100);this.loadingLabel&&(this.loadingLabel.string="Loading..."+t+"%"),this.progressBar&&(this.progressBar.progress=t/100)},t.prototype.preloadScene=function(){var e=this;console.time("game \u573a\u666f\u9884\u52a0\u8f7d\u5b8c\u6210\uff0c\u8017\u65f6");var t=i.default.loadProgress.loadScene;cc.director.preloadScene("game",function(e,o){i.default.initProgress(e/o,t)},function(o){if(o)return console.log("err:",o),void e.showModal(function(t){t.confirm&&e.scheduleOnce(function(){e.preloadScene()},1.5)});console.timeEnd("game \u573a\u666f\u9884\u52a0\u8f7d\u5b8c\u6210\uff0c\u8017\u65f6"),i.default.initBasePercent(t),e.scheduleOnce(function(){c.Common.loadScene("game")},.5)})},t.prototype.showModal=function(e,t,o){"undefined"!=typeof wx&&wx.showModal({title:"\u52a0\u8f7d\u5931\u8d25",content:"\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86\uff0c\u8bf7\u91cd\u8bd5!",showCancel:!1,cancelText:"\u53d6\u6d88",confirmText:"\u91cd\u8bd5",success:e,fail:t,complete:o})},t.prototype.onGetAuthOver=function(){},__decorate([h(cc.Label)],t.prototype,"versionLabel",void 0),__decorate([h(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([h(cc.Label)],t.prototype,"loadingLabel",void 0),t=__decorate([u],t)}(s.default);o.default=d,cc._RF.pop()},{"../common/Common":"Common","../submodule/data/LanguageHandler":"LanguageHandler","../submodule/utils/EventCenter":"EventCenter","../submodule/utils/FileUtils":"FileUtils","../submodule/utils/LoaderUtils":"LoaderUtils","./SceneBase":"SceneBase"}],LoadingNodeBase:[function(e,t,o){"use strict";cc._RF.push(t,"083b5zvPyFOAIDH+URJcMJE","LoadingNodeBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadingPanel=null,t.loading=null,t.label=null,t.delayTime=0,t.str="Loading...",t}return __extends(t,e),t.prototype.showLoading=function(e,t){e=e||this.str,t=t||this.delayTime,this.node.active=!0,this.loading.active=!1,this.loadingPanel.active=!1;var o=this;function n(){o.loadingPanel.active=!0,o._showLoading(),o.label.string=e}t>0?(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(e){n()})))):n()},t.prototype.hideLoading=function(e){this.node.active&&(this.node.stopAllActions(),this.node.active=!1,e&&e())},t.prototype._showLoading=function(){this.loading.active=!0,this.loading.stopAllActions(),this.loading.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(e){e.degrees+=36})).repeatForever())},__decorate([a(cc.Node)],t.prototype,"loadingPanel",void 0),__decorate([a(cc.Node)],t.prototype,"loading",void 0),__decorate([a(cc.Label)],t.prototype,"label",void 0),__decorate([a],t.prototype,"delayTime",void 0),__decorate([a],t.prototype,"str",void 0),t=__decorate([i],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],PPNodePoolExtend:[function(e,t,o){"use strict";cc._RF.push(t,"f0f4dLjzpNAz4oSlm2/LzPA","PPNodePoolExtend"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./PP"),i=function(){function e(e,t){void 0===e&&(e=0),this.myPrefab=null,this.type=0,this.parent=null,this.component=t,this.type=e,this.myPool=0===e?new cc.NodePool(t):new n.pp.NodePool(t)}return e.prototype.create=function(e,t,o){var n;void 0===t&&(t=0),this.myPrefab=e;for(var i=0;i<t;i++)n=cc.instantiate(e),1===this.type&&o&&(n.parent=o,this.parent=o),this.myPool.put(n)},e.prototype.size=function(){return this.myPool.size()},e.prototype.get=function(){if(this.myPool.size()<=0){var e=cc.instantiate(this.myPrefab);return this.parent&&(e.parent=this.parent),e}return this.myPool.get()},e.prototype.getWithComponent=function(){return this.component?this.get().getComponent(this.component):null},e.prototype.put=function(e){this.myPool.put(e)},e.prototype.clear=function(){this.myPool.clear()},e}();o.default=i,cc._RF.pop()},{"./PP":"PP"}],PPNodePool:[function(e,t,o){"use strict";cc._RF.push(t,"6a284y2wfBPxomcPEV3G0Gq","PPNodePool"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){this.poolHandlerComp=null,this._pool=[],this.poolHandlerComp=e}return e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy();this._pool=[]},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){e.active=!1;var t=this.poolHandlerComp?e.getComponent(this.poolHandlerComp):null;t&&t.unuse&&t.unuse(),this._pool.push(e)}},e.prototype.get=function(){var e=this._pool.length-1;if(e<0)return null;var t=this._pool[e];this._pool.length=e;var o=this.poolHandlerComp?t.getComponent(this.poolHandlerComp):null;return o&&o.reuse&&o.reuse.apply(o,arguments),t.active=!0,t},e.createNodeByPool=function(e,t,o){var n;return e&&e.size()>0?n=e.get():(n=cc.instantiate(t)).parent=o,n},e}();o.default=n,cc._RF.pop()},{}],PPToggle:[function(e,t,o){"use strict";cc._RF.push(t,"7a4ecwWHzVE0pTK0pzzJyZh","PPToggle");var n=cc.Enum({SPRITE:0,LABEL:1}),i=cc.Class({extends:cc.Button,properties:{toggleType:{default:n.SPRITE,type:n},onSpriteFrame:cc.SpriteFrame,offSpriteFrame:cc.SpriteFrame,sprite:cc.Sprite,onText:"\u5f00",offText:"\u5173",label:cc.Label,isCheck:{default:!1,notify:function(e){this.checkEvent(e)}},turnCallbacks:{default:[],type:cc.Component.EventHandler,tooltip:"\u70b9\u51fb\u6309\u94ae\u6267\u884c\u4e8b\u4ef6"}},onLoad:function(){this.checkEvent(),this.node.on("touchend",this.onoff,this)},onDestroy:function(){this.node.off("touchend",this.onoff,this)},onoff:function(){this.isCheck=!this.isCheck,cc.Component.EventHandler.emitEvents(this.turnCallbacks,this)},checkEvent:function(e){this.toggleType===n.SPRITE&&this.sprite?this.sprite.spriteFrame=this.isCheck?this.onSpriteFrame:this.offSpriteFrame:this.toggleType===n.LABEL&&this.label&&(this.label.string=this.isCheck?this.onText:this.offText)}});window.PPToggle=i,cc._RF.pop()},{}],PP:[function(e,t,o){"use strict";cc._RF.push(t,"eaed6XX0bFLmYJiQ1nzUcFW","PP"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./PPNodePool"),i=e("./PPNodePoolExtend");(function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.default);e.NodePool=t;var o,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.default);e.NodePoolExtend=a,function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(o=e.DIR||(e.DIR={})),e.DIR_VEC2={UP:cc.v2(0,1),DOWN:cc.v2(0,-1),LEFT:cc.v2(-1,0),RIGHT:cc.v2(1,0)},e.getDitByIdx=function(e){return"number"==typeof e?this.DIR_VEC2[o[e]]:"string"==typeof e?this.DIR_VEC2[e]:void 0},e.getNodePos=function(e,t){var o=e.parent.convertToWorldSpaceAR(e.position);return t.convertToNodeSpaceAR(o)},e.getTargetPos=function(e,t,o){var n=t.convertToWorldSpaceAR(e);return o.convertToNodeSpaceAR(n)},e.setChildrenGreyState=function(e,t,o){(function e(n){var i=n.getComponent(cc.Sprite);i&&i.setState(t);var a=n.getComponent(cc.Label);a&&(a.node.color=o);var r=n.children;if(0!==r.length)for(var s=0,c=r;s<c.length;s++)e(c[s])})(e)},e.shallowCopy=function(e){var t={};for(var o in e)t[o]=e[o];return t},e.deepCopy=function(e){if("object"!=typeof e)return e;var t={};for(var o in e)t[o]=this.deepCopy(e[o]);return t},e.checkPropertiesList=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];for(var n=e,i=0,a=t;i<a.length;i++){var r=a[i];if(void 0===n[r])return null;n=n[r]}return n},e.getRandomStr=function(){return Math.random().toString(36).substr(2)},e.getChanceByRateTable=function(e){var t=0;for(var o in e)t+=e[o];var n=0,i=Math.getRandom(0,t);for(var o in e)if(i<(n+=e[o]))return o;return null},e.doNFunc=function(e,t){for(var o=0;o<e;o++)t(o)},e.formateNum=function(e){return(e=e).replace(/(?=(?!\b)(\d{3})+$)/g,",")},e.padding=function(e,t){return(Array(t).join("0")+e).slice(-t)},e.getIntervalDaysDir=function(e,t){var o=new Date(e).toDateString(),n=new Date(t).toDateString();return(new Date(o).getTime()-new Date(n).getTime())/864e5},e.getIntervalDays=function(e,t){return Math.abs(this.getIntervalDaysDir(e,t))},e.isSameDay=function(e,t){return 0===this.getIntervalDays(e,t)},e.getInterVal=function(e,t){return"string"==typeof e?e=new Date(e).getTime():e instanceof Date&&(e=e.getTime()),void 0===t?t=(new Date).getTime():"string"==typeof t?t=new Date(e).getTime():t instanceof Date&&(t=t.getTime()),Math.abs(e-t)},e.extendTwo=function(e,t){var o={};for(var n in e)o[n]=e[n];for(var n in t)o.hasOwnProperty(n)||(o[n]=t[n]);return o},e.assign=function(e,t){var o=e;for(var n in t)o.hasOwnProperty(n)||(o[n]=t[n]);return o}})(o.pp||(o.pp={})),cc._RF.pop()},{"./PPNodePool":"PPNodePool","./PPNodePoolExtend":"PPNodePoolExtend"}],PddCouponPanel:[function(e,t,o){"use strict";cc._RF.push(t,"9b8571QmdhOmYVc//LEme9e","PddCouponPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../../submodule/utils/EventCenter"),a=e("../../common/Common"),r=e("../unit/DelayShowButton"),s=e("../../data/GameHandler"),c=e("../../common/Define"),l=e("../GameManager"),u=e("../../submodule/pp/PP"),h=e("../../data/DateTimerHandler"),d=cc._decorator,p=d.ccclass,f=d.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeNode=null,t.openNode=null,t.numLabel=null,t.closeButton=null,t.infoLabel=null,t}return __extends(t,e),t.prototype.start=function(){this.infoLabel.string="<color=#B8651C><i>\u53ef\u83b7\u5f97 </i></c><color=#F31111><b><size=40>"+WxSDK.pdd_honor_addition+"\u70b9</size></b></c><color=#B8651C> <i>\u6210\u5c31\u70b9</i></c>";var e,t=3*(WxSDK.pdd_goods_change_time+1),o=pddSDK.getNumGoods(t);if(this._maxDiscount=pddSDK.getMaxDiscount(o),o.length>0){for(var n=0;n<o.length;n++){var a=o[n];if(a.coupon_discount/100===this._maxDiscount){e=a,o.splice(n,1);break}}o.unshift(e)}this._goodsList=o,console.log(o),s.default.hasCoupon=!0,i.default.post(c.EventMsg.SHOW_COUPON_BUTTON)},t.prototype.onShow=function(){this.closeButton.play()},t.prototype.openCoupon=function(e){e.target;var t=e.result;t.type===TermType.VIDEO?WxSDK.reportEvent(WxSDK.ReportMsg.OPEN_COUPON_VIDEO):t.type===TermType.SHARE&&WxSDK.reportEvent(WxSDK.ReportMsg.OPEN_COUPON_SHARE),s.default.hasCoupon=!1,i.default.post(c.EventMsg.SHOW_COUPON_BUTTON),this.closeNode.active=!1,this.openNode.active=!0,this.numLabel.string="<b><color=#CD080F>"+this._maxDiscount.toFixed(2)+"\u5143</color></b>",this.closeButton.node.active=!1,h.default.pddShowTime1++},t.prototype.useCoupon=function(){var e=this._goodsList;a.Common.popPanel({name:"panel/pddGoodsPanel",callback:function(t){t.init(e)}}),this.close()},t.prototype.buttonCallback=function(e,t){var o=this;switch(t){case"open":this.openCoupon(e);break;case"use":this.useCoupon();break;case"close":this.showInputLayer(),this.closeButton.node.active=!1;var n=cc.find("Canvas").getComponent(l.default).gameLayer.gameUI.couponButton,i=u.pp.getNodePos(n,this.node);this.window.runAction(cc.sequence(cc.spawn(cc.moveTo(.3,i),cc.scaleTo(.3,.1)),cc.callFunc(function(e){o.close()})))}},__decorate([f(cc.Node)],t.prototype,"closeNode",void 0),__decorate([f(cc.Node)],t.prototype,"openNode",void 0),__decorate([f(cc.RichText)],t.prototype,"numLabel",void 0),__decorate([f(r.default)],t.prototype,"closeButton",void 0),__decorate([f(cc.RichText)],t.prototype,"infoLabel",void 0),t=__decorate([p],t)}(n.default);o.default=_,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../data/DateTimerHandler":"DateTimerHandler","../../data/GameHandler":"GameHandler","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/pp/PP":"PP","../../submodule/utils/EventCenter":"EventCenter","../GameManager":"GameManager","../unit/DelayShowButton":"DelayShowButton"}],PddGoodsPanel:[function(e,t,o){"use strict";cc._RF.push(t,"25e3d+iNVZMBIVCmjmCdIEZ","PddGoodsPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../../common/Common"),a=e("../../data/HonorHandler"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cellLayout=null,t.changeButton=null,t.changeLabel=null,t.infoNode=null,t.infoSprite=null,t.couponLabel1=null,t.couponLabel2=null,t.couponPriceLabel=null,t.originPriceLabel=null,t.nameLabel=null,t.couponRemainLabel=null,t.soldLabel=null,t.scoreLabel=null,t.descLabel=null,t.useButton=null,t.useLabel=null,t._goodsList=[],t.app_path="",t.app_id="",t}return __extends(t,e),t.prototype.start=function(){this.infoNode.active=!1},t.prototype.init=function(e){var t=Math.floor(e.length/3);this._maxTime=t-1,this._changeTime=this._maxTime,this._goodsList=e,this._goodsList.length>0&&this.refreshCells()},t.prototype.refreshCells=function(){this._changeTime<0&&(this._changeTime=this._maxTime);for(var e=this._maxTime-this._changeTime,t=this._goodsList,o=function(o){var i=n.cellLayout.children[o],a=3*e+o;if(a>=t.length)i.active=!1;else{var r=t[a];i.active=!0;var s=i.getChildByName("sprite").getComponent(cc.Sprite),c=i.getChildByName("useButton").getChildByName("numLabel").getComponent(cc.Label),l=i.getChildByName("infoLabel").getComponent(cc.Label),u=i.getChildByName("originPriceLabel").getComponent(cc.Label),h=i.getChildByName("couponPriceLabel").getComponent(cc.Label),d=s.node.width,p=s.node.height;n.loadImage(s,r.goods_thumbnail_url,function(e){e.node.width=d,e.node.height=p}),l.string=r.goods_name,c.string=(r.coupon_discount/100).toFixed(2)+"\u5143",u.string="\u539f\u4ef7\uffe5"+(r.min_group_price/100).toFixed(2),h.string="\uffe5"+((r.min_group_price-r.coupon_discount)/100).toFixed(2);var f={sprite:s,goodsData:r};i.cellData=f}},n=this,i=0;i<3;i++)o(i);this.changeLabel.string="("+this._changeTime+"/"+this._maxTime+")"},t.prototype.loadImage=function(e,t,o,n){var i=wx.createImage();i.onload=function(){var t=new cc.Texture2D;t.initWithElement(i),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t),o&&o(e)},i.onerror=n,i.src=t},t.prototype.showInfo=function(e){var t=this;WxSDK.showLoading("\u52a0\u8f7d\u4e2d...");var o=e.goodsData.goods_id,n=WxSDK.pdd_pid;pddSDK.getGenerateUrl(o,n,function(o){WxSDK.reportEvent(WxSDK.ReportMsg.SHOW_COUPON_INFO),WxSDK.hideLoading(),t.infoNode.active=!0,t.window.active=!1;var n=o.goods_detail,i=null===n.coupon_remain_quantity?0:n.coupon_remain_quantity;t.infoSprite.spriteFrame=e.sprite.spriteFrame;var a=n.coupon_discount/100;i>0?(t.couponLabel1.node.active=!0,t.couponLabel1.string="\uffe5"+a,t.couponLabel2.string=n.coupon_discount/100+"\u5143 \u4f18\u60e0\u5238",t.useLabel.string="\u4f7f\u7528",t.useLabel.node.color=cc.color().fromHEX("#FFDFA1"),t.useButton.interactable=!0):(t.couponLabel1.node.active=!1,t.couponLabel2.string="\u6682\u65e0\u4f18\u60e0\u5238",t.useLabel.string="\u4f18\u60e0\u5238\u5df2\u62a2\u5b8c",t.useLabel.node.color=cc.color().fromHEX("#ffffff"),t.useButton.interactable=!1),t.couponPriceLabel.string="\uffe5"+(n.min_group_price-n.coupon_discount)/100,t.originPriceLabel.string="\u539f\u4ef7\uffe5"+n.min_group_price/100,t.nameLabel.string=n.goods_name,t.couponRemainLabel.string="\u5238\u5269\u4f59:"+i+"/"+(null===n.coupon_total_quantity?0:n.coupon_total_quantity),t.soldLabel.string="\u9500\u91cf:"+n.sold_quantity,t.scoreLabel.string="\u5546\u54c1\u8bc4\u5206:"+(null===n.goods_eval_score?0:n.goods_eval_score),t.descLabel.string=null===n.goods_desc?"\u6682\u65e0\u63cf\u8ff0":n.goods_desc,t.app_path=o.app_path,t.app_id=o.app_id},function(e){i.Common.toast("\u83b7\u53d6\u5546\u54c1\u8be6\u60c5\u5931\u8d25!"),WxSDK.hideLoading()})},t.prototype.onClose=function(){WxSDK.showBanner(),WxSDK.showFeedbackBtn(),a.default.addOtherExp(WxSDK.pdd_honor_addition)},t.prototype.quitInfo=function(){WxSDK.showBanner(),WxSDK.showFeedbackBtn(),this.infoNode.active=!1,this.window.active=!0},t.prototype.buttonCallback=function(e,t){var o=this;switch(t){case"close":this.close();break;case"info":WxSDK.hideBanner(),WxSDK.hideFeedbackBtn();var n=e.target.cellData;this.showInfo(n);break;case"change":this._changeTime--,this.refreshCells();break;case"use":pddSDK.toPddMiniApp(this.app_id,this.app_path,function(){o.quitInfo(),WxSDK.reportEvent(WxSDK.ReportMsg.TO_PDD_MINI_WX)});break;case"back":this.quitInfo()}},__decorate([c(cc.Node)],t.prototype,"cellLayout",void 0),__decorate([c(cc.Button)],t.prototype,"changeButton",void 0),__decorate([c(cc.Label)],t.prototype,"changeLabel",void 0),__decorate([c(cc.Node)],t.prototype,"infoNode",void 0),__decorate([c(cc.Sprite)],t.prototype,"infoSprite",void 0),__decorate([c(cc.Label)],t.prototype,"couponLabel1",void 0),__decorate([c(cc.Label)],t.prototype,"couponLabel2",void 0),__decorate([c(cc.Label)],t.prototype,"couponPriceLabel",void 0),__decorate([c(cc.Label)],t.prototype,"originPriceLabel",void 0),__decorate([c(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([c(cc.Label)],t.prototype,"couponRemainLabel",void 0),__decorate([c(cc.Label)],t.prototype,"soldLabel",void 0),__decorate([c(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([c(cc.Label)],t.prototype,"descLabel",void 0),__decorate([c(cc.Button)],t.prototype,"useButton",void 0),__decorate([c(cc.Label)],t.prototype,"useLabel",void 0),t=__decorate([s],t)}(n.default);o.default=l,cc._RF.pop()},{"../../common/Common":"Common","../../data/HonorHandler":"HonorHandler","../../submodule/component/PopLayerBase":"PopLayerBase"}],PopLayerBase:[function(e,t,o){"use strict";cc._RF.push(t,"77295k1UOlDRaqimJ4pTvQ/","PopLayerBase"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./UnitBase"),a=cc._decorator,r=a.ccclass,s=a.property;(function(e){e[e.NONE=0]="NONE",e[e.SCALE=1]="SCALE",e[e.DOWN=2]="DOWN",e[e.FADE=3]="FADE",e[e.ROTATE=4]="ROTATE",e[e.LEFT_RIGHT=5]="LEFT_RIGHT",e[e.SCALE_FADE=6]="SCALE_FADE",e[e.SLIDE_IN_RIGHT=7]="SLIDE_IN_RIGHT",e[e.SLIDE_IN_BOTTOM=8]="SLIDE_IN_BOTTOM",e[e.FLIP_HORIZONTAL=9]="FLIP_HORIZONTAL",e[e.FLIP_VERTICAL=10]="FLIP_VERTICAL",e[e.JELLY=11]="JELLY",e[e.SLIDE_IN_LEFT=12]="SLIDE_IN_LEFT",e[e.SLIDE_IN_TOP=13]="SLIDE_IN_TOP"})(n=o.PopType||(o.PopType={}));var c=[["_normalShow","_normalClose"],["_scaleShow","_scaleClose"],["_downShow","_downClose"],["_fadeShow","_fadeClose"],["_rotateShow","_rotateClose"],["_leftRightShow","_leftRightClose"],["_scaleFadeShow","_scaleFadeClose"],["_slideInRightShow","_slideInRightClose"],["_slideInBottomShow","_slideInBottomClose"],["_flipHorizontalShow","_flipHorizontalClose"],["_flipVerticalShow","_flipVerticalClose"],["_jellyShow","_fadeClose"],["_slideInLeftShow","_slideInLeftClose"],["_slideInTopShow","_slideInTopClose"]],l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.bgOpacity=200,t.zValue=10,t.window=null,t.popType=n.SCALE,t.showTime=.25,t.closeTime=.1,t.blockInput=!0,t.needCloseEventButtons=[],t._buttonEventMap=new Map,t._closeData=null,t.closeCallbacks=[],t._customCloseCallbacks=[],t._isShow=!1,t._isClose=!1,t._isShowOver=!1,t._isCloseOver=!1,t.needInputLayer=!0,t._inputLayer=null,t.touchBgClose=!1,t.needCleanAfterClose=!0,t._windowX=0,t._windowY=0,t._windowScale=0,t._windowOpacity=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.zIndex=this.zValue,this._windowX=this.window.x,this._windowY=this.window.y,this._windowScale=this.window.scale,this._windowOpacity=this.window.opacity,this.blockInput&&this._addBlockInput(),this.needInputLayer&&this._addInputLayer(),this.touchBgClose&&this._addTouchCloseEvent(),this._pushCloseEvent(),this.window.getComponent(cc.Widget)&&this.window.getComponent(cc.Widget).updateAlignment(),this.show()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this._inputLayer&&(this._inputLayer=null),this.touchBgClose&&this._removeTouchCloseEvent()},t.prototype.onEnable=function(){this.onListener()},t.prototype.onDisable=function(){this.offListener()},t.prototype.onListener=function(){this.window.on("position-changed",this.onPositionChange,this),this.window.on("scale-changed",this.onScaleChange,this),this.window.on("rotation-changed",this.onRotationChange,this),this.window.on("size-changed",this.onSizeChange,this)},t.prototype.offListener=function(){this.window.off("position-changed",this.onPositionChange,this),this.window.off("scale-changed",this.onScaleChange,this),this.window.off("rotation-changed",this.onRotationChange,this),this.window.off("size-changed",this.onSizeChange,this)},t.prototype.onPositionChange=function(e){},t.prototype.onScaleChange=function(e){},t.prototype.onRotationChange=function(e){},t.prototype.onSizeChange=function(e){},t.prototype.show=function(){this._isShow||this._isShowOver||(this._isShow=!0,this._isClose=!1,this._isShowOver=!1,this._isCloseOver=!1,this.node.active=!0,this.bg&&(this.bg.opacity=0,this.bg.runAction(cc.fadeTo(this.showTime,this.bgOpacity))),this.window?this[c[this.popType][0]]():this._showOver())},t.prototype._showOver=function(){this._isShow=!1,this._isShowOver=!0,this.onShow(),this._inputLayer&&(this._inputLayer.active=!1)},t.prototype.close=function(e,t){if(!this._isClose&&!this._isCloseOver){if(this._closeData=t,this._inputLayer&&(this._inputLayer.active=!0),this.bg&&this.bg.runAction(cc.fadeOut(this.closeTime)),this.window)this[c[this.popType][1]]();else this._closeOver();this._isClose=!0}},t.prototype._closeOver=function(){if(this._isClose=!1,this._isCloseOver=!0,this.onClose(),this._closeData){var e=this._buttonEventMap.get(this._closeData);cc.Component.EventHandler.emitEvents(e,this)}if(this.closeCallbacks.length>0&&cc.Component.EventHandler.emitEvents(this.closeCallbacks,this),this._customCloseCallbacks.length>0)for(var t=0,o=this._customCloseCallbacks;t<o.length;t++){var n=o[t];n.callback.call(n.target)}this._isShow=!1,this._isShowOver=!1,this.needCleanAfterClose?(this.node.removeFromParent(!0),this.node.destroy()):this.node.active=!1},t.prototype.setCustomCloseCallback=function(e,t){this._customCloseCallbacks.push({callback:e,target:t})},t.prototype.onClose=function(){},t.prototype.onShow=function(){},t.prototype.showInputLayer=function(){this._inputLayer?this._inputLayer.active=!0:this._addInputLayer()},t.prototype.hideInputLayer=function(){this._inputLayer&&(this._inputLayer.active=!1)},t.prototype._addBlockInput=function(){this.getComponent(cc.BlockInputEvents)||this.addComponent(cc.BlockInputEvents)},t.prototype._addInputLayer=function(){var e=new cc.Node("input");e.position=cc.v2(0,0),e.width=this.node.width,e.height=this.node.height,e.addComponent(cc.BlockInputEvents),this.node.addChild(e,100),this._inputLayer=e},t.prototype._pushCloseEvent=function(){for(var e=0,t=0,o=this.needCloseEventButtons;t<o.length;t++){var n=o[t],i=new cc.Component.EventHandler;i.target=this.node,i.component="PopLayerBase",i.handler="close",i.customEventData="close"+e,this._buttonEventMap.set(i.customEventData,n.clickEvents.slice()),n.clickEvents=[],n.clickEvents.push(i),e++}},t.prototype._addTouchCloseEvent=function(){this.bg&&this.bg.on("touchend",this.close,this),this.window&&this.window.on("touchend",function(){})},t.prototype._removeTouchCloseEvent=function(){this.bg&&this.bg.off("touchend",this.close,this),this.window&&this.window.off("touchend")},t.prototype._normalShow=function(){this._showOver()},t.prototype._normalClose=function(){this._closeOver()},t.prototype._scaleShow=function(){var e=this;this.window.scale=0,this.window.opacity=this._windowOpacity;var t=this.showTime;this.window.runAction(cc.sequence(cc.scaleTo(t,1).easing(cc.easeElasticOut(.6)),cc.callFunc(function(t){e.window.scale=1,e._showOver()})))},t.prototype._scaleClose=function(){var e=this,t=this.closeTime;this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(t,0).easing(cc.easeElasticIn(.6)),cc.fadeOut(this.closeTime)),cc.callFunc(function(t){e.window.scale=0,e._closeOver()})))},t.prototype._downShow=function(){var e=this,t=this.showTime;this.window.y=this.node.height/2+this.window.height/2+50,this.window.runAction(cc.sequence(cc.moveTo(t,0,this._windowY).easing(cc.easeElasticOut(.8)),cc.callFunc(function(t){e.window.y=e._windowY,e._showOver()})))},t.prototype._downClose=function(){var e=this,t=this.node.height/2+this.window.height/2+50;this.window.runAction(cc.sequence(cc.moveTo(this.closeTime,0,t).easing(cc.easeElasticIn(.8)),cc.callFunc(function(o){e.window.y=t,e._closeOver()})))},t.prototype._fadeShow=function(){var e=this,t=this.showTime;this.window.opacity=0,this.window.runAction(cc.sequence(cc.fadeIn(t),cc.callFunc(function(t){e.window.opacity=255,e._showOver()})))},t.prototype._fadeClose=function(){var e=this;this.window.runAction(cc.sequence(cc.fadeOut(this.closeTime),cc.callFunc(function(t){e.window.opacity=0,e._closeOver()})))},t.prototype._rotateShow=function(){var e=this,t=this.window.height,o=-this.node.height/2,n=-(this._windowY-t/2-o)/t;this.window.anchorY=n,this.window.y=o,this.window.degrees=-145,this.window.runAction(cc.sequence(cc.rotateTo(this.showTime,0),cc.callFunc(function(t){e.window.degrees=0,e._showOver()})))},t.prototype._rotateClose=function(){var e=this;this.window.runAction(cc.sequence(cc.rotateTo(this.closeTime,145),cc.callFunc(function(t){e.window.degrees=145,e._closeOver()})))},t.prototype._leftRightShow=function(){var e=this,t=-this.node.width/2-this.window.width/2-50;this.window.x=t,this.window.runAction(cc.sequence(cc.moveTo(this.showTime,this._windowX,this._windowY).easing(cc.easeElasticOut(.8)),cc.callFunc(function(t){e.window.x=e._windowX,e._showOver()})))},t.prototype._leftRightClose=function(){var e=this,t=this.node.width/2+this.window.width/2+50;this.window.runAction(cc.sequence(cc.moveTo(this.closeTime,t,this._windowY).easing(cc.easeElasticIn(.8)),cc.callFunc(function(o){e.window.x=t,e._closeOver()})))},t.prototype._scaleFadeShow=function(){var e=this;this.window.opacity=0,this.window.scale=5,this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(this.showTime,1),cc.fadeIn(this.showTime)),cc.callFunc(function(t){e.window.scale=1,e.window.opacity=255,e._showOver()})))},t.prototype._scaleFadeClose=function(){var e=this;this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(this.closeTime,5),cc.fadeOut(this.closeTime)),cc.callFunc(function(t){e.window.scale=5,e.window.opacity=0,e._closeOver()})))},t.prototype._slideShow=function(e){var t=this;this.window.opacity=0,this.window.x=this._windowX+50*e.x,this.window.y=this._windowY+50*e.y,this.window.runAction(cc.sequence(cc.spawn(cc.moveTo(this.showTime,this._windowX,this._windowY),cc.fadeIn(this.showTime-.1)),cc.callFunc(function(e){t.window.x=t._windowX,t.window.opacity=255,t._showOver()})))},t.prototype._slideClose=function(e){var t=this;this.window.runAction(cc.sequence(cc.spawn(cc.moveTo(this.closeTime,this._windowX+50*e.x,this._windowY+50*e.y),cc.fadeOut(this.closeTime-.1)),cc.callFunc(function(e){t.window.opacity=0,t._closeOver()})))},t.prototype._slideInRightShow=function(){this._slideShow(cc.v2(1,0))},t.prototype._slideInRightClose=function(){this._slideClose(cc.v2(1,0))},t.prototype._slideInBottomShow=function(){this._slideShow(cc.v2(0,-1))},t.prototype._slideInBottomClose=function(){this._slideClose(cc.v2(0,-1))},t.prototype._slideInLeftShow=function(){this._slideShow(cc.v2(-1,0))},t.prototype._slideInLeftClose=function(){this._slideClose(cc.v2(-1,0))},t.prototype._slideInTopShow=function(){this._slideShow(cc.v2(0,1))},t.prototype._slideInTopClose=function(){this._slideClose(cc.v2(0,1))},t.prototype._flipHorizontalShow=function(){var e=this;this.window.opacity=0,this.window.scaleY=0,this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(this.showTime,1,1),cc.fadeIn(this.showTime)),cc.callFunc(function(t){e.window.scaleY=1,e.window.opacity=255,e._showOver()})))},t.prototype._flipHorizontalClose=function(){var e=this;this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(this.closeTime,1,0),cc.fadeOut(this.closeTime)),cc.callFunc(function(t){e.window.opacity=0,e.window.scaleY=0,e._closeOver()})))},t.prototype._flipVerticalShow=function(){var e=this;this.window.opacity=0,this.window.scaleX=0,this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(this.showTime,1,1),cc.fadeIn(this.showTime-.1)),cc.callFunc(function(t){e.window.scaleX=1,e.window.opacity=255,e._showOver()})))},t.prototype._flipVerticalClose=function(){var e=this;this.window.runAction(cc.sequence(cc.spawn(cc.scaleTo(this.closeTime,0,1),cc.fadeOut(this.closeTime-.1)),cc.callFunc(function(t){e.window.opacity=0,e.window.scaleX=0,e._closeOver()})))},t.prototype._jellyShow=function(){var e=this,t=this.showTime-.5;t=t<.1?.1:t,this.window.scaleX=this.window.scaleY=0,this.window.runAction(cc.sequence(cc.scaleTo(t,1),cc.scaleTo(.1,1.05,.95),cc.scaleTo(.1,.95,1.05),cc.scaleTo(.11,1.02,.98),cc.scaleTo(.11,.98,1.02),cc.scaleTo(.12,1),cc.callFunc(function(t){t.scaleX=t.scaleY=1,e._showOver()})))},__decorate([s({type:cc.Node,tooltip:"\u5f39\u7a97\u80cc\u666f"})],t.prototype,"bg",void 0),__decorate([s({tooltip:"\u80cc\u666f\u900f\u660e\u5ea6"})],t.prototype,"bgOpacity",void 0),__decorate([s],t.prototype,"zValue",void 0),__decorate([s({type:cc.Node,tooltip:"\u5f39\u7a97\u7a97\u4f53"})],t.prototype,"window",void 0),__decorate([s({type:cc.Enum(n),tooltip:"\u5f39\u7a97\u7c7b\u578b"})],t.prototype,"popType",void 0),__decorate([s({tooltip:"\u5f39\u51fa\u65f6\u95f4"})],t.prototype,"showTime",void 0),__decorate([s({tooltip:"\u5173\u95ed\u65f6\u95f4"})],t.prototype,"closeTime",void 0),__decorate([s({tooltip:"\u662f\u5426\u541e\u566c\u4e0b\u5c42\u4e8b\u4ef6"})],t.prototype,"blockInput",void 0),__decorate([s({type:[cc.Button],tooltip:"\u94ae\u5217\u8868\uff0c\u52a0\u5165\u5217\u8868\u7684\u6309\u94ae\u5728\u70b9\u51fb\u540e\u4f1a\u81ea\u52a8\u5173\u95ed,\u5e76\u5728\u6267\u884c\u5b8c\u5173\u95ed\u52a8\u753b\u540e\u6267\u884c\u6309\u94ae\u5173\u8054\u7684\u4e8b\u4ef6"})],t.prototype,"needCloseEventButtons",void 0),__decorate([s({type:[cc.Component.EventHandler],tooltip:"\u5f39\u7a97\u5173\u95ed\u540e\u6267\u884c\u7684\u4e8b\u4ef6\u5217\u8868"})],t.prototype,"closeCallbacks",void 0),__decorate([s({tooltip:"\u662f\u5426\u542f\u7528\u9876\u5c42\u906e\u7f69"})],t.prototype,"needInputLayer",void 0),__decorate([s({tooltip:"\u70b9\u51fb\u80cc\u666f\u5173\u95ed\u7a97\u53e3\u6a21\u5f0f"})],t.prototype,"touchBgClose",void 0),__decorate([s({tooltip:"\u662f\u5426\u9700\u8981\u518d\u5173\u95ed\u540e\u5f7b\u5e95\u79fb\u9664"})],t.prototype,"needCleanAfterClose",void 0),t=__decorate([r],t)}(i.default);o.default=l,cc._RF.pop()},{"./UnitBase":"UnitBase"}],PropGetPanel:[function(e,t,o){"use strict";cc._RF.push(t,"3662cL8EeVB6YK+tHRF5CdR","PropGetPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../unit/RewardButton"),i=e("../../submodule/component/PopLayerBase"),a=e("../../common/Define"),r=e("../../submodule/data/LanguageHandler"),s=e("../../data/GameHandler"),c=e("../../submodule/utils/EventCenter"),l=e("../../common/Common"),u=e("../unit/DelayShowButton"),h=cc._decorator,d=h.ccclass,p=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipsLabel=null,t.rewardButton=null,t.closeButton=null,t.rewardGeted=!1,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.init=function(e){this.closeButton.play(),this._type=e,e===a.Define.PROP_TYPE.CHANGE&&s.default.propChangeFree?(console.log("\u9996\u6b21\u6362\u4e00\u6362\u514d\u8d39\uff01"),this.rewardButton.turn({result:!0,type:TermType.FREE})):e===a.Define.PROP_TYPE.CRASH&&s.default.propCrashFree?(console.log("\u9996\u6b21\u9524\u5b50\u514d\u8d39"),this.rewardButton.turn({result:!0,type:TermType.FREE})):this.rewardButton.refreshResult();var t=this.rewardButton.result.type,o=r.LanguageHandler.getLanguageData(t===TermType.VIDEO?"video_reward":"share_reward");e===a.Define.PROP_TYPE.CHANGE?this.tipsLabel.string=r.LanguageHandler.getLanguageDataWithArgs("prop_change_tip",o,WxSDK.prop_change_count):e===a.Define.PROP_TYPE.CRASH&&(this.tipsLabel.string=r.LanguageHandler.getLanguageDataWithArgs("prop_crash_tip",o,WxSDK.prop_crash_count)),this.rewardGeted=!1},t.prototype.start=function(){},t.prototype.getReward=function(e){this._type===a.Define.PROP_TYPE.CHANGE?(s.default.propChangeCount=WxSDK.prop_change_count,l.Common.toastCode("prop_change_get",WxSDK.prop_change_count),c.default.post(a.EventMsg.PROP_CHANGE_CHANGE),s.default.propChangeFree&&(s.default.propChangeFree=!1)):this._type===a.Define.PROP_TYPE.CRASH&&(s.default.propCrashCount=WxSDK.prop_crash_count,l.Common.toastCode("prop_crash_get",WxSDK.prop_crash_count),c.default.post(a.EventMsg.PROP_CRASH_CHANGE),s.default.propCrashFree&&(s.default.propCrashFree=!1)),this.rewardGeted=!0,this.close()},t.prototype.onShow=function(){},t.prototype.onClose=function(){c.default.post(a.EventMsg.PROP_REWARD_GETED,this.rewardGeted)},t.prototype.buttonCallback=function(e,t){switch(t){case"reward":this.getReward(e);break;case"close":this.close()}},__decorate([p(cc.Label)],t.prototype,"tipsLabel",void 0),__decorate([p(n.default)],t.prototype,"rewardButton",void 0),__decorate([p(u.default)],t.prototype,"closeButton",void 0),t=__decorate([d],t)}(i.default);o.default=f,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../data/GameHandler":"GameHandler","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/utils/EventCenter":"EventCenter","../unit/DelayShowButton":"DelayShowButton","../unit/RewardButton":"RewardButton"}],PropNode:[function(e,t,o){"use strict";cc._RF.push(t,"9d5b5SO3pxOHrdyEfBYm9EH","PropNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/utils/EventCenter"),i=e("../../common/Define"),a=e("../../submodule/utils/ClassModule"),r=e("../../common/Common"),s=e("../../submodule/component/UnitBase"),c=e("../logic/GameLayer"),l=e("../panel/GuideLayer"),u=e("../../data/GameHandler"),h=cc._decorator,d=h.ccclass,p=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteTg=new a.SpriteToggle,t.targetBlock=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(e){switch(this._type=e,e){case i.Define.PROP_TYPE.FLASH:this.spriteTg.turn(0);break;case i.Define.PROP_TYPE.BOOM:this.spriteTg.turn(1)}},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.node.on("touchend",this._touchEnd,this)},t.prototype.onDestroy=function(){this.node.off("touchend",this._touchEnd,this)},t.prototype.remove=function(){var e=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0).easing(cc.easeBackIn()),cc.callFunc(function(t){e.node.removeSelf()})))},t.prototype._touchEnd=function(){var e=this;if(3===l.default.GuideIdx&&(l.default.GuideIdx=0,u.default.doGuide2=!1,n.default.post(i.EventMsg.REMOVE_GUIDE_LAYER)),this.targetBlock){if(this.manager.gameState!==c.GameState.GAME)return;r.Common.popPanel({name:"panel/propUsePanel",callback:function(t){t.init(e,e.spriteTg.sprite.spriteFrame)}})}},__decorate([p(a.SpriteToggle)],t.prototype,"spriteTg",void 0),t=__decorate([d],t)}(s.default);o.default=f,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../data/GameHandler":"GameHandler","../../submodule/component/UnitBase":"UnitBase","../../submodule/utils/ClassModule":"ClassModule","../../submodule/utils/EventCenter":"EventCenter","../logic/GameLayer":"GameLayer","../panel/GuideLayer":"GuideLayer"}],PropUsePanel:[function(e,t,o){"use strict";cc._RF.push(t,"75233QQ8CNBIIRzO7jeZlCI","PropUsePanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../unit/RewardButton"),i=e("../../submodule/component/PopLayerBase"),a=e("../../common/Define"),r=e("../../submodule/data/LanguageHandler"),s=e("../../data/GameHandler"),c=e("../../submodule/utils/EventCenter"),l=e("../unit/DelayShowButton"),u=cc._decorator,h=u.ccclass,d=u.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteTg=null,t.tipLabel=null,t.rewardButton=null,t.closeButton=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.init=function(e,t){this.closeButton.play(),this._prop=e,s.default.propSpecialFree?(console.log("\u9996\u6b21\u7279\u6b8a\u9053\u5177\u514d\u8d39"),this.rewardButton.turn({result:!0,type:TermType.FREE})):this.rewardButton.refreshResult();var o,n=this.spriteTg.width,i=this.spriteTg.height;this.spriteTg.spriteFrame=t,this.spriteTg.uniformScale(n,i),e.type===a.Define.PROP_TYPE.BOOM?o="prop_boom_tip":e.type===a.Define.PROP_TYPE.FLASH&&(o="prop_flash_tip"),this.tipLabel.string=r.LanguageHandler.getLanguageData(o)},t.prototype.start=function(){},t.prototype.getReward=function(e){var t=this;s.default.propSpecialFree&&(s.default.propSpecialFree=!1),this.setCustomCloseCallback(function(){c.default.post(a.EventMsg.TRIGGER_SPECIAL_PROP,t._prop)}),this.close()},t.prototype.onShow=function(){},t.prototype.onClose=function(){},t.prototype.buttonCallback=function(e,t){switch(t){case"reward":this.getReward(e);break;case"close":this.close()}},__decorate([d(cc.Sprite)],t.prototype,"spriteTg",void 0),__decorate([d(cc.Label)],t.prototype,"tipLabel",void 0),__decorate([d(n.default)],t.prototype,"rewardButton",void 0),__decorate([d(l.default)],t.prototype,"closeButton",void 0),t=__decorate([h],t)}(i.default);o.default=p,cc._RF.pop()},{"../../common/Define":"Define","../../data/GameHandler":"GameHandler","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/utils/EventCenter":"EventCenter","../unit/DelayShowButton":"DelayShowButton","../unit/RewardButton":"RewardButton"}],RankCell:[function(e,t,o){"use strict";cc._RF.push(t,"7ae142B+f1Ow4noiCbPQO94","RankCell"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/utils/ClassModule"),i=cc._decorator,a=i.ccclass,r=i.property,s=e("../../custom-complete/tableView/viewCell"),c=e("../unit/HonorIcon"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankLabel=null,t.avatarImageSprite=null,t.nickLabel=null,t.scoreLabel=null,t.kuangTg=null,t.rankTg=null,t.defaultAvatar=null,t.honorIdLabel=null,t.honorIcon=null,t}return __extends(t,e),t.prototype.init=function(e,t,o,n){var i=t.array[e],a=i.rank,r=i.avatar,s=i.name,c=i.score,l=i.ext;if(this.node.zIndex=a,a<=3){this.rankLabel.node.active=!1,this.rankTg.node.active=!0,this.kuangTg.node.active=!0;var u=a-1;this.rankTg.turn(u),this.kuangTg.turn(u)}else this.rankLabel.node.active=!0,this.rankTg.node.active=!1,this.kuangTg.node.active=!1,this.rankLabel.string=a+"";this.nickLabel.string=s,this.scoreLabel.string=c+"",WxSDK.loadImage(this.avatarImageSprite,r),"undefined"===l&&(l="1"),this.honorIcon.show(parseInt(l)),this.honorIdLabel.spriteFrame=this.honorIcon.nameLabel.spriteFrame},t.prototype.getLockNick=function(e,t){return void 0===t&&(t=12),String.GetStrLength(e)>t?(e=String.GetLengthStr(e,0,t))+"..":e},t.prototype.clicked=function(){},__decorate([r(cc.Label)],t.prototype,"rankLabel",void 0),__decorate([r(cc.Sprite)],t.prototype,"avatarImageSprite",void 0),__decorate([r(cc.Label)],t.prototype,"nickLabel",void 0),__decorate([r(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([r(n.SpriteToggle)],t.prototype,"kuangTg",void 0),__decorate([r(n.SpriteToggle)],t.prototype,"rankTg",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"defaultAvatar",void 0),__decorate([r(cc.Sprite)],t.prototype,"honorIdLabel",void 0),__decorate([r(c.default)],t.prototype,"honorIcon",void 0),t=__decorate([a],t)}(s);o.default=l,cc._RF.pop()},{"../../custom-complete/tableView/viewCell":"viewCell","../../submodule/utils/ClassModule":"ClassModule","../unit/HonorIcon":"HonorIcon"}],RankPanel:[function(e,t,o){"use strict";cc._RF.push(t,"6228c9rIKpHg6iTFHiA9xOq","RankPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../submodule/component/PopLayerBase"),a=e("../unit/DelayShowButton"),r=e("../../submodule/utils/EventCenter"),s=e("../../common/Define"),c=e("../../common/Common"),l=e("../../common/SubViewController"),u=e("../../custom-complete/tableView/tableView"),h=e("../../sdk/module/wx-btn/UserInfoBtn"),d=e("./RankCell"),p=e("../../submodule/data/LanguageHandler"),f=e("../../data/GameHandler"),_=e("../../data/HonorHandler"),g=cc._decorator,v=g.ccclass,m=g.property;(function(e){e[e.FRIEND=0]="FRIEND",e[e.WORLD=1]="WORLD",e[e.GROUP=2]="GROUP"})(n||(n={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showView=null,t.worldView=null,t.worldTableView=null,t.worldButton=null,t.userCell=null,t.toggleList=[],t.lightNode=null,t.closeButton=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.addWorldRankCallback()},t.prototype.onShow=function(){this.worldButton.showWxBtn(),"undefined"!=typeof wx&&this.showView.getComponent(cc.WXSubContextView).updateSubContextViewport(),this.closeButton.playNormal()},t.prototype.onClose=function(){r.default.post(s.EventMsg.RANK_VIEW_CLOSE)},t.prototype.init=function(e,t){e===SubViewType.FRIEND_RANK?this.showFriend(e):e===SubViewType.GROUP_RANK?this.showGroup(e,t):this.showWorld(e)},t.prototype.addWorldRankCallback=function(){var e=this,t=this.worldButton;t&&(t.successFunc=function(t){WxSDK.showLoading(p.LanguageHandler.getLanguageData("loading"));var o=f.default.bestScore;Server.submitLeaderboard({score:o,ext:_.default.honorId+""},function(t){e.getLeaderboard()},function(e){c.Common.toastCode("submit_rank_fail"),WxSDK.hideLoading()})},t.failFunc=function(e){c.Common.toastCode("rank_user_warn")}),"undefined"==typeof wx&&t.setNormalMode(function(){e.showWorld()})},t.prototype.showFriend=function(e){this._showType=n.FRIEND,this.showView.active=!0,this.worldView.active=!1,this._toggleCallback(this._showType),this.showView.show({type:e})},t.prototype.showGroup=function(e,t){this._showType=n.GROUP,this.showView.active=!0,this.worldView.active=!1,this._toggleCallback(this._showType),this.showView.show({type:e,shareTicket:t})},t.prototype.showWorld=function(e){"undefined"==typeof wx&&(e={mine:{rank:9999,name:"pipi12\u76ae\u7237666",avatar:null,score:"999999999999999999999",ext:"1"},list:[{rank:1,name:"aa",avatar:null,score:8979797979798e4,ext:"2"},{rank:2,name:"aaas",avatar:null,score:1436145616113,ext:"3"},{rank:3,name:"1211",avatar:null,score:797895555477557,ext:"11"},{rank:4,name:"sadfasd",avatar:null,score:131231313131,ext:"8"},{rank:5,name:"cccxvx",avatar:null,score:51163611313131,ext:"6"},{rank:6,name:"dfdeeee",avatar:null,score:9995959595312,ext:"12"}]}),this.showView.active=!1,this.worldView.active=!0,this._showType=n.WORLD,this._toggleCallback(this._showType),this.refreshList(e.mine,e.list)},t.prototype.refreshList=function(e,t){this._clearWorldView(),this._refreshUserCell(e),this.worldTableView.initTableView(t.length,{array:t})},t.prototype._clearWorldView=function(){this.worldTableView.clear(),this.userCell.node.active=!1},t.prototype._refreshUserCell=function(e){this.userCell.node.active=!0,this.userCell.init(0,{array:[e]})},t.prototype.getLeaderboard=function(){var e=this;Server.getLeaderboard(function(t){if(!(t&&t.data&&t.data.data&&Array.isArray(t.data.data.list)))return console.log("\u4e16\u754c\u6392\u884c\u699c\u6570\u636e\u4e0d\u6b63\u786e: ",t),c.Common.toastCode("get_rank_fail"),void WxSDK.hideLoading();e.showWorld(t.data.data),e.worldButton.setNormalMode(function(){e.showWorld(t.data.data)}),WxSDK.hideLoading()},function(e){c.Common.toastCode("get_rank_fail"),WxSDK.hideLoading()})},t.prototype.buttonCallback=function(e,t){var o=this;switch(t){case"group":c.Common.delayToast("group_rank_tip",.5);var i={type:SubViewType.GROUP_SHARE_RANK,callback:function(){o.showView.active=!0,o.worldView.active=!1,o._showType=n.GROUP,o._toggleCallback(o._showType)}};this.showView.show(i);break;case"friend":this.showFriend(SubViewType.FRIEND_RANK);break;case"close":this.close()}},t.prototype._toggleCallback=function(e){this.lightNode.parent=this.toggleList[e],this.lightNode.xy=cc.v2(3,3)},__decorate([m(l.default)],t.prototype,"showView",void 0),__decorate([m(cc.Node)],t.prototype,"worldView",void 0),__decorate([m(u)],t.prototype,"worldTableView",void 0),__decorate([m(h)],t.prototype,"worldButton",void 0),__decorate([m(d.default)],t.prototype,"userCell",void 0),__decorate([m([cc.Node])],t.prototype,"toggleList",void 0),__decorate([m(cc.Node)],t.prototype,"lightNode",void 0),__decorate([m(a.default)],t.prototype,"closeButton",void 0),t=__decorate([v],t)}(i.default);o.default=y,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../common/SubViewController":"SubViewController","../../custom-complete/tableView/tableView":"tableView","../../data/GameHandler":"GameHandler","../../data/HonorHandler":"HonorHandler","../../sdk/module/wx-btn/UserInfoBtn":"UserInfoBtn","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/utils/EventCenter":"EventCenter","../unit/DelayShowButton":"DelayShowButton","./RankCell":"RankCell"}],ReportHandler:[function(e,t,o){"use strict";cc._RF.push(t,"06c0dYSJv1EeY77S1DQUl2m","ReportHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n={new250:{default:!1,saveServer:!1}},i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onInit=function(){this.serverKey="reportData",this.initStorageData(n)},t.prototype.onDataLoadOver=function(){},t}(e("../submodule/data/DataHandler").default));o.default=i,cc._RF.pop()},{"../submodule/data/DataHandler":"DataHandler"}],ResultPanel:[function(e,t,o){"use strict";cc._RF.push(t,"a7cb5C1g+1FfaO3wUebadoR","ResultPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/SubViewController"),i=e("../../submodule/component/PopLayerBase"),a=e("../../submodule/utils/EventCenter"),r=e("../../common/Define"),s=e("../../common/Common"),c=e("../../submodule/component/ActionBase"),l=e("../../data/HonorHandler"),u=e("../../submodule/data/LanguageHandler"),h=e("../unit/HonorIcon"),d=e("../../data/ShortcutHandler"),p=e("../../submodule/utils/FileUtils"),f=cc._decorator,_=f.ccclass,g=f.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.bestScoreLabel=null,t.newRecordNode=null,t.playButton=null,t.buttonLight=null,t.actionList=[],t.subView=null,t.honorButton=null,t.honorIcon=null,t.additionLabel=null,t.shortcutIcon=null,t.shortcutAdditionLabel=null,t._shortcutIconScale=1,t}return __extends(t,e),t.prototype.init=function(e,t,o){this.scoreLabel.string=e+"",this.bestScoreLabel.string=t+"",this.newRecordNode.active=o},t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),WxSDK.hideBanner(),a.default.register(r.EventMsg.RANK_VIEW_CLOSE,this,this._onRankViewClose),a.default.register(r.EventMsg.MISSIONS_REFRESH,this,this.checkHonorButton),a.default.register(r.EventMsg.HONOR_UPGRADE,this,this.refreshAdditionLabel),a.default.register(r.EventMsg.ON_CONFIG_LOADED,this,this.checkShowShortcut),a.default.register(r.EventMsg.ON_LIMIT_CHANGE,this,this.checkShowShortcut),a.default.register(r.EventMsg.ON_SHORTCUT_SUCCESS,this,this.checkShowShortcutIcon),a.default.register(r.EventMsg.RESTART_GAME_EVENT,this,function(){t.buttonCallback(null,"restart")}),this._shortcutIconScale=this.shortcutIcon.scale},t.prototype.start=function(){this.node.parent.getChildByName("rankPanel")||this.subView.show({type:SubViewType.RESULT_RANK}),this.buttonLight.runAction(cc.sequence(cc.fadeTo(1,100),cc.fadeTo(1,255)).repeatForever()),this.checkHonorButton(),this.refreshAdditionLabel(),this.checkShowShortcut(),this.checkShowShortcutIcon()},t.prototype.onClose=function(){d.default.shortCutShowed=!1},t.prototype.checkShowShortcut=function(){d.default.checkCanShow()&&this.showShortcutButton()},t.prototype.showShortcutButton=function(){var e=this;d.default.shortCutShowed||(d.default.shortCutShowed=!0,this.scheduleOnce(function(){p.default.getPrefabAsync("unit/shortcutButton",function(t){var o=cc.instantiate(t);e.node.addChild(o)})},1))},t.prototype.checkShowShortcutIcon=function(){d.default.shortCutGet?(!1===this.shortcutIcon.active&&(this.shortcutIcon.scale=0,this.shortcutIcon.active=!0,this.shortcutIcon.runAction(cc.scaleTo(.5,this._shortcutIconScale).easing(cc.easeElasticOut(.5)))),this.shortcutIcon.active=!0,this.shortcutAdditionLabel.string=u.LanguageHandler.getLanguageData("\u5206\u6570")+"+"+WxSDK.shortcut_reward+"%",this.node.getChildByName("shortcutButton")&&this.node.getChildByName("shortcutButton").removeSelf()):this.shortcutIcon.active=!1},t.prototype.checkHonorButton=function(){var e=l.default.getMissionComplete();this.honorIcon.show(l.default.honorId),e?(this.honorButton.playAction(),this.honorButton.node.getChildByName("red").active=!0):(this.honorButton.stopAction(),this.honorButton.node.getChildByName("red").active=!1)},t.prototype.refreshAdditionLabel=function(){this.additionLabel.string=u.LanguageHandler.getLanguageData("\u5206\u6570")+" +"+l.default.getCurHonorData().addition+"%"},t.prototype._onRankViewClose=function(){console.log("onRankingClose"),WxSDK.hideBanner(),this.subView.active=!0,this.subView.show({type:SubViewType.RESULT_RANK})},t.prototype.buttonCallback=function(e,t){switch(t){case"rank":this.subView.active=!1,WxSDK.showBanner(),s.Common.popPanel({name:"panel/rankPanel",callback:function(e){e.init(SubViewType.FRIEND_RANK)}});break;case"restart":this.setCustomCloseCallback(function(){a.default.post(r.EventMsg.RESTART_GAME)}),this.close();break;case"openHonor":s.Common.popPanel({name:"panel/honorPanel"})}},__decorate([g(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([g(cc.Label)],t.prototype,"bestScoreLabel",void 0),__decorate([g(cc.Node)],t.prototype,"newRecordNode",void 0),__decorate([g(cc.Node)],t.prototype,"playButton",void 0),__decorate([g(cc.Node)],t.prototype,"buttonLight",void 0),__decorate([g([cc.Node])],t.prototype,"actionList",void 0),__decorate([g(n.default)],t.prototype,"subView",void 0),__decorate([g(c.default)],t.prototype,"honorButton",void 0),__decorate([g(h.default)],t.prototype,"honorIcon",void 0),__decorate([g(cc.Label)],t.prototype,"additionLabel",void 0),__decorate([g(cc.Node)],t.prototype,"shortcutIcon",void 0),__decorate([g(cc.Label)],t.prototype,"shortcutAdditionLabel",void 0),t=__decorate([_],t)}(i.default);o.default=v,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../common/SubViewController":"SubViewController","../../data/HonorHandler":"HonorHandler","../../data/ShortcutHandler":"ShortcutHandler","../../submodule/component/ActionBase":"ActionBase","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/data/LanguageHandler":"LanguageHandler","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/FileUtils":"FileUtils","../unit/HonorIcon":"HonorIcon"}],RevivePanel:[function(e,t,o){"use strict";cc._RF.push(t,"117f5TGxY5GaopWZB54sYk8","RevivePanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../unit/RewardButton"),a=e("../unit/DelayShowButton"),r=e("../../submodule/utils/EventCenter"),s=e("../../common/Define"),c=e("../../common/SubViewController"),l=e("../../submodule/utils/SoundUtils"),u=cc._decorator,h=u.ccclass,d=u.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.newRecordNode=null,t.timeDownLabel=null,t.timeDownEffect=null,t.rewardButton=null,t.skipButton=null,t.overView=null,t.animationList=[],t}return __extends(t,e),t.prototype.start=function(){var e=this;r.default.register(s.EventMsg.REWARD_ADS_SHOW,this,function(){e.timeDownLabel.node.pauseAllActions()}),r.default.register(s.EventMsg.REWARD_ADS_HIDE,this,function(){e.timeDownLabel.node.resumeAllActions()}),r.default.register(s.EventMsg.GO_TO_SHARE,this,function(t){t.source===e.rewardButton.sharePos&&e.timeDownLabel.node.pauseAllActions()}),r.default.register(s.EventMsg.CANCEL_SHARE,this,function(t){t.source===e.rewardButton.sharePos&&e.timeDownLabel.node.resumeAllActions()})},t.prototype.init=function(e,t){var o;o=WxSDK.hasVideo()?WxSDK.getReward(TermType.VIDEO,this.rewardButton.sharePos):WxSDK.hasShare()?WxSDK.getReward(TermType.SHARE,this.rewardButton.sharePos):WxSDK.getReward(TermType.VIDEO,this.rewardButton.sharePos),this.rewardButton.turn(o),this.scoreLabel.string=e,this.newRecordNode.active=t,this.showTimeDown(),this.overView.show({type:SubViewType.OVER_STEP,detail:e})},t.prototype.playAnimationShow=function(){},t.prototype.onShow=function(){},t.prototype.onClose=function(){r.default.post(s.EventMsg.ON_DOOR_PROGRESS_CHANGE,0)},t.prototype.showTimeDown=function(){var e=this,t=WxSDK.revive_wait_time;this.timeDownLabel.node.runAction(cc.sequence(cc.floatTo(t+1,t,0,function(o){var n=Math.ceil(o).toString();n!==e.timeDownLabel.string&&(e.timeDownLabel.string=n,e.timeDownEffect.string=n,l.default.playSFX("daojishi"),e.timeDownLabel.node.runAction(cc.sequence(cc.scaleTo(.1,1.05),cc.callFunc(function(t){e.timeDownEffect.opacity=150,e.timeDownEffect.scale=1,e.timeDownEffect.node.runAction(cc.spawn(cc.fadeOut(.3),cc.scaleTo(.3,2)))}),cc.scaleTo(.1,1)))),r.default.post(s.EventMsg.ON_DOOR_PROGRESS_CHANGE,o/t)}),cc.callFunc(function(t){e.skip()}))),this.skipButton.play()},t.prototype.revive=function(e){this.setCustomCloseCallback(function(){r.default.post(s.EventMsg.ON_REVIVE_SUCCESS)}),this.close()},t.prototype.skip=function(){this.timeDownLabel.node.stopAllActions();var e=this.rewardButton.result.type;if(e===TermType.VIDEO)if(WxSDK.hasShare()){var t=WxSDK.getReward(TermType.SHARE,this.rewardButton.sharePos);this.rewardButton.turn(t),this.showTimeDown()}else this.setCustomCloseCallback(function(){r.default.post(s.EventMsg.ON_REVIVE_FAIL)}),this.close();else e===TermType.SHARE&&(this.setCustomCloseCallback(function(){r.default.post(s.EventMsg.ON_REVIVE_FAIL)}),this.close())},t.prototype.buttonCallback=function(e,t){switch(t){case"reward":this.revive(e);break;case"skip":this.skip()}},__decorate([d(cc.Label)],t.prototype,"scoreLabel",void 0),__decorate([d(cc.Node)],t.prototype,"newRecordNode",void 0),__decorate([d(cc.Label)],t.prototype,"timeDownLabel",void 0),__decorate([d(cc.Label)],t.prototype,"timeDownEffect",void 0),__decorate([d(i.default)],t.prototype,"rewardButton",void 0),__decorate([d(a.default)],t.prototype,"skipButton",void 0),__decorate([d(c.default)],t.prototype,"overView",void 0),__decorate([d([cc.Node])],t.prototype,"animationList",void 0),t=__decorate([h],t)}(n.default);o.default=p,cc._RF.pop()},{"../../common/Define":"Define","../../common/SubViewController":"SubViewController","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/SoundUtils":"SoundUtils","../unit/DelayShowButton":"DelayShowButton","../unit/RewardButton":"RewardButton"}],RewardButton:[function(e,t,o){"use strict";cc._RF.push(t,"f339dYa6MROBq0d1FzRL9sx","RewardButton"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../submodule/component/UnitBase"),a=e("../../submodule/utils/ClassModule"),r=e("../../sdk/WxSDK"),s=e("../../submodule/utils/EventCenter"),c=e("../../common/Define"),l=cc._decorator,u=l.ccclass,h=l.property;(function(e){e[e.SHARE_OR_VIDEO=0]="SHARE_OR_VIDEO",e[e.VIDEO_FIRST=1]="VIDEO_FIRST",e[e.NONE=2]="NONE"})(n=o.RewardType||(o.RewardType={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=new a.SpriteToggle,t.label=new a.LabelToggle,t.buttonEvents=[],t.type=n.SHARE_OR_VIDEO,t.result=null,t.sharePos=SharePos.NORMAL,t.autoRefresh=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on("touchend",this.touchEnd,this),this.autoRefresh&&(this.refreshResult(),s.default.register(c.EventMsg.REWARD_ADS_LOADED,this,this.refreshResult))},t.prototype.onDestroy=function(){this.node.off("touchend",this.touchEnd,this),e.prototype.onDestroy.call(this)},t.prototype.turn=function(e){null===e?(this.result={result:!1,type:TermType.VIDEO,pos_id:this.sharePos},this.icon.turn(TermType.VIDEO),this.label.turn(TermType.VIDEO,!0)):(e.type===TermType.FREE?(this.icon.turn(TermType.SHARE),this.label.turn(TermType.SHARE,!0)):(this.icon.turn(e.type),this.label.turn(e.type,!0)),this.result=e),void 0===this.result.pos_id&&(this.result.pos_id=this.sharePos)},t.prototype.refreshResult=function(){if(this.type===n.SHARE_OR_VIDEO){var e=r.shareOrVideo(this.sharePos);this.turn(e)}else if(this.type===n.VIDEO_FIRST){e=r.videoFirst(this.sharePos);this.turn(e)}else this.type===n.NONE&&this.turn({result:!0,type:TermType.FREE})},t.prototype.touchEnd=function(){var e,t=this;e=this.result&&!1!==this.result.result?this.result:null;var o=this;r.termCheck(e,function(e){t.buttonEvents.length>0&&(cc.Component.EventHandler.emitEvents(t.buttonEvents,{target:o,result:e}),t.autoRefresh&&t.refreshResult())})},__decorate([h(a.SpriteToggle)],t.prototype,"icon",void 0),__decorate([h(a.LabelToggle)],t.prototype,"label",void 0),__decorate([h({type:[cc.Component.EventHandler]})],t.prototype,"buttonEvents",void 0),__decorate([h({type:cc.Enum(n)})],t.prototype,"type",void 0),__decorate([h({type:cc.Enum(SharePos)})],t.prototype,"sharePos",void 0),__decorate([h],t.prototype,"autoRefresh",void 0),t=__decorate([u],t)}(i.default);o.default=d,cc._RF.pop()},{"../../common/Define":"Define","../../sdk/WxSDK":"WxSDK","../../submodule/component/UnitBase":"UnitBase","../../submodule/utils/ClassModule":"ClassModule","../../submodule/utils/EventCenter":"EventCenter"}],SceneBase:[function(e,t,o){"use strict";cc._RF.push(t,"02484d+KqRGJIYfuoBwW6V1","SceneBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/utils/EventCenter"),i=e("../common/Define"),a=e("../submodule/utils/FileUtils"),r=e("../common/Common"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.default.register(i.EventMsg.POP_LAYER,this,this._onPopLayer)},t.prototype.onDestroy=function(){n.default.removeRegister(this)},t.prototype._onPopLayer=function(e){var t=e.source,o=t.name,n=t.callback,i=t.manager,a=t.onError;this.popLayer(o,n,i,a)},t.prototype.popLayer=function(e,t,o,n){var i=null,s=a.default.getSimpleUrlWithoutAsp(e);if(this.node.getChildByName(s))i=this.node.getChildByName(s),this._handleComponent(i,!0,o,t);else if(this[s])(i=cc.instantiate(this[s])).name=s,this._handleComponent(i,!1,o,t);else{var c=this;r.Common.showLoading(null,.2),function i(){a.default.getPrefabAsync(e,function(e){if(!c.node.getChildByName(s)){var n=cc.instantiate(e);n.name=s,c._handleComponent(n,!1,o,t)}r.Common.hideLoading()},function(e){n&&n(),c.scheduleOnce(function(e){c.showModal(function(e){e.config&&i()})},1.5)})}()}},t.prototype._handleComponent=function(e,t,o,n){var i=e.getComponent("PopLayerBase");i&&(i.manager=o||this),t?i.show&&i.show():(e.parent=this.node,n&&n(i))},t.prototype.showModal=function(e,t,o){"undefined"!=typeof wx&&wx.showModal({title:"\u52a0\u8f7d\u5931\u8d25",content:"\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86\uff0c\u8bf7\u91cd\u8bd5!",showCancel:!1,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u8ba4",success:e,fail:t,complete:o})},t=__decorate([c],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../common/Common":"Common","../common/Define":"Define","../submodule/utils/EventCenter":"EventCenter","../submodule/utils/FileUtils":"FileUtils"}],ScoreEffect:[function(e,t,o){"use strict";cc._RF.push(t,"c52b3Uco3NOTalTZdMr4JPz","ScoreEffect"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/utils/SoundUtils"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ani=null,t}return __extends(t,e),t.prototype.show=function(e){var t=null,o="";2===e?(t="cool",o="cool"):3===e?(t="good",o="great"):4===e?(t="beautiful",o="nice"):e>=5&&(t="great",o="super"),null!==t&&(this.ani.addEventListener(dragonBones.EventObject.COMPLETE,this._complete,this),this.ani.playAnimation(t,1),n.default.playSFX(o))},t.prototype._complete=function(){this.ani.removeEventListener(dragonBones.EventObject.COMPLETE),this.node.removeSelf()},__decorate([r(dragonBones.ArmatureDisplay)],t.prototype,"ani",void 0),t=__decorate([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../../submodule/utils/SoundUtils":"SoundUtils"}],ServerHandler:[function(e,t,o){"use strict";cc._RF.push(t,"709caroCxBE1rszdq4hLQ5m","ServerHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../submodule/data/DataHandler"),i=e("./DateTimerHandler"),a=e("../common/Common"),r={},s=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._saveData=null,t.isNewPlayer=!1,t.hasOnlineData=!1,t}return __extends(t,e),t.prototype.onInit=function(){},t.prototype.onDataLoadOver=function(){for(var e=0,t=n.default.HandlerList;e<t.length;e++){var o=t[e];null!==o.serverKey&&(r[o.serverKey]=o)}this._initSaveData()},t.prototype._initSaveData=function(){this._saveData={};var e=function(e){var o=r[e],n=o.serverKeyList;if(n.length>0){t._saveData[e]={};for(var i=function(n){void 0!==o[n]&&Object.defineProperty(t._saveData[e],n,{get:function(){return o[n]},set:function(e){o[n]=e},configurable:!0,enumerable:!0})},a=0,s=n;a<s.length;a++){i(s[a])}}},t=this;for(var o in r)e(o)},t.prototype.cleanServerData=function(e,t){this._saveData={},n.default.HandlerList.forEach(function(e){e.removeTableData(),e.removeStorageData()}),this.doSaveData(e,t)},t.prototype.initServerData=function(e,t){var o=this;if("undefined"!=typeof wx)console.log("\u62c9\u53d6\u670d\u52a1\u5668\u6570\u636e"),Server.getData(function(t,n){if(t){t=JSON.parse(t);var i=o._saveData;console.log("localData:",i,"serverData:",t);var a=i.gameData.playCount;t.gameData&&void 0!==t.gameData.playCount?t.gameData.playCount>a?(console.log("\u4f7f\u7528\u670d\u52a1\u5668\u4fdd\u5b58\u7684\u6570\u636e:",t.gameData.playCount,">",a),o.setServerData(t)):console.log("\u4f7f\u7528\u672c\u5730\u5b58\u50a8"):0===a&&(console.log("\u68c0\u6d4b\u5230\u65b0\u7528\u6237"),o.isNewPlayer=!0)}else console.log("\u68c0\u6d4b\u5230\u65b0\u7528\u6237"),o.isNewPlayer=!0;o.hasOnlineData=!0,o.handlerServerTimeCore(n,!1),e&&e()},function(){console.log("\u83b7\u53d6\u670d\u52a1\u5668\u6570\u636e\u5931\u8d25!"),t&&t()});else{var n=a.Common.getDateTimeTest();this.handlerServerTimeCore(n,!1),e&&e()}},t.prototype.setServerData=function(e){for(var t in e){var o=e[t],n=this._saveData[t];for(var i in o)void 0!==n[i]&&(n[i]=o[i])}},t.prototype.doSaveData=function(e,t){var o=this._getValidData();console.log("\u5b58\u50a8\u6570\u636e:",o),this.hasOnlineData?Server.saveData(o,function(t){console.log("\u63d0\u4ea4\u5230\u670d\u52a1\u5668\u6210\u529f1"),e&&e()},function(){console.log("\u63d0\u4ea4\u670d\u52a1\u5668\u5931\u8d251\uff0c\u91cd\u8bd5\u4e2d..."),Server.saveData(o,function(t){console.log("\u63d0\u4ea4\u5230\u670d\u52a1\u5668\u6210\u529f2"),e&&e()},function(){console.log("\u63d0\u4ea4\u5230\u670d\u52a1\u5668\u5931\u8d252"),t&&t()})}):(console.log("\u6ca1\u6709\u4ece\u670d\u52a1\u5668\u83b7\u5f97\u7684\u6570\u636e\uff01"),t&&t());for(var i=0,a=n.default.HandlerList;i<a.length;i++){a[i].saveTableData()}},t.prototype._getValidData=function(){return JSON.stringify(this._saveData)},t.prototype.handlerServerTimeCore=function(e,t){i.default.checkRefreshDateData(e)},t.prototype._delaySave=function(){this.doSaveData()},t}(n.default));o.default=s,cc._RF.pop()},{"../common/Common":"Common","../submodule/data/DataHandler":"DataHandler","./DateTimerHandler":"DateTimerHandler"}],Server:[function(e,t,o){"use strict";cc._RF.push(t,"fa615Ha+QVCgLxA1L7rmuq0","Server");var n=e("PP"),i=e("WxSDK"),a=e("sdk"),r={game_id:GAME_ID,version:GAME_VERSION,report_user_id:null,data_user_id:null,app_id:"wx00d984443ee4a472",gamebox_ads:{list:[],toapp:null,flag:""},toappid:null,vid:"",flag:"",getGameBoxConfig:function(e,t){var o=this,n=function(e){console.log("\u62c9\u53d6game_box\u914d\u7f6e\u5931\u8d25",JSON.stringify(e)),t&&t()};this.wxLogin(function(a){a.os=i.getPlatform(),a.game_id=o.game_id,a.vid=o.vid,a.toappid=o.toappid,a.flag=o.flag,console.log("\u62c9\u53d6game_box\u914d\u7f6e:",a);wx.request({url:"https://box.xiaoyouxiqun.com/gamebox.php",header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},method:"GET",data:a,success:function(n){if(console.log("\u83b7\u53d6game_box\u914d\u7f6e\u6210\u529f:",n),n.data){for(var i in n.data)o.gamebox_ads[i]=n.data[i];e&&e()}else console.log("\u672a\u627e\u5230data\u6570\u636e"),t&&t()},fail:n})})},reportClick:function(e,t){var o=this;this.wxLogin(function(n){n.os=i.getPlatform(),n.game_id=o.game_id,n.tag=e,n.page=t,console.log("\u63d0\u4ea4\u53c2\u6570:",n);wx.request({url:"https://report.xiaoyouxiqun.com/report_click.php",header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},method:"POST",data:n,success:function(e){console.log("\u4e8b\u4ef6\u4e0a\u62a5\u6210\u529f:",e),e&&e.data&&e.data.user_id&&(o.user_id=e.data.user_id)},fail:function(e){console.log("\u4e8b\u4ef6\u4e0a\u62a5\u5931\u8d25:",e)}})})},pay:function(e,t,o){var n=100*Number(e);wx.requestMidasPayment({mode:"game",env:0,offerId:"1450018521",buyQuantity:n,zoneId:1,currencyType:"CNY",platform:"android",success:function(e){console.log("\u652f\u4ed8\u6210\u529f!",e),t&&t(e)},fail:function(e){var t=e.errMsg,n=e.errCode;console.log("\u652f\u4ed8\u5931\u8d25!",t,n),o&&o({errMsg:t,errCode:n})}})},getServerTime:function(e,t){console.log("\u83b7\u53d6\u670d\u52a1\u5668\u65f6\u95f4"),"undefined"!=typeof wx&&wx.request({url:"https://reada.xiaoyouxiqun.com/time.html?"+n.pp.getRandomStr(),header:{},method:"GET",success:function(o){var i=n.pp.checkPropertiesList(o,"header","Date"),a=i?new Date(i).getTime():-1;console.log("\u65f6\u95f4\u63a5\u53e3:",a,i),a>0?e(a):t(o)},fail:function(o){console.log("timeFail:",o);var i=n.pp.checkPropertiesList(o,"header","Date"),a=i?new Date(i).getTime():-1;a>0?e(a):t(o)}})},getData:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.getUserIdOrCode(this.data_user_id,function(n){n.game_id=t.game_id,n.type="get",console.log("\u83b7\u53d6\u6570\u636e"),console.log(n),wx.request({url:"https://reada.xiaoyouxiqun.com/data.php",header:{},method:"GET",data:n,success:function(n){console.log("\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\u6210\u529f",n);var i=n.header.Date,a=i?new Date(i).getTime():-1;0===n.data.code&&-1!==a?(n.data.user_id&&(t.data_user_id=n.data.user_id,console.log("this.data_user_id == ",t.data_user_id)),e&&e(n.data.info,a)):(console.log("\u62c9\u53d6\u6570\u636e\u5931\u8d25!"),o&&o(n))},fail:function(e){console.log("\u8bf7\u6c42\u4ece\u670d\u52a1\u83b7\u53d6\u6570\u636e\u5931\u8d25"),o&&o(e)},complete:function(){}})},o)},saveData:function(e,t){var o=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.getUserIdOrCode(this.data_user_id,function(i){i.game_id=o.game_id,i.type="put",i.info=e,console.log("\u4fdd\u5b58\u6570\u636e"),console.log(i),wx.request({url:"https://leviathan.xiaoyouxiqun.com/data.php",header:{},method:"GET",data:i,success:function(e){console.log("\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668\u6210\u529f",e),0===e.data.code?t&&t(e):n&&n(e)},fail:function(e){console.log("\u8bf7\u6c42\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668\u5931\u8d25"),n&&n(e)},complete:null})},n)},wxLoginAndGetInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;wx.login({success:function(o){var n=o.code;console.log("login code: "+o.code),a.getUserInfoForce(function(t){console.log("\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u4fe1\u606f\u6210\u529f",JSON.stringify(t));var o={code:n,iv:t.iv,rawData:t.rawData,encryptedData:t.encryptedData,signature:t.signature};e(o)},function(e){console.log("\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u4fe1\u606f\u5931\u8d25",JSON.stringify(e)),t&&t(e)})},fail:function(e){console.log("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u5931\u8d25",JSON.stringify(e)),t&&t(e)}})},getUserIdOrCode:function(e,t){var o=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e?wx.checkSession({success:function(o){console.log("\u767b\u5f55\u672a\u8d85\u65f6, \u4f7f\u7528\u672c\u5730user_id"),t({user_id:e})},fail:function(e){console.log("\u767b\u5f55\u8d85\u65f6, \u91cd\u65b0\u5fae\u4fe1\u767b\u5f55"),o.wxLogin(t,n)}}):(console.log("\u672c\u5730\u65e0user_id, \u4f7f\u7528\u5fae\u4fe1\u767b\u5f55\u83b7\u53d6code"),this.wxLogin(t,n))},wxLogin:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;wx.login({success:function(t){var o=t.code;console.log("login code: "+t.code),e&&e({code:o})},fail:function(e){console.log("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u5931\u8d25: ",e),t&&t(e)}})},getGroupID:function(e,t,o,n){var i={game_id:this.game_id,code:e,encryptedData:t.encryptedData,iv:t.iv};console.log("\u8bf7\u6c42\u7684data: ",i),wx.request({url:"https://api.xiaoyouxiqun.com/gid.php",data:i,header:{"content-type":"application/json"},success:function(e){e.data&&0===e.data.code?(console.log("\u89e3\u5bc6\u7fa4\u6570\u636e\u6210\u529f: ",e),o&&o(e.data.opendata.openGId)):(console.log("\u89e3\u5bc6\u7fa4\u6570\u636ecode != 0: ",e),o&&o(0))},fail:function(e){console.log("\u89e3\u5bc6\u7fa4\u6570\u636e\u5931\u8d25: ",e),n&&n(e)}})},reportAppid:function(e,t,o,n){var i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.getUserIdOrCode(this.report_user_id,function(r){r.game_id=i.game_id,r.app_id=e,r.auth_flag=o,r.channel_id=t,r.version=i.version,console.log("\u62a5\u544a\u6765\u6e90appid:",r),wx.request({url:"https://statistics.xiaoyouxiqun.com/report.php",data:r,method:"GET",header:{},success:function(e){console.log("\u62a5\u544a\u6765\u6e90appid\u6210\u529f: ",e),e&&e.data&&e.data.user_id&&(i.report_user_id=e.data.user_id,console.log("this.report_user_id == ",i.report_user_id)),n&&n()},fail:function(e){console.log("\u8bf7\u6c42\u62a5\u544a\u6765\u6e90appid\u5931\u8d25: ",e),a&&a()}})},a)},submitLeaderboard:function(e,t){var o=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c: ",e),this.wxLoginAndGetInfo(function(a){a.game_id=o.game_id,a.score=e.score,a.ext=e.ext,console.log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c(data): ",a),wx.request({url:"https://leaderboard.xiaoyouxiqun.com/submit.php",header:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:a,success:function(e){e&&e.data&&0==e.data.code?(console.log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c\u6210\u529f: ",e),i.leaderSubmitted||(i.leaderSubmitted=!0),t&&t(e)):(console.log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c\u5931\u8d25: ",e),n&&n(e))},fail:function(e){console.log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c\u5931\u8d25: ",e),n&&n(e)}})},function(e){n&&n(e)})},getLeaderboard:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("\u5f00\u59cb\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c");this.wxLogin(function(n){n.game_id=t.game_id,console.log("\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c(\u8bf7\u6c42data): ",n),wx.request({url:"https://leaderboard.xiaoyouxiqun.com/get.php",header:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:n,success:function(t){t&&t.data&&0==t.data.code?(console.log("\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u6210\u529f: ",t),e&&e(t)):(console.log("\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u5931\u8d25: ",t),o&&o(t))},fail:function(e){console.log("\u8bf7\u6c42\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u5931\u8d25: ",e),o&&o(e)}})},o)}};window.Server=t.exports=r;if(window.wx){var s=wx.getLaunchOptionsSync();console.log("launchOptions == "+s),s&&s.query&&(void 0!==s.query.flag&&(r.flag=s.query.flag),void 0!==s.query.vid&&(r.vid=s.query.vid),s.query.toIndex>=0&&s.query.toIndex<10&&console.log("launchOptions.query.toIndex = "+s.query.toIndex))}cc._RF.pop()},{PP:"PP",WxSDK:"WxSDK",sdk:"sdk"}],SettingHandler:[function(e,t,o){"use strict";cc._RF.push(t,"64a3bHSiEpKdqveJDGBtNGi","SettingHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./DataHandler"),a=e("../utils/EventCenter");(function(e){e[e.CN=0]="CN",e[e.EN=1]="EN"})(n=o.LanguageType||(o.LanguageType={}));var r={musicState:!0,sfxState:!0,vibrateState:!0,language:n.CN},s=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onInit=function(){this._tableKey="SettingTable",this.initTableData(r),this.language=n.EN},t.prototype.onLoadConfig=function(e){},t.prototype.turnSound=function(e){this.turnMusic(e),this.turnSFX(e)},t.prototype.turnMusic=function(e){this.musicState=e,a.default.post("soundStateChange",{type:"musicState",value:e}),this.saveTableData()},t.prototype.turnSFX=function(e){this.sfxState=e,a.default.post("soundStateChange",{type:"sfxState",value:e}),this.saveTableData()},t.prototype.turnVibrate=function(e){this.vibrateState=e,this.saveTableData()},t}(i.default));o.default=s,cc._RF.pop()},{"../utils/EventCenter":"EventCenter","./DataHandler":"DataHandler"}],ShapeBlocks:[function(e,t,o){"use strict";cc._RF.push(t,"9dd92cMipRN0I6IJADM9vqZ","ShapeBlocks"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/Define"),i=function(){function e(e,t,o,n){this.id=0,this.type=0,this._xy=cc.v2(),this._scale=1,this._zIndex=0,this._opacity=0,this.colorIdx=0,this._isGray=!1,this.list=[],this._firstIndex=null,this._firstNode=null,this._blockWidth=0,this._blockWidth=o,this._pool=t,this.type=e.type;var i=e.matrix;this.colorIdx=n;for(var a=0;a<i.length;a++)for(var r=0;r<i[a].length;r++)if(1===i[a][r]){var s=t.get(),c=s.getComponent("Block");s.width=s.height=o;var l=e.getRelativePos(a,r);c.relativePos=l,c.turnNormal(n),this.list.push(c),null===this._firstIndex&&(this._firstIndex=cc.v2(r,a),this._firstNode=s)}this.xy=cc.v2(),this.shape=e}return Object.defineProperty(e.prototype,"xy",{get:function(){return this._xy},set:function(e){this._xy=e,this._refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e;for(var t=0,o=this.list;t<o.length;t++){o[t].scale=this._scale}this._refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e;for(var t=0,o=this.list;t<o.length;t++){o[t].node.zIndex=this._zIndex}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity=e;for(var t=0,o=this.list;t<o.length;t++){o[t].node.opacity=this._opacity}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGray",{get:function(){return this._isGray},set:function(e){this._isGray=e;for(var t=0,o=this.list;t<o.length;t++){o[t].turnGray(e)}},enumerable:!0,configurable:!0}),e.getBottomScale=function(e){return 4===e.type||8===e.type?n.Define.BOTTOM_FIVE_SCALE:n.Define.BOTTOM_SCALE},e.prototype._refresh=function(){for(var e=0,t=this.list;e<t.length;e++){var o=t[e];o.node.xy=this._xy.add(o.relativePos.mul(this._blockWidth*this._scale))}},e.prototype.getRelativePosWithFirstInMap=function(e,t,o){var n=this.list[e],i=this.list[0],a=n.relativePos.sub(i.relativePos),r=a.y+t,s=a.x+o;return cc.v2(s,r)},e.prototype.getFirstIndex=function(){return this._firstIndex},e.prototype.getMatrix=function(){return this.shape.matrix},e.prototype.beChoose=function(e){this.xy=cc.v2(e.x,e.y+n.Define.TOUCH_OFFSET_Y),this.scale=1,this.zIndex=6;for(var t=0,o=this.list;t<o.length;t++){o[t].scale=n.Define.SHOW_SCALE}},e.prototype.beRelease=function(t){this.xy=t,this.scale=e.getBottomScale(this),this.zIndex=0},e.prototype.remove=function(e){if(void 0===e&&(e=!1),e)for(var t=0,o=this.list;t<o.length;t++){var n=o[t];this._pool.put(n.node)}this.list=[]},e.prototype.runAction=function(e){cc.director.getActionManager().addAction(e,this,!1)},e.prototype.stopAllActions=function(){cc.director.getActionManager().pauseAllRunningActions(),cc.director.getActionManager().removeAllActions()},e}();o.default=i,cc._RF.pop()},{"../common/Define":"Define"}],ShapeFactory:[function(e,t,o){"use strict";cc._RF.push(t,"1bb70bdkgBLVo9bYi8LFT3T","ShapeFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){this.angle=0,this.matrix=null,this.type=0,this.desc="",this.init(),this.setAngle(e)}return e.prototype.setAngle=function(e){this.angle=e,this.matrix=this.getAngleShape(e)},e.prototype.init=function(){},e.prototype.getAngleShape=function(e){var t=function(e){for(var t=e.split(","),o=[],n=0;n<t.length;n++)o[n]=t[n].split(""),o[n].forEach(function(e,t,o){o[t]=parseInt(e)});return o}(this.baseDataStr);return e%90==0?function(e,t){if(void 0===t&&(t=90),0==(t=(t%360+360)%360))return e;for(var o=[],n=e.length,i=e[0].length,a=0;a<n;a++)for(var r=0;r<i;r++)if(90===t)o[s=i-1-r]||(o[s]=[]),o[s][a]=e[a][r];else if(180===t)o[s=n-1-a]||(o[s]=[]),o[s][i-1-r]=e[a][r];else if(270===t){var s=n-1-a;o[r]||(o[r]=[]),o[r][s]=e[a][r]}return o}(t,e):(console.error("\u89d2\u5ea6\u9519\u8bef!"),t)},e.prototype.getRelativePos=function(e,t){var o=this.matrix.length,n=this.matrix[0].length/2,i=o/2;return cc.v2(t+.5-n,e+.5-i)},e}();o.ShapeData=n;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="single",this.baseDataStr="1",this.difficult=1},t}(n),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="double",this.baseDataStr="11",this.difficult=2},t}(n),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="three",this.baseDataStr="111",this.difficult=3},t}(n),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="four",this.baseDataStr="1111",this.difficult=4},t}(n),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="five",this.baseDataStr="11111",this.difficult=5},t}(n),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="t3",this.baseDataStr="111,010",this.difficult=5},t}(n),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="z",this.baseDataStr="110,011",this.difficult=5},t}(n),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="rect2",this.baseDataStr="11,11",this.difficult=4},t}(n),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="rect3",this.baseDataStr="111,111,111",this.difficult=8},t}(n),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="l3",this.baseDataStr="10,11",this.difficult=4},t}(n),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="l4",this.baseDataStr="111,100",this.difficult=5},t}(n),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.desc="l5",this.baseDataStr="001,001,111",this.difficult=6},t}(n),g=[{score:4e3,diff:[13,24]},{score:2e3,diff:[13,22]},{score:1500,diff:[13,20]},{score:1200,diff:[13,18]},{score:1e3,diff:[13,16]},{score:800,diff:[11,13]},{score:600,diff:[10,12]},{score:300,diff:[9,11]},{score:50,diff:[8,10]},{score:0,diff:[10,19]}],v=function(){function e(){}return e.init=function(){var e=[];this.ShapeList.forEach(function(t,o){t.type=o,e.push(t.difficult)}),this.difficultList=e.sort(function(e,t){return e-t})},e.getShapeByDifficult=function(e){var t=this.ShapeList.filter(function(t){return t.difficult===e});return t.length>0?t.getRandomOne():(console.error("\u6ca1\u6709\u627e\u5230\u8fd9\u4e2a\u96be\u5ea6\u7684\u5f62\u72b6"),null)},e.getRandomShape=function(){return this.ShapeList.getRandomOne()},e.getShapeByType=function(e){return this.ShapeList[e]},e.getShapesByRange=function(e){for(var t=this.difficultList,o=t[0],n=t[t.length-1],i=[],a=[],r=0,s=t;r<s.length;r++){if(!((S=s[r])+2*n<e[0])){if(S+2*o>e[1])break;a.push(S)}}var c=a.getRandomOne();a=[];for(var l=0,u=t;l<u.length;l++){if(!((f=(S=u[l])+c)+n<e[0])){if(f+o>e[1])break;a.push(S)}}var h=a.getRandomOne();a=[];for(var d=0,p=t;d<p.length;d++){var f;if(!((f=(S=p[d])+c+h)<=e[1]))break;f>=e[0]&&a.push(S)}var _=a.getRandomOne();i.push(c,h,_),console.log("\u96be\u5ea6\u533a\u95f4:"+e[0]+"--"+e[1]+",\u96be\u5ea6\u7cfb\u6570:"+c+"+"+h+"+"+_+"="+(c+h+_));for(var g=[],v="\u5f62\u72b6:",m=0,y=i;m<y.length;m++){var S=y[m],w=this.getShapeByDifficult(S);g.push(w),v+=w.desc+","}return console.log(v),g},e.getShapesByScore=function(e){for(var t,o=0,n=g;o<n.length;o++){var i=n[o];if(e>=i.score){t=i.diff;break}}return this.getShapesByRange(t)},e.ShapeList=[new i(0),new a(0),new r(0),new s(0),new c(0),new a(90),new r(90),new s(90),new c(90),new l(0),new u(0),new h(0),new d(0),new p(0),new f(0),new _(0)],e.difficultList=[],e}();o.default=v,v.init(),cc._RF.pop()},{}],ShortcutButton:[function(e,t,o){"use strict";cc._RF.push(t,"d2fa7oDA8dCTLtFAqFWf6U2","ShortcutButton"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/utils/EventCenter"),i=e("../../common/Define"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){this.node.zIndex=8,this.appear(),this.node.on("touchend",this.callback,this)},t.prototype.onDestroy=function(){this.node.off("touchend",this.callback,this)},t.prototype.callback=function(){WxSDK.reportEvent(WxSDK.ReportMsg.SHORTCUT_TOUCH),n.default.post(i.EventMsg.POP_LAYER,{name:"panel/shortcutPanel"})},t.prototype.appear=function(){var e=this,t=cc.view.getVisibleSize(),o=.5*t.height+274,n=.5*t.height+11;this.node.stopAllActions(),this.node.setPosition(190,o),this.node.runAction(cc.sequence(cc.moveTo(.7,190,n).easing(cc.easeBounceOut()),cc.callFunc(function(){e.pendular()})))},t.prototype.pendular=function(){this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.rotateTo(.5,-20).easing(cc.easeSineOut()),cc.rotateTo(1,20).easing(cc.easeSineInOut()),cc.rotateTo(.5,0).easing(cc.easeSineIn()))))},t=__decorate([r],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../common/Define":"Define","../../submodule/utils/EventCenter":"EventCenter"}],ShortcutGetPanel:[function(e,t,o){"use strict";cc._RF.push(t,"357fdrIBztEdrFrRIvaX5sZ","ShortcutGetPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../unit/DelayShowButton"),a=e("../GameManager"),r=e("../logic/GameLayer"),s=e("../../submodule/utils/SoundUtils"),c=e("../../submodule/utils/EventCenter"),l=e("../../submodule/utils/TaskStackHandler"),u=e("../../common/Define"),h=cc._decorator,d=h.ccclass,p=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeButton=null,t.iconNode=null,t.shareButton=null,t.upgradeLight=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.closeButton.opacity=0,s.default.playSFX("upgrade")},t.prototype.start=function(){var e=this;WxSDK.showBanner(),this.node.zIndex=100,this.iconNode.scale=0,this.iconNode.runAction(cc.sequence(cc.scaleTo(.8,1.35).easing(cc.easeBackOut()),cc.callFunc(function(t){e.upgradeLight.stopAllActions(),e.upgradeLight.runAction(cc.sequence(cc.fadeIn(.5),cc.callFunc(function(e){e.runAction(cc.rotateBy(1,30).repeatForever())})))}),cc.delayTime(.5),cc.callFunc(function(t){e.shareButton.active=!0,e.closeButton.play()})))},t.prototype.buttonCallback=function(e,t){var o=this;switch(t){case"close":this.close();break;case"share":WxSDK.resultShare(),this.scheduleOnce(function(){o.close()},.2)}},t.prototype.onShow=function(){},t.prototype.onClose=function(){cc.find("Canvas").getComponent(a.default).gameLayer.gameState===r.GameState.PREPARE&&WxSDK.hideBanner(),l.TaskStackHandler.completeTask(u.TaskMsg.MAIN_POP,u.TaskNames.POP_SHORTCUT_REWARD),c.default.post(u.EventMsg.ON_SHORTCUT_SUCCESS)},__decorate([p(i.default)],t.prototype,"closeButton",void 0),__decorate([p(cc.Node)],t.prototype,"iconNode",void 0),__decorate([p(cc.Node)],t.prototype,"shareButton",void 0),__decorate([p(cc.Node)],t.prototype,"upgradeLight",void 0),t=__decorate([d],t)}(n.default);o.default=f,cc._RF.pop()},{"../../common/Define":"Define","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/utils/EventCenter":"EventCenter","../../submodule/utils/SoundUtils":"SoundUtils","../../submodule/utils/TaskStackHandler":"TaskStackHandler","../GameManager":"GameManager","../logic/GameLayer":"GameLayer","../unit/DelayShowButton":"DelayShowButton"}],ShortcutHandler:[function(e,t,o){"use strict";cc._RF.push(t,"524d2VhIX5Dm45kpqwg0hp3","ShortcutHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n={shortCutGet:{default:!1,saveServer:!0},shortCutTodayShow:{default:!1,saveServer:!1}},i=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shortCutShowed=!1,t}return __extends(t,e),t.prototype.onInit=function(){this.serverKey="shortcutData",this._tableKey="shortcutData",this.initTableData(n)},t.prototype.onDataLoadOver=function(){},t.prototype.checkCanShow=function(){return!1},t}(e("../submodule/data/DataHandler").default));o.default=i,cc._RF.pop()},{"../submodule/data/DataHandler":"DataHandler"}],ShortcutPanel:[function(e,t,o){"use strict";cc._RF.push(t,"ea088WfCydH5Z8uYpwlr22r","ShortcutPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../unit/DelayShowButton"),a=e("../../submodule/utils/EventCenter"),r=e("../../common/Define"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.flagNode=null,t.closeButton=null,t.flagXy=cc.v2(),t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),a.default.register(r.EventMsg.ON_SHORTCUT_SUCCESS,this,function(){t.close()})},t.prototype.start=function(){WxSDK.showBanner(),this.flagNode.active=!1,this.flagNode.y=WxSDK.isIphoneLong()?cc.winSize.height/2-115:cc.winSize.height/2-60,this.flagXy=this.flagNode.xy},t.prototype.buttonCallback=function(e,t){switch(t){case"close":this.close()}},t.prototype.onShow=function(){this.closeButton.playNormal(),this.flagNode.active=!0,this.flagNode.stopAllActions(),this.flagNode.runAction(cc.speed(cc.sequence(cc.moveBy(.5,30,0),cc.moveBy(.5,-30,0),cc.delayTime(1)).repeatForever(),2))},t.prototype.onClose=function(){WxSDK.hideBanner()},__decorate([l(cc.Node)],t.prototype,"flagNode",void 0),__decorate([l(i.default)],t.prototype,"closeButton",void 0),t=__decorate([c],t)}(n.default);o.default=u,cc._RF.pop()},{"../../common/Define":"Define","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/utils/EventCenter":"EventCenter","../unit/DelayShowButton":"DelayShowButton"}],SoundUtils:[function(e,t,o){"use strict";cc._RF.push(t,"93582jSPUxCbobEY/ZnqgEy","SoundUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EventCenter"),i=e("./FileUtils"),a=e("../data/SettingHandler"),r=function(){function e(){}return e.init=function(){n.default.register("soundStateChange",this,this.checkLocalSetting)},e.initLocalSetting=function(){var e=a.default.musicState,t=a.default.sfxState;this.musicState=e,this.sfxState=t},e.checkLocalSetting=function(e){var t=e.source,o=t.type,n=t.value;this[o]=n,"musicState"===o&&this._checkBGM()},e._checkBGM=function(){this.musicState?this.bgmID?this.resumeMusic():this.bgmName&&this.playMusic(this.bgmName):null!==this.bgmID&&this.pauseMusic()},e.getAudioClip=function(e,t){i.default.getSoundAsync(e,t)},e.playMusic=function(e,t,o){var n=this;void 0===t&&(t=!0),this.bgmName=e,this.musicState&&this.getAudioClip(e,function(e){if(null!=e){var i=cc.audioEngine.playMusic(e,t);cc.audioEngine.setMusicVolume(o),n.bgmID=i}})},e.stopMusic=function(){cc.audioEngine.stopMusic()},e.pauseMusic=function(){cc.audioEngine.pauseMusic()},e.resumeMusic=function(){cc.audioEngine.resumeMusic()},e.playSFX=function(e,t,o,n){void 0===t&&(t=!1),this.sfxState&&this.getAudioClip(e,function(e){if(null!=e){var o=cc.audioEngine.playEffect(e,t);n&&n(o)}})},e.pauseSFX=function(e){this.sfxState&&cc.audioEngine.pauseEffect(e)},e.pauseAllSFXs=function(){this.sfxState&&cc.audioEngine.pauseAllEffects()},e.resumeSFX=function(e){this.sfxState&&cc.audioEngine.resumeEffect(e)},e.stopSFX=function(e){this.sfxState&&cc.audioEngine.stopEffect(e)},e.stopAllSFXs=function(){cc.audioEngine.stopAllEffects()},e.play=function(e,t,o,n){void 0===o&&(o=1),this.getAudioClip(e,function(e){if(null!==e){var i=cc.audioEngine.play(e,t,o);n&&n(i)}})},e.setLoop=function(e,t){cc.audioEngine.setLoop(e,t)},e.prototype.isLoop=function(e){return cc.audioEngine.isLoop(e)},e.pauseAll=function(){cc.audioEngine.pauseAll()},e.resumeAll=function(){cc.audioEngine.resumeAll()},e.stopAll=function(){cc.audioEngine.stopAll()},e.pause=function(e){cc.audioEngine.pause(e)},e.resume=function(e){cc.audioEngine.resume(e)},e.stop=function(e){cc.audioEngine.stop(e)},e.musicState=!0,e.sfxState=!0,e.bgmID=null,e.bgmName=null,e}();o.default=r,r.init(),cc._RF.pop()},{"../data/SettingHandler":"SettingHandler","./EventCenter":"EventCenter","./FileUtils":"FileUtils"}],StorageUtils:[function(e,t,o){"use strict";cc._RF.push(t,"56916tx1rlJhofpbgPEUs3g","StorageUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.initKeyCode=function(e,t){void 0===t&&(t=null),this._keyCode=null===t?e:e+t},e._getGameKey=function(e){return this._keyCode+e},e._getEncryptValue=function(e){return e},e._getDecryptValue=function(e){return e},e.setItem=function(e,t){e=this._getGameKey(e),t=this._getEncryptValue(t),this._setSync(e,t)},e.setItemAsync=function(e,t,o,n){void 0===o&&(o=null),void 0===n&&(n=null),e=this._getGameKey(e),t=this._getEncryptValue(t),this._setAsync(e,t,o,n)},e.getItem=function(e,t){void 0===t&&(t=null),e=this._getGameKey(e);var o=this._getSync(e);return o?this._getDecryptValue(o):t},e.getItemAsync=function(e,t,o,n){var i=this;void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n=null),e=this._getGameKey(e),this._getAsync(e,function(e){e?(e=i._getDecryptValue(e),o&&o(e)):o(t)},n)},e.setData=function(e,t){var o=JSON.stringify(t);this.setItem(e,o)},e.setDataAsync=function(e,t,o,n){void 0===o&&(o=null),void 0===n&&(n=null);var i=JSON.stringify(t);this.setItemAsync(e,i,o,n)},e.getData=function(e,t){void 0===t&&(t=null);var o=this.getItem(e);return null!==o?JSON.parse(o):t},e.getDataAsync=function(e,t,o,n){void 0===o&&(o=null),void 0===n&&(n=null),this.getItemAsync(e,t,function(e){o&&o(e)},n)},e.getItemInt=function(e,t){void 0===t&&(t=0);var o=this.getItem(e);return null!==o?parseInt(o):t},e.getItemIntAsync=function(e,t,o,n){void 0===o&&(o=null),void 0===n&&(n=null),this.getItemAsync(e,t,function(e){o&&o(e)},n)},e.removeData=function(e){e=this._getGameKey(e),this._removeSync(e)},e.clearDatas=function(){this._cleanSync()},e._setSync=function(e,t){"string"==typeof e&&("undefined"==typeof wx?cc.sys.localStorage.setItem(e,t):wx.setStorageSync(e,t))},e._getSync=function(e){return"undefined"==typeof wx?cc.sys.localStorage.getItem(e):wx.getStorageSync(e)},e._removeSync=function(e){return"undefined"==typeof wx?cc.sys.localStorage.removeItem(e):wx.removeStorageSync(e)},e._cleanSync=function(){return"undefined"==typeof wx?cc.sys.localStorage.clear():wx.clearStorageSync()},e._setAsync=function(e,t,o,n,i){void 0===o&&(o=null),void 0===n&&(n=null),void 0===i&&(i=null),"string"==typeof e&&("undefined"!=typeof wx?wx.setStorage({key:e,data:t+"",success:o,fail:n,complete:i}):(cc.sys.localStorage.setItem(e,t),o&&o()))},e._getAsync=function(e,t,o,n){void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n=null),"undefined"!=typeof wx?wx.getStorage({key:e,success:t,fail:o,complete:n}):(cc.sys.localStorage.getItem(e),t&&t())},e._removeAsync=function(e,t,o,n){void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n=null),"undefined"!=typeof wx?wx.removeStorage({key:e,success:t,fail:o,complete:n}):(cc.sys.localStorage.removeItem(e),t&&t())},e._cleanAsync=function(e,t,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=null),"undefined"!=typeof wx?wx.clearStorage({success:e,fail:t,complete:o}):(cc.sys.localStorage.clear(),e&&e())},e._keyCode="",e}();o.default=n,cc._RF.pop()},{}],SubViewController:[function(e,t,o){"use strict";cc._RF.push(t,"a3d5dmixL5K/6hW2dFx/taX","SubViewController"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=cc._decorator,a=i.ccclass;i.property;(function(e){e[e.RANK=0]="RANK",e[e.OVER_RANK=1]="OVER_RANK",e[e.OVER_STEP=2]="OVER_STEP",e[e.OVER_STEP_HORIZONTAL=3]="OVER_STEP_HORIZONTAL"})(n=o.WindowType||(o.WindowType={}));var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._windowType=null,t}return __extends(t,e),t.prototype.show=function(e){this.node.active=!0,e.key=WxSDK.bestScore,"undefined"!=typeof wx&&this.setData(e)},t.prototype.setData=function(e){switch(e.type){case SubViewType.FRIEND_RANK:WxSDK.getFriendRank(e.key),this._windowType=n.RANK;break;case SubViewType.GROUP_RANK:WxSDK.getGroupRankList(e.key,e.shareTicket),this._windowType=n.RANK;break;case SubViewType.GROUP_SHARE_RANK:WxSDK.getGroupFriendRank(e.key,e.callback),this._windowType=n.RANK;break;case SubViewType.RESULT_RANK:WxSDK.getHorizontalRank(e.key),this._windowType=n.OVER_RANK;break;case SubViewType.OVER_STEP:WxSDK.getOverStepData(e.key,e.detail),this._windowType=n.OVER_STEP;break;case SubViewType.OVER_STEP_HORIZONTAL:WxSDK.getOverStepHorizontalData(e.key,e.detail),this._windowType=n.OVER_STEP_HORIZONTAL}},t.prototype.onEnable=function(){this.getComponent(cc.WXSubContextView)||this.addComponent(cc.WXSubContextView)},t.prototype.onDisable=function(){this.getComponent(cc.WXSubContextView)&&this.node.removeComponent(cc.WXSubContextView),null!==this._windowType&&WxSDK.postCloseWindow(this._windowType)},t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],SwitchNode:[function(e,t,o){"use strict";cc._RF.push(t,"d5a9e5DuaRE9pYxsre++Rmo","SwitchNode"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=cc._decorator,a=i.ccclass,r=i.property;(function(e){e[e.NONE=0]="NONE",e[e.FADEIN=1]="FADEIN",e[e.FADEOUT=2]="FADEOUT",e[e.CIRCLE=3]="CIRCLE",e[e.SCALE=4]="SCALE",e[e.LANDSCAPE=5]="LANDSCAPE",e[e.PORTRAIT=6]="PORTRAIT",e[e.FLIP=7]="FLIP"})(n=o.SwitchEffect||(o.SwitchEffect={}));var s=[["normalShowIn","normalShowOut"],["fadeInShowIn","fadeInShowOut"],["fadeOutShowIn","fadeOutShowOut"],["circleShowIn","circleShowOut"],["scaleShowIn","scaleShowOut"],["landscapeShowIn","landscapeShowOut"],["portraitShowIn","portraitShowOut"],["flipShowIn","flipShowOut"]],c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.switchEffect=n.FADEIN,t.effectTime=.5,t.effectSpriteFrame=null,t._sceneName=null,t._effectNode=null,t._openUpdate=!1,t._curTime=0,t._curCallback=null,t._curEndCallback=null,t}return __extends(t,e),t.prototype.loadScene=function(e,t,o){this.node.zIndex=10,this._sceneName=e,this._callback=t,o&&(this.switchEffect=o),this.node.active=!0,this.showIn()},t.prototype.showIn=function(){this[s[this.switchEffect][0]]()},t.prototype.showOut=function(){this[s[this.switchEffect][1]]()},t.prototype._showInOver=function(){var e=this;cc.director.loadScene(this._sceneName,function(){e.showOut(),e._callback&&e._callback()})},t.prototype._showOutOver=function(){this.node.active=!1,this._sceneName=null,this._callback=null,this._effectNode&&(this._effectNode.removeFromParent(!0),this._effectNode.destroy(),this._effectNode=null)},t.prototype.normalShowIn=function(){this._showInOver()},t.prototype.normalShowOut=function(){this._showOutOver()},t.prototype._createFullSceneBg=function(){var e=new cc.Node("bg"),t=e.addComponent(cc.Sprite);t.spriteFrame=this.effectSpriteFrame,t.sizeMode=cc.Sprite.SizeMode.CUSTOM,e.zIndex=15,this.node.addChild(e);var o=cc.winSize;return e.width=o.width+5,e.height=o.height+5,e.color=cc.color(0,0,0),this._effectNode=e,e},t.prototype.fadeInShowIn=function(){var e=this;this._createFullSceneBg(),this._effectNode.opacity=0,this._effectNode.runAction(cc.sequence(cc.fadeIn(this.effectTime),cc.callFunc(function(t){e._effectNode.opacity=255,e._showInOver()})))},t.prototype.fadeInShowOut=function(){var e=this;this._effectNode.runAction(cc.sequence(cc.fadeOut(this.effectTime),cc.callFunc(function(t){e._effectNode.opacity=0,e._showOutOver()})))},t.prototype.fadeOutShowIn=function(){var e=this,t=cc.find("Canvas");t.runAction(cc.sequence(cc.fadeOut(this.effectTime),cc.callFunc(function(o){t.opacity=0,e._showInOver()})))},t.prototype.fadeOutShowOut=function(){var e=this,t=cc.find("Canvas");t.opacity=0,t.runAction(cc.sequence(cc.fadeIn(this.effectTime),cc.callFunc(function(o){t.opacity=255,e._showOutOver()})))},t.prototype._createMaskLayer=function(){var e=new cc.Node("mask"),t=e.addComponent(cc.Mask);this.node.addChild(e),t.inverted=!0,t.segements=100,this._effectNode=e;var o=new cc.Node("showNode"),n=o.addComponent(cc.Sprite);n.spriteFrame=this.effectSpriteFrame,n.sizeMode=cc.Sprite.SizeMode.CUSTOM,e.addChild(o);var i=cc.winSize;return o.width=i.width+5,o.height=i.height+5,o.color=cc.color(0,0,0),t},t.prototype.circleShowIn=function(){var e=this;this._createMaskLayer().type=1;var t=2*Math.sqrt(this.node.width/2*this.node.width/2+this.node.height/2*this.node.height/2);this._effectNode.width=this._effectNode.height=t,this._runUpdateAction(function(){var o=1-e._curTime/e.effectTime,n=(o<0?0:o)*t;e._effectNode.width=e._effectNode.height=n},function(){e._effectNode.width=e._effectNode.height=0,e._showInOver()})},t.prototype.circleShowOut=function(){var e=this,t=2*Math.sqrt(this.node.width/2*this.node.width/2+this.node.height/2*this.node.height/2);this._effectNode.width=this._effectNode.height=0,this._runUpdateAction(function(){var o=e._curTime/e.effectTime;e._effectNode.width=e._effectNode.height=o*t},function(){e._effectNode.width=e._effectNode.height=t,e._showOutOver()})},t.prototype.scaleShowIn=function(){var e=this,t=cc.find("Canvas");t.runAction(cc.sequence(cc.scaleTo(this.effectTime,0).easing(cc.easeBackIn()),cc.callFunc(function(o){t.scale=0,e._showInOver()})))},t.prototype.scaleShowOut=function(){var e=this,t=cc.find("Canvas");t.scale=0,t.runAction(cc.sequence(cc.scaleTo(this.effectTime,1).easing(cc.easeBackOut()),cc.callFunc(function(o){t.scale=1,e._showOutOver()})))},t.prototype.landscapeShowIn=function(){var e=this;this._createMaskLayer().type=0;var t=this.node.height;this._effectNode.width=this.node.width,this._effectNode.height=t,this._runUpdateAction(function(){var o=1-e._curTime/e.effectTime,n=(o<0?0:o)*t;e._effectNode.height=n},function(){e._effectNode.height=0,e._showInOver()})},t.prototype.landscapeShowOut=function(){var e=this,t=this.node.height;this._effectNode.height=0,this._runUpdateAction(function(){var o=e._curTime/e.effectTime,n=(o<0?0:o)*t;e._effectNode.height=n},function(){e._effectNode.height=t,e._showOutOver()})},t.prototype.portraitShowIn=function(){var e=this;this._createMaskLayer().type=0;var t=this.node.width;this._effectNode.width=t,this._effectNode.height=this.node.height,this._runUpdateAction(function(){var o=1-e._curTime/e.effectTime,n=(o<0?0:o)*t;e._effectNode.width=n},function(){e._effectNode.width=0,e._showInOver()})},t.prototype.portraitShowOut=function(){var e=this,t=this.node.width;this._effectNode.width=0,this._runUpdateAction(function(){var o=e._curTime/e.effectTime,n=(o<0?0:o)*t;e._effectNode.width=n},function(){e._effectNode.width=t,e._showOutOver()})},t.prototype.flipShowIn=function(){var e=this,t=cc.find("Canvas");t.runAction(cc.sequence(cc.scaleTo(this.effectTime,0,1).easing(cc.easeIn(.5)),cc.callFunc(function(o){t.scaleX=0,e._showInOver()})))},t.prototype.flipShowOut=function(){var e=this,t=cc.find("Canvas");t.scaleX=0,t.runAction(cc.sequence(cc.scaleTo(this.effectTime,1,1).easing(cc.easeOut(.5)),cc.callFunc(function(o){t.scale=1,e._showOutOver()})))},t.prototype._runUpdateAction=function(e,t){this._curCallback=e,this._curEndCallback=t,this._openUpdate=!0},t.prototype.update=function(e){this._openUpdate&&(this._curTime>this.effectTime?(this._curTime=0,this._openUpdate=!1,this._curEndCallback()):(this._curTime+=e,this._curCallback()))},__decorate([r({type:cc.Enum(n),tooltip:"\u5207\u6362\u6548\u679c"})],t.prototype,"switchEffect",void 0),__decorate([r({tooltip:"\u52a8\u753b\u65f6\u95f4"})],t.prototype,"effectTime",void 0),__decorate([r({type:cc.SpriteFrame,tooltip:"\u52a8\u753b\u56fe\u7247"})],t.prototype,"effectSpriteFrame",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],TaskStackHandler:[function(e,t,o){"use strict";cc._RF.push(t,"0a7498D+BZLarrP1gYjvgs2","TaskStackHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){this._name=e,this.taskMap=new Map}return e.prototype.addTask=function(e,t,o,n,i){void 0===o&&(o=[]),void 0===n&&(n=0),void 0===i&&(i=0),this.taskMap.get(e)||this.taskMap.set(e,{fun:t,args:o,delay:n,order:i})},e.prototype.removeTask=function(e){this.taskMap.delete(e)},e.prototype.cleanTask=function(){this.taskMap.clear()},e.prototype.getTaskNum=function(){return this.taskMap.size},e.prototype.executeTask=function(){var e=this;if(0!==this.taskMap.size)var t=Array.from(this.taskMap).sort(function(e,t){return e[1].order-t[1].order})[0][0],o=this.taskMap.get(t),n=o.delay,i=setTimeout(function(a){console.log(e._name+": \u5ef6\u65f6"+n+"\u79d2\uff0c"+t+" \u6267\u884c"),e.curTaskName=t,o.fun&&o.fun.apply(o,o.args),clearTimeout(i)},1e3*n)},e.prototype.completeTask=function(e){return this.curTaskName!==e?(cc.log("\u4e0d\u662f\u5f53\u524d\u8fdb\u884c\u4efb\u52a1:"+this._name+"---"+e),this.taskMap.size):this.taskMap.has(e)?(console.log(this._name+": "+e+" \u5b8c\u6210"),this.removeTask(e),0===this.taskMap.size?(console.log("TaskStack"+this._name+"\u5168\u90e8\u5b8c\u6210"),0):(this.executeTask(),this.taskMap.size)):this.taskMap.size},e}(),i=function(){function e(){}return e.createTask=function(e,t){void 0===t&&(t=[]);for(var o=new n(e),i=0,a=t;i<a.length;i++){var r=a[i],s=r.name,c=r.callback,l=r.args,u=r.delay||0,h=r.order||0;o.addTask(s,c,l,u,h)}return this.taskStackMap.set(e,o),o},e.getTask=function(e){return this.taskStackMap.has(e)?this.taskStackMap.get(e):(cc.log("TaskStack "+e+"\u4e0d\u5b58\u5728"),null)},e.addTask=function(e,t){var o=this.getTask(e);if(o){var n=t.name,i=t.callback,a=t.args||[],r=t.delay||0,s=t.order||0;o.addTask(n,i,a,r,s),1===o.getTaskNum()&&this.executeTask(e)}},e.executeTask=function(e){var t=this.getTask(e);t&&t.executeTask()},e.completeTask=function(e,t){var o=this.getTask(e);if(o)return o.completeTask(t||o.curTaskName)},e.deleteTask=function(e){this.taskStackMap.delete(e)},e.taskStackMap=new Map,e}();o.TaskStackHandler=i,cc._RF.pop()},{}],TestPanel:[function(e,t,o){"use strict";cc._RF.push(t,"ca5deU7DPtHO6J11XoO1zgw","TestPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=e("../../data/GameHandler"),a=e("../../common/Common"),r=e("../../submodule/utils/EventCenter"),s=e("../../common/Define"),c=e("../GameManager"),l=e("../../data/ServerHandler"),u=e("../logic/GameLayer"),h=e("../../data/HonorHandler"),d=cc._decorator,p=d.ccclass,f=d.property,_=2,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layouts=[],t}return __extends(t,e),t.prototype.start=function(){for(var e=0,t=this.layouts;e<t.length;e++){t[e].enabled=!1}this.node.zIndex=1e4},t.prototype.buttonCallback=function(e,t){var o=cc.find("Canvas").getComponent(c.default).gameLayer,n=e.target;switch(t){case"close_box":n.parent.active=!1,n.parent.zIndex=0;break;case"addPropChange":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");i.default.propChangeCount=WxSDK.prop_change_count,a.Common.toastCode("prop_change_get",WxSDK.prop_change_count),r.default.post(s.EventMsg.PROP_CHANGE_CHANGE);break;case"addPropCrash":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");i.default.propCrashCount=WxSDK.prop_crash_count,a.Common.toastCode("prop_crash_get",WxSDK.prop_crash_count),r.default.post(s.EventMsg.PROP_CRASH_CHANGE);break;case"propChange":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");o.cleanBottomShapes(),o.makeBottomShapes();break;case"gameOver":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");o.gameOver();break;case"submitScore":this.checkEditor(n).then(function(e){var t=Number(e);i.default.checkIsNewRecord(t)},function(){});break;case"modifyScore":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");this.checkEditor(n).then(function(e){var t=Number(e);o.score=t,o.showScore=t},function(){});break;case"cleanRank":WxSDK.cleanRankData(WxSDK.bestScore);break;case"showScoreEffect":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");o.gameUI.showScoreEffect(_),++_>6&&(_=2);break;case"cleanStorage":l.default.cleanServerData(function(){"undefined"!=typeof wx?wx.exitMiniProgram():cc.game.end()});break;case"openHonor":a.Common.popPanel({name:"panel/honorPanel"});break;case"addMission1":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addCrash1Time(t)},function(){});break;case"addMission2":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addCrash2Time(t)},function(){});break;case"addMission3":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addCrash3Time(t)},function(){});break;case"addMission4":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addCrash4Time(t)},function(){});break;case"addMission5":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addCrash5Time(t)},function(){});break;case"addMission6":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addCrash6Time(t)},function(){});break;case"addMission7":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addVideoTime(t)},function(){});break;case"addMission8":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addShareTime(t)},function(){});break;case"addOther":this.checkEditor(n).then(function(e){var t=Number(e);h.default.addOtherExp(t)},function(){});break;case"showUpgrade":this.checkEditor(n).then(function(e){r.default.post(s.EventMsg.SHOW_UPGRADE,Number(e))},function(){});break;case"makeShape":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");this.checkEditor(n).then(function(e){o.testMakeShape(Number(e))},function(){});break;case"popPddCoupon":pddSDK.checkShowCoupon(600),a.Common.popPanel({name:"panel/pddCouponPanel"});break;case"makeProp":if(o.gameState!==u.GameState.GAME)return void a.Common.toast("\u8c03\u7528\u5931\u8d25!");o.checkMakeProp(1)||a.Common.toast("\u6761\u4ef6\u4e0d\u8db3")}},t.prototype.checkEditor=function(e){var t=e.getChildByName("editor").getComponent(cc.EditBox);return new Promise(function(o,n){t.node.active?""===t.string?(a.Common.toast("\u8bf7\u8f93\u5165\u5f97\u5206"),n()):o(t.string):(t.node.active=!0,t.string="",e.zIndex=5,n())})},__decorate([f([cc.Layout])],t.prototype,"layouts",void 0),t=__decorate([p],t)}(n.default);o.default=g,cc._RF.pop()},{"../../common/Common":"Common","../../common/Define":"Define","../../data/GameHandler":"GameHandler","../../data/HonorHandler":"HonorHandler","../../data/ServerHandler":"ServerHandler","../../submodule/component/PopLayerBase":"PopLayerBase","../../submodule/utils/EventCenter":"EventCenter","../GameManager":"GameManager","../logic/GameLayer":"GameLayer"}],TipsPanel:[function(e,t,o){"use strict";cc._RF.push(t,"d70309VDUtGz6cFtbBH+3oW","TipsPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../submodule/component/PopLayerBase"),i=cc._decorator,a=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textLabel=null,t.sureButton=null,t.cancelButton=null,t}return __extends(t,e),t.prototype.init=function(e){this.textLabel.string=e.text||"",this.cancelButton.active=e.showCancel,this.sureButton.on("touchend",function(){e.confirm&&e.confirm()},this),this.cancelButton.on("touchend",function(){},this)},t.prototype.buttonCallback=function(e,t){t},__decorate([r(cc.Label)],t.prototype,"textLabel",void 0),__decorate([r(cc.Node)],t.prototype,"sureButton",void 0),__decorate([r(cc.Node)],t.prototype,"cancelButton",void 0),t=__decorate([a],t)}(n.default);o.default=s,cc._RF.pop()},{"../../submodule/component/PopLayerBase":"PopLayerBase"}],ToastBase:[function(e,t,o){"use strict";cc._RF.push(t,"c9bd5KdNnVI1L7oe+GzigS1","ToastBase"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=cc._decorator,a=i.ccclass,r=i.property;(function(e){e[e.NONE=0]="NONE",e[e.SCALE=1]="SCALE",e[e.FADE_UP=2]="FADE_UP",e[e.TOP_DOWN=3]="TOP_DOWN",e[e.BOTTOM_UP=4]="BOTTOM_UP"})(n=o.ToastType||(o.ToastType={}));var s=[["_noneShow"],["_scaleShow"],["_fadeUpShow"]],c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toastType=n.SCALE,t.waitTime=1,t.toastLabel=null,t._toastType=null,t._waitTime=0,t}return __extends(t,e),t.prototype.show=function(e,t,o){this._waitTime=t||this.waitTime,this._toastType=o||this.toastType,this.node.active=!0,this.toastLabel.string=e,this.node.stopAllActions(),this.showAction()},t.prototype.hide=function(){this.node.active=!1},t.prototype.showAction=function(){this.node.stopAllActions(),this[s[this._toastType][0]]()},t.prototype._noneShow=function(){this.node.opacity=255,this.node.runAction(cc.sequence(cc.delayTime(this._waitTime),cc.fadeOut(.4),cc.callFunc(function(e){e.active=!1,e.removeSelf()})))},t.prototype._scaleShow=function(){this.node.opacity=255,this.node.scale=0,this.node.runAction(cc.sequence(cc.scaleTo(.25,1).easing(cc.easeElasticOut(.6)),cc.delayTime(this._waitTime),cc.fadeOut(.4),cc.callFunc(function(e){e.active=!1,e.removeSelf()})))},t.prototype._fadeUpShow=function(){this.node.opacity=255,this.node.y=-100,this.node.runAction(cc.sequence(cc.delayTime(this.waitTime),cc.moveBy(.86,0,250),cc.spawn(cc.moveBy(.43,0,125),cc.fadeOut(.43)),cc.callFunc(function(e){e.active=!1,e.removeSelf()})))},__decorate([r({type:cc.Enum(n),tooltip:"\u5f39\u51fa\u7c7b\u578b"})],t.prototype,"toastType",void 0),__decorate([r({tooltip:"\u52a8\u753b\u65f6\u95f4"})],t.prototype,"waitTime",void 0),__decorate([r(cc.Label)],t.prototype,"toastLabel",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],UnAutoGreyButton:[function(e,t,o){"use strict";cc._RF.push(t,"d3ba2dPCbNGDLxBeXDpqoJK","UnAutoGreyButton"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._updateDisabledState=function(){},t=__decorate([i],t)}(cc.Button));o.default=a,cc._RF.pop()},{}],UnitBase:[function(e,t,o){"use strict";cc._RF.push(t,"5e150fqFn9LLK5mvvPL8XNo","UnitBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/EventCenter"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.manager=null,t}return __extends(t,e),t.prototype.onDestroy=function(){n.default.removeRegister(this)},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../utils/EventCenter":"EventCenter"}],UserInfoBtn:[function(e,t,o){"use strict";cc._RF.push(t,"dbbd2fojPtAkbkYWifN37zt","UserInfoBtn");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("WxBtn"));var i=e("sdk");cc.Class({extends:n.default,properties:{showOnLoad:!0,successFunc:{default:null,visible:!1},failFunc:{default:null,visible:!1}},setNormalMode:function(e){this._normalCallback=e,e?this._wxBtn&&this._wxBtn.hide():this._wxBtn&&this._wxBtn.show()},onClick:function(){var e=this;this._normalCallback?this._normalCallback():this._wxBtn||this._getUserInfo(function(t){e.successFunc&&e.successFunc(t)},function(t){e.failFunc&&e.failFunc(t)})},_getUserInfo:function(e,t){console.log("\u4f7f\u7528getUserInfo\u83b7\u53d6\u7528\u6237\u4fe1\u606f"),i.getUserInfoForce(function(t){console.log("getUserInfo\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u6210\u529f, res:",t),e&&e(t)},function(e){console.log("getUserInfo\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25, res:",e),t&&t(e)})},_createWxBtn:function(){var e=this;window.wx&&"function"==typeof window.wx.createUserInfoButton&&(this._wxBtn=window.wx.createUserInfoButton({type:"text",text:" ",style:{backgroundColor:"#00000001",color:"#00000001",fontSize:1},withCredentials:!0,lang:"zh_CN"}),this._tapCallback=function(t){console.log("\u4f7f\u7528UserInfoButton\u83b7\u53d6\u7528\u6237\u4fe1\u606f: ",t),t.errMsg.indexOf("auth deny")>-1||t.errMsg.indexOf("auth denied")>-1?(console.log("\u4f7f\u7528UserInfoButton\u83b7\u53d6\u7528\u6237\u4fe1\u606f, \u6388\u6743\u5931\u8d25!"),e.failFunc&&e.failFunc(t)):(console.log("\u4f7f\u7528UserInfoButton\u83b7\u53d6\u7528\u6237\u4fe1\u606f, \u6388\u6743\u6210\u529f!"),e.successFunc&&e.successFunc(t))},this._wxBtn&&(this.showOnLoad?this.showWxBtn():this._wxBtn.hide()))},showWxBtn:function(){this._normalCallback||(this._wxBtn&&this._wxBtn.show(),this.resizeButton())},onLoad:function(){this.node.on("touchend",this.onClick,this),n.default.prototype.onLoad.call(this)},onDestroy:function(){this.node.off("touchend",this.onClick,this),n.default.prototype.onDestroy.call(this)},onEnable:function(){this._normalCallback||n.default.prototype.onEnable.call(this)}}),cc._RF.pop()},{WxBtn:"WxBtn",sdk:"sdk"}],WxBtn:[function(e,t,o){"use strict";cc._RF.push(t,"d0d09zbB2dB/5+gbVVOQC93","WxBtn"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("sdk");n.convertToWxRect=function(e){var t=e.convertToWorldSpaceAR(cc.v2(0,0)),o=cc.view.getVisibleSize(),n=t.x-e.width*e.anchorX,i=o.height-t.y-e.height*(1-e.anchorY),a=wx.getSystemInfoSync(),r=a.screenWidth,s=a.screenHeight;return{left:n/o.width*r,top:i/o.height*s,width:e.width/o.width*r,height:e.height/o.height*s}};var i=cc.Class({extends:cc.Component,properties:{_wxBtn:null,_tapCallback:null},onLoad:function(){this.getComponent(cc.Widget)&&this.getComponent(cc.Widget).updateAlignment(),this.node.on("position-changed",this.resizeButton,this),this.node.on("size-changed",this.resizeButton,this),this._createWxBtn(),this._addBtnCallback()},onDestroy:function(){this.node.off("position-changed",this.resizeButton,this),this.node.off("size-changed",this.resizeButton,this),this._wxBtn&&(this._wxBtn.destroy(),this._wxBtn=null)},onEnable:function(){this._wxBtn&&this._wxBtn.show()},onDisable:function(){this._wxBtn&&this._wxBtn.hide()},resizeButton:function(){if(this._wxBtn){var e=this._wxBtn,t=n.convertToWxRect(this.node),o=t.left,i=t.top,a=t.width,r=t.height;e.style.left=o,e.style.top=i,e.style.width=a,e.style.height=r}},_createWxBtn:function(){},_addBtnCallback:function(){var e=this;this._wxBtn&&"function"==typeof this._wxBtn.onTap&&this._wxBtn.onTap(function(t){e._tapCallback&&e._tapCallback(t)})}});o.default=i,t.exports=o.default,cc._RF.pop()},{sdk:"sdk"}],"WxSDK+Controller":[function(e,t,o){"use strict";cc._RF.push(t,"1ee63eI9ONMZbfuj+sx1joT","WxSDK+Controller");var n=c(e("StorageUtils")),i=c(e("EventCenter")),a=e("Define"),r=e("Common"),s=e("PP");function c(e){return e&&e.__esModule?e:{default:e}}var l=e("WxSDK"),u=e("sdk");window.TermType={SHARE:0,VIDEO:1,FREE:2},l._shareCount=n.default.getItemInt("shareCount",0),l._level=0,Object.defineProperties(l,{level:{get:function(){return this._level},set:function(e){this._level=e,i.default.post(a.EventMsg.ON_LIMIT_CHANGE,this._level)}},shareCount:{get:function(){return this._shareCount},set:function(e){this._shareCount=e,n.default.setItem("shareCount",e)}},lastShareCount:{get:function(){return l.day_share_count-this.shareCount}}});var h={share_flag:{default:-1,use_local:!1},share_limit_num:{default:-1,use_local:!1},day_share_count:{default:10,use_local:!1},share_chance:{default:50,use_local:!1},fake_share_gap:{default:2,use_local:!1},fake_share_fail_ratio:{default:"50",use_local:!1},fake_share_fail_ratio_list:{default:50,use_local:!1},share_group_toast:{default:"\u8fd9\u4e2a\u7fa4\u4eca\u5929\u5df2\u7ecf\u5206\u4eab\u8fc7\u4e86",use_local:!1},share_time_toast:{default:"\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u6362\u4e2a\u7fa4\u5206\u4eab",use_local:!1},button_fade_time:{default:500,use_local:!1},button_load_time:{default:500,use_local:!1},button_move_time:{default:1e3,use_local:!1},pop_share_again:{default:1,use_local:!1},pop_share_msg:{default:"\u60a8\u53d6\u6d88\u4e86\u5206\u4eab,\u8bf7\u5206\u4eab\u5230\u7fa4",use_local:!1},share_use_cancel:{default:-1,use_local:!1},thanks_show_type:{default:0,use_local:!1},insideAds_refresh_time:{default:60,use_local:!1},pdd_toggle:{default:-1,use_local:!1},pdd_goods_change_time:{default:4,use_local:!1},pdd_limit_score:{default:500,use_local:!1},pdd_show_chance:{default:5,use_local:!1},pdd_show_time_day:{default:10,use_local:!1},ppd_pop_time_day:{default:20,use_local:!1},pdd_pid:{default:"",use_local:!1},pdd_honor_addition:{default:2,use_local:!1},pdd_refresh_duration:{default:3,use_local:!1},prop_change_time:{default:6,use_local:!0},prop_crash_time:{default:2,use_local:!0},revive_time:{default:1,use_local:!1},revive_wait_time:{default:5,use_local:!1},easy_time:{default:3,use_local:!1},special_prop_chance:{default:5,use_local:!1},special_prop_max:{default:2,use_local:!1},special_prop_show_limit:{default:250,use_local:!1},prop_change_count:{default:3,use_local:!0},prop_crash_count:{default:1,use_local:!0},shortcut_limit:{default:0,use_local:!1},shortcut_reward:{default:30,use_local:!1},shortcut_pop_limit:{default:250,use_local:!1}};function d(e){var t=Number(e);return isNaN(t)?e:t}for(var p in l.getTimeDuration=function(e,t,o){if(e>0&&"string"==typeof t){var n=new Date(e).toDateString(),i=new Date(e).getTime(),a=new Date(e).getDay(),r=t.split("-"),s=o.split(",");if(0===a&&(a=7),s.indexOf(String(a))>=0)return console.log("\u4eca\u5929\u662f\u4f11\u606f\u65e5!"),!1;var c=new Date(n+" "+r[0]).getTime(),l=new Date(n+" "+r[1]).getTime();if(i>=c&&i<=l)return!0}return!1},h)l[p]=h[p].default;l.checkRemoteConfig=(u.onRemoteLoaded=function(e){for(var t in h)if(!h[t].use_local&&e&&e[t]){var o=d(e[t]);l[t]=o,u[t]=o}i.default.post(a.EventMsg.ON_CONFIG_LOADED)},void(u.onFirstConfigComplete=function(){console.log("\u7b2c\u4e00\u6b21\u62c9\u53d6\u914d\u7f6e:"),l.checkNeedAuthList()}));var f=!1;l.termCheck=function(e,t,o){window.wx?e?e.type===TermType.VIDEO?l.showVideo(function(n){n?(i.default.post(a.EventMsg.ON_VIDEO_COMPLETE),t&&t(e)):o&&o(e)}):e.type===TermType.SHARE?(i.default.post(a.EventMsg.GO_TO_SHARE,e.pos_id),this._shareLogic(e,t,o)):e.type===TermType.FREE&&t&&t(e):r.Common.toast("\u89c6\u9891\u672a\u51c6\u5907"):t&&t(e)},l._shareLogic=function(e,t,o){var n=this,i=e.pos_id;f=!1,l.specialShare(i,null,null,null,function(){console.log("\u7528\u6237\u53d6\u6d88\u4e86\u5206\u4eab"),l.share_use_cancel>-1&&(f=!0)});this.fakeShareCallback("fakeShare",e,function(){n.shareCount++,t&&t(e)},function(){o&&o(e)})};var _=0;l.fakeShareCallback=function(e,t,o,n){var r=(new Date).getTime();u.onShow(e,function(s){u.offShow(e);var c=((new Date).getTime()-r)/1e3;console.log("sid:",e,"duration:",c,"fake_share_gap:",l.fake_share_gap);var h=!0;c>=l.fake_share_gap&&(h=!1),setTimeout(function(){function e(e){console.log("showModal:",l.pop_share_again,e),1===l.pop_share_again?wx.showModal({title:"",content:l[e],showCancel:!0,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",success:function(e){e.confirm?l._shareLogic(t,o,n):e.cancel&&(console.log("\u53d6\u6d88\u5206\u4eab"),i.default.post(a.EventMsg.CANCEL_SHARE,t.pos_id),n&&n())}}):l.backToast(e)}if(console.log("timeInvalid:",h,"shareCancelled:",f),f)e("pop_share_msg");else if(h)e("share_time_toast");else{var r=String(l.fake_share_fail_ratio_list).split(","),s=r[Math.min(_,r.length-1)],c=100*Math.random();console.log("\u5206\u4eab\u56de\u8c03: \u91cd\u590d\u6982\u7387\u968f\u673a: "+c+", \u53d6\u503c: "+s),c<s?(console.log("\u91cd\u590d\u7fa4\uff01"),e("share_group_toast"),++_):(i.default.post(a.EventMsg.ON_SHARE_COMPLETE),o&&o(),_=0)}},100)},-1)},l.termCheck2=function(e,t,o){window.wx||o&&o(),null!==t?t.type===TermType.VIDEO?l.showVideo(function(e){e?o&&o(check):r.Common.toast("\u9700\u8981\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u53ef\u4ee5\u9886\u53d6\u54e6!")}):t.type===TermType.SHARE&&(l.cardShare(),l.backToast("share_tip_toast",2,.5)):r.Common.toast("\u89c6\u9891\u672a\u51c6\u5907")},l.checkToggle=function(e){return!window.wx||(l[e]&&l[e]>0?(console.log(e+"\u5df2\u5f00\u542f"),!0):(console.log(e+"\u5df2\u5173\u95ed"),!1))},l.checkLimitTerm=function(e){return l[e]>=0&&this.level>=l[e]?(console.log(e+"\u8fbe\u5230\u53ef\u542f\u7528\u7b49\u7ea7\uff1a",this.level,l[e]),!0):(console.log(e+"\u672a\u8fbe\u5230\u53ef\u542f\u7528\u7b49\u7ea7\uff1a",this.level,l[e]),!1)},l._checkDiffGroupTerm=function(){return!0},l._checkDiffGroupNumEnough=function(){var e=n.default.getData("groupids",[]);return l.diffgroup_count&&l.diffgroup_count>0&&e.length>=l.diffgroup_count?(console.log("\u5b8c\u6210\u7fa4\u5206\u4eab\u4efb\u52a1\uff0c\u53ef\u5206\u4eab\u91cd\u590d\u7fa4\uff1a",e.length,l.diffgroup_count),!0):(console.log("\u672a\u5b8c\u6210\u7fa4\u5206\u4eab\u4efb\u52a1\uff0c\u9700\u5206\u4eab\u4e0d\u540c\u7fa4\uff1a",e.length,l.diffgroup_count),!1)},l.shareOrVideo=function(e,t){t=t||"share_limit_num";var o=this.hasShare(t),n=u.hasVideo();return console.log("\u6709\u65e0\u89c6\u9891:",!!n,"\u6709\u65e0\u5206\u4eab:",o),o&&n?Math.getRandom(0,100)<l.share_chance?(console.log("\u968f\u5230\u5206\u4eab"),_=0,{result:!0,type:TermType.SHARE,pos_id:e,sid:s.pp.getRandomStr()}):(console.log("\u968f\u5230\u89c6\u9891"),{result:!0,type:TermType.VIDEO,pos_id:e}):o||n?o?(console.log("\u53ea\u6709\u5206\u4eab"),_=0,{result:!0,type:TermType.SHARE,pos_id:e,sid:s.pp.getRandomStr()}):(console.log("\u53ea\u6709\u89c6\u9891"),{result:!0,type:TermType.VIDEO,pos_id:e}):null},l.videoFirst=function(e,t){return u.hasVideo()?(console.log("\u5b58\u5728\u89c6\u9891,\u4f18\u5148\u89c6\u9891"),{result:!0,type:TermType.VIDEO,pos_id:e}):(console.log("\u4e0d\u5b58\u5728\u89c6\u9891"),this.hasShare(t)?(console.log("\u5b58\u5728\u5206\u4eab,\u6267\u884c\u5206\u4eab"),_=0,{result:!0,type:TermType.SHARE,pos_id:e,sid:s.pp.getRandomStr()}):(console.log("\u4e0d\u5b58\u5728\u5206\u4eab"),null))},l.hasShare=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"share_limit_num";if(-1===l.share_flag)return!1;if(l[e]>=0&&this.level>=l[e]){if(console.log(e+"\u8fbe\u5230\u53ef\u5206\u4eab\u7b49\u7ea7\uff1a",this.level,l[e]),l.day_share_count>0&&this.lastShareCount>0)return console.log("\u53ef\u4ee5\u5206\u4eab***\u603b\u5206\u4eab\u6b21\u6570:",l.day_share_count,"\u5269\u4f59\u5206\u4eab\u6b21\u6570:",this.lastShareCount),!0;console.log("\u4e0d\u53ef\u5206\u4eab***\u603b\u5206\u4eab\u6b21\u6570:",l.day_share_count,"\u5269\u4f59\u5206\u4eab\u6b21\u6570:",this.lastShareCount)}else console.log(e+"\u672a\u8fbe\u5230\u53ef\u5206\u4eab\u7b49\u7ea7\uff1a",this.level,l[e]);return!1},l.hasReward=function(){return this.hasShare()||this.hasVideo()},l.getReward=function(e,t){return e===TermType.VIDEO?{result:!0,type:e,pos_id:t}:e===TermType.SHARE?{result:!0,type:e,pos_id:t}:void 0},l.backToast=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;-1!==e&&r.Common.delayToast(l[e],2,t)},l.checkShareGroupTerm=function(e,t){var o=this;void 0===e.shareTickets?this.backToast("sharePersonal_fail_toast"):this._checkDiffGroupTerm()&&!this._checkDiffGroupNumEnough()?Server.wxLogin(function(n){var i=n.code;i?wx.getShareInfo({shareTicket:e.shareTickets[0],success:function(e){console.log("\u83b7\u53d6\u7fa4\u6570\u636e\u6210\u529f: ",e),Server.getGroupID(i,e,function(e){0===(0===e?0:o.isValidGroupId(e))?t&&t():o.backToast("shareGroup_fail_toast")},function(e){r.Common.toast(l.shareResultErr.err6)})},fail:function(e){console.log("\u83b7\u53d6\u7fa4\u6570\u636e\u5931\u8d25: ",e),r.Common.toast(l.shareResultErr.err6)}}):(console.log("\u4e0d\u9700\u8981\u89e3\u5bc6\u7fa4ID,\u65e0code"),t&&t())}):(console.log("\u4e0d\u9700\u8981\u89e3\u5bc6\u7fa4ID,\u53ef\u91cd\u590d\u5206\u4eab"),t&&t())},l.isValidGroupId=function(e){var t=n.default.getData("groupids",[]);return-1===t.indexOf(e)?(t.push(e),n.default.setData("groupids",t),0):(console.log("\u5206\u4eab\u7684\u65f6\u540c\u4e00\u4e2a\u7fa4"),u.diffgroup_count-t.length)},l.onShowEventList=[],l.checkShow=function(){var e=this;u.onShow("onShowEvent",function(t){console.log("onShowEvent",t);var o=t.query;if(o&&o.position_id){var n={flag:"share"};switch(parseInt(o.position_id)){case SharePos.GROUP:n.type=SharePos.GROUP,n.shareTicket=t.shareTicket,e.onShowEventList.push(n);break;case SharePos.CARD:n.type=SharePos.CARD,n.query=o,e.onShowEventList.push(n)}console.log("\u7edf\u8ba1 "),console.log("res.query.position_id = ",t.query.position_id),console.log("res.query.share_id = ",t.query.share_id),u.shareStat(t.query.position_id,t.query.share_id)}t&&t.query&&"gift"===t.query.service&&e.onShowEventList.push({flag:"serviceGift",date:t.query.serviceDate});var r=t.scene;if(1023===r||1104===r){console.log("\u4ece\u684c\u9762\u6216\u5c0f\u7a0b\u5e8f\u8fdb\u5165");e.onShowEventList.push({flag:"shortcut"})}console.log("\u540e\u53f0\u4e8b\u4ef6\u6570\u7ec4:",e.onShowEventList),i.default.post(a.EventMsg.ON_SHOW,e.onShowEventList)})},l.checkShow(),cc._RF.pop()},{Common:"Common",Define:"Define",EventCenter:"EventCenter",PP:"PP",StorageUtils:"StorageUtils",WxSDK:"WxSDK",sdk:"sdk"}],"WxSDK+Post":[function(e,t,o){"use strict";cc._RF.push(t,"50fe5/WfXVFjqmO2UFs7AOQ","WxSDK+Post");var n=e("WxSDK"),i=e("sdk"),a=0,r=1,s=2,c=3,l=4,u=5,h=6,d=7,p=8,f=9,_=10,g=11,v=12,m=101;window.SubViewType={FRIEND_RANK:0,GROUP_RANK:1,GROUP_SHARE_RANK:2,RESULT_RANK:3,OVER_STEP:4,OVER_STEP_HORIZONTAL:5},n.postMessage=function(e,t){i.subMsg(e,t)},n.cleanRankData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.bestScore;this.postMessage({messageType:v,MAIN_MENU_NUM:e})},n.cleanRank=function(){this.postMessage({messageType:a})},n.refreshRank=function(){this.postMessage({messageType:p})},n.refreshUserInfo=function(){this.postMessage({messageType:f})},n.fetchRank=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.bestScore;this.postMessage({messageType:g,MAIN_MENU_NUM:e})},n.getFriendRank=function(e){this.postMessage({messageType:r,MAIN_MENU_NUM:e})},n.postChangePage=function(e){this.postMessage({messageType:s,dir:e})},n.getGroupRankList=function(e,t){this.postMessage({messageType:u,MAIN_MENU_NUM:e,shareTicket:t})},n.getOverStepData=function(e,t){this.postMessage({messageType:h,MAIN_MENU_NUM:e,gameStep:t,type:1})},n.getOverStepHorizontalData=function(e,t){var o=t.gameStep,n=t.showType;this.postMessage({messageType:d,MAIN_MENU_NUM:e,gameStep:o,showType:n})},n.getGroupFriendRank=function(e,t){var o=this;console.log("\u83b7\u53d6\u7fa4\u6392\u884c"),void 0!==window.wx?this._groupShare(function(n){console.log("group:",n),void 0!==n.shareTickets&&n.shareTickets.length>0&&(o.getGroupRankList(e,n.shareTickets[0]),t&&t(n.shareTickets[0]))}):console.log("\u5206\u4eab\u5e76\u83b7\u53d6\u7fa4\u6392\u884c")},n.getHorizontalRank=function(e){this.postMessage({messageType:l,MAIN_MENU_NUM:e})},n.postCloseWindow=function(e){this.postMessage({messageType:_,windowType:e})},n.submitScore=function(e,t){e.bscore=JSON.stringify({wxgame:{score:t,update_time:Math.floor((new Date).getTime()/1e3)}}),this.postMessage({messageType:c,data:e})},n.resizeTouch=function(e){this.postMessage({messageType:m,data:e})},cc._RF.pop()},{WxSDK:"WxSDK",sdk:"sdk"}],"WxSDK+Reprot":[function(e,t,o){"use strict";cc._RF.push(t,"a3ad3osNH5O4qwgfmD8/i6X","WxSDK+Reprot");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("EventCenter")),i=e("Define"),a=e("PP");var r=e("WxSDK"),s=e("Server");console.log(s);var c=e("sdk");r.reportAppid=function(e){if("undefined"!=typeof wx){var t=wx.getLaunchOptionsSync();console.log("launchOptions == ",t);var o="",n="";t.referrerInfo&&t.referrerInfo.appId&&(o=t.referrerInfo.appId),t.query&&t.query.cid&&(n=t.query.cid),s.reportAppid(o,n,e)}},r.reportAppid(0),r.needAuth="undefined"==typeof wx?0:-1,r.checkNeedAuthList=function(){var e=a.pp.checkPropertiesList(c,"data","conf","authflag");this.needAuth=1===parseInt(e)?1:0,n.default.post(i.EventMsg.GET_AUTHLIST_OVER,this.needAuth),console.log("\u4e0b\u53d1needAuth######:",this.needAuth)},r.getPlatform=function(){if(!c._checkWx(null,null,"getSystemInfoSync"))return"";var e=wx.getSystemInfoSync();if(e&&e.platform&&"string"==typeof e.platform){var t=e.platform.toLowerCase();return"android"!==t&&"ios"!==t&&(t=""),t}return""},r.reportEvent=function(e){if(e){var t=e.tag,o=e.page;console.log("\u4e0a\u62a5\u4e8b\u4ef6\uff1a",t,o),window.wx&&s.reportClick(t,o)}},r.ReportMsg={SHOW_VIDEO_10:{tag:"SHOW_VIDEO_10",page:"index"},POP_COUPON:{tag:"POP_COUPON",page:"index"},OPEN_COUPON_VIDEO:{tag:"OPEN_COUPON_VIDEO",page:"index"},OPEN_COUPON_SHARE:{tag:"OPEN_COUPON_SHARE",page:"index"},SHOW_COUPON_INFO:{tag:"SHOW_COUPON_INFO",page:"index"},TO_PDD_MINI_WX:{tag:"TO_PDD_MINI_WX",page:"index"},NEW_250:{tag:"new250",page:"index"},SERVICE_GIFT:{tag:"servicegift",page:"index"},GO_SERVICE:{tag:"goservice",page:"index"},INTO_GAME:{tag:"intogame",page:"index"},INTO_PROGRAM:{tag:"intoprogram",page:"index"},GAMEBOX_SHOW:{tag:"gameboxshow",page:"index"},GAMEBOX_HIDE:{tag:"gameboxhide",page:"index"},SHORTCUT_TOUCH:{tag:"shortcuttouch",page:"index"},SHORTCUT:{tag:"shortcut",page:"index"},CHECK_AGAIN_TOUCH:{tag:"checkagaintouch",page:"index"},CHECK_AGAIN_VIDEO:{tag:"checkagainvideo",page:"index"},CHECK_AGAIN_SHARE:{tag:"checkagainshare",page:"index"},CHECK_CLOSE:{tag:"checkclose",page:"index"},CHECK_IN:{tag:"checkin",page:"index"},CHECK_IN_TOUCH:{tag:"checkintouch",page:"index"}},r.reportEvent(r.ReportMsg.INTO_PROGRAM),cc._RF.pop()},{Define:"Define",EventCenter:"EventCenter",PP:"PP",Server:"Server",WxSDK:"WxSDK",sdk:"sdk"}],"WxSDK+Share":[function(e,t,o){"use strict";cc._RF.push(t,"5e4416qZVtC+Zwd1rH7X8Ih","WxSDK+Share");(function(e){e&&e.__esModule})(e("EventCenter")),e("../common/Define");var n=e("WxSDK"),i=e("sdk");n.shareResultErr={err1:"\u9700\u8981\u4ece\u7fa4\u91cc\u9886\u53d6\u54e6",err2:"\u5feb\u53bb\u548c\u66f4\u591a\u597d\u53cb\u4ea4\u6d41\u54e6",err3:"\u5feb\u53bb\u548c\u66f4\u591a\u597d\u53cb\u4ea4\u6d41\u54e6!",err4:"\u8fd9\u4e2a\u7fa4\u5df2\u7ecf\u5206\u4eab\u8fc7\u4e86!",err5:"\u8bf7\u591a\u4e0e\u65b0\u670b\u53cb\u4ea4\u6d41\u54e6!",err6:"\u5206\u4eab\u5931\u8d25\uff0c\u7a0d\u540e\u91cd\u8bd5",err7:"\u8bf7\u591a\u4e0e\u65b0\u670b\u53cb\u4ea4\u6d41\u54e6",err8:"\u4eba\u591a\u529b\u91cf\u5927\uff01"};var a=["@\u6211 \u4fc4\u7f57\u65af\u65b9\u5757\u7ecf\u5178\u91cd\u5236\uff0c\u4f60\u6ca1\u73a9\u8fc7\u7684\u5168\u65b0\u4f53\u9a8c\uff01"],r=["sdk-res/share1.jpg"];i.onShareWithCallback(function(){var e=n._getShareConfig(SharePos.TRANSMIT);return{title:e.title,imageUrl:e.pic,query:e.query}}),window.SharePos={NORMAL:240,TRANSMIT:241,GROUP:242,RESULT:243,PROP:244,REVIVE:245,PROP_SPECIAL:286,PDD_COUPON:287},n._getShareConfig=function(e,t,o,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,c=void 0,l=void 0,u=void 0,h=i.getShareConfig(e);h?(console.log("\u5b58\u5728\u5728\u7ebf\u914d\u7f6e:",h,e),c=h.share_text,l=h.share_pic_local,u=h.share_id):(console.log("\u4e0d\u5b58\u5728\u5728\u7ebf\u914d\u7f6e\uff1a",e),c=t||a[0],l=o||r[0],u=s);var d=void 0;return d=n&&""!==n?"position_id="+e+"&share_id="+u+"&cid=10196&"+n:"position_id="+e+"&share_id="+u+"&cid=10196",console.log("title:",c,"pic:",l,"query:",d,"share_id:",u),{title:c,pic:l,query:d,share_id:u}},n.configShare=function(e,t,o,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments[6],s=arguments[7],c=arguments[8],l=arguments[9],u=this._getShareConfig(e,t,o,n,i),h=u.title,d=u.pic,p=u.share_id,f=u.query;a.length>0&&(h=String.Format.apply(String,[h].concat(function(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}(a)))),console.log("shareData:",JSON.stringify({title:h,pic:d,share_id:p,query:f})),this.share(h,d,f,r,s,c,l)},n.share=function(e,t,o,n,a,r,s){i.share(e,t,o,function(e){n&&n(e)},function(e){a&&a(e)},r,s)},n.normalShare=function(e){var t=a.getRandomOne(),o=r.getRandomOne();this.configShare(SharePos.NORMAL,t,o,null,-1,[],function(t){console.log("\uff01\uff01\uff01normalShare success"),e&&e(t)})},n.resultShare=function(e,t){var o=a.getRandomOne();this.configShare(SharePos.RESULT,o,null,null,-1,t,function(t){e&&e(t)})},n._groupShare=function(e){var t=a.getRandomOne();this.configShare(SharePos.GROUP,t,null,null,-1,[],function(t){e&&e(t)})},n.specialShare=function(e,t,o,n,i){this.configShare(e,null,null,null,-1,[],function(e){},o,n,i)},cc._RF.pop()},{"../common/Define":"Define",EventCenter:"EventCenter",WxSDK:"WxSDK",sdk:"sdk"}],WxSDK:[function(e,t,o){"use strict";cc._RF.push(t,"1fa48JIESxHX7yBJ6g9R1y3","WxSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=s(e("EventCenter")),i=s(e("SettingHandler")),a=(e("Common"),s(e("CommonNode"))),r=e("../common/Define");function s(e){return e&&e.__esModule?e:{default:e}}var c=e("sdk");window.DEBUG=!1,window.GAME_ID="puzzle01",window.GAME_VERSION=19,window.subPackages=[{name:"1e",root:"res/raw-assets/1e"},{name:"14",root:"res/raw-assets/14"},{name:"12",root:"res/raw-assets/12"},{name:"16",root:"res/raw-assets/16"}];var l={bestScore:"bestScore",_initSDK:function(){c.init({game_id:GAME_ID,game_version:GAME_VERSION,videoId:"adunit-d48c9460119d6fd5",bannerId:"adunit-101905c78c7582aa",onBannerResize:function(e,t,o,i,a,s){return a+i>t&&(a=t-i),n.default.post(r.EventMsg.ON_BANNER_RESIZE,{top:a,left:s}),{top:a,left:s}}})},hasVideo:function(){return"undefined"==typeof wx||c.hasVideo()},setPosNearBanner:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments[2];if(c._banner&&c._banner.style&&c._banner.style.realHeight){var n=o||c._banner.style.top,i=cc.view.getVisibleSize(),a=cc.v2(i.width/2,(c.sys.screenHeight-n)/c.sys.screenHeight*i.height+.5*e.height+t);return c.isIos()&&i.height/i.width>=2&&(a.y+=65),a=e.parent.convertToNodeSpaceAR(a),e.position=a,!0}return!1},setPosInBanner:function(e,t){if(c._banner&&c._banner.style&&c._banner.style.realHeight){var o=t||c._banner.style.top,n=c._banner.style.realHeight,i=cc.view.getVisibleSize(),a=cc.p(i.width/2,(c.sys.screenHeight-o-n/2)/c.sys.screenHeight*i.height);return c.isIos()&&i.height/i.width>=2&&(a.y+=65),a=e.parent.convertToNodeSpaceAR(a),e.position=a,!0}return!1},showModalCustom:function(e){c._checkWx()&&wx.showModal(e)},onMemoryWarning:function(e){c.checkWxSdkVersion("2.0.2")>=0&&wx.onMemoryWarning(function(t){console.log("!!!Warning Level:",t.level),e&&e(t)})},_checkVideoLoaded:function(){c.onRewardsADLoaded=function(){n.default.post(r.EventMsg.REWARD_ADS_LOADED)}},getSetting:function(){return new Promise(function(e,t){if(!(c.checkWxSdkVersion("1.2.0")>=0))return console.log("\u7248\u672c\u4e0d\u517c\u5bb9:","wx.getSetting"),t();wx.getSetting({success:function(t){return console.log("authSetting:",t.authSetting),e(t.authSetting)},fail:function(){return console.log("\u6267\u884c\u65f6\u62a5:","wx.getSetting"),t()}})})},vibrate:function(e){if(i.default.vibrateState&&c.checkWxSdkVersion("1.2.0")>=0){var t={success:function(){},fail:function(){}};e?wx.vibrateLong(t):wx.vibrateShort(t)}},bannerExit:function(){return c._banner},showBanner:function(){a.default.Instant.showFakeADS(),c.showBanner()},hideBanner:function(){a.default.Instant.hideFakeADS(),c.hideBanner()},showLoading:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;c.showLoading(e,t,o,n,i)},hideLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c.hideLoading(e,t,o)},showVideo:function(e,t,o){var i=c._bannerVisible;c.showVideo(function(t){i&&c.showBanner(),n.default.post(r.EventMsg.REWARD_ADS_HIDE,t),e&&e(t)},function(e){o&&o(e)},function(){i&&c.hideBanner(),n.default.post(r.EventMsg.REWARD_ADS_SHOW)})},loadImage:function(e,t,o,n){var i=e.getComponent(cc.Sprite);if(void 0===i.idx?i.idx=0:i.idx++,"undefined"!=typeof wx){var a=t,r=wx.createImage(),s=i.idx;r.onload=function(){var e=new cc.Texture2D;e.initWithElement(r),e.handleLoadedTexture(),s===i.idx&&(i.spriteFrame=new cc.SpriteFrame(e),o&&o(i))},r.onerror=n,r.src=a}},updateScore:function(e,t){e.bscore=JSON.stringify({wxgame:{score:t,update_time:Math.floor((new Date).getTime()/1e3)}}),c.updateScore(e,function(e){},function(e){c.showToast("\u63d0\u4ea4\u5931\u8d25")})},isIphoneLong:function(){var e=cc.view.getVisibleSize();return c.isIos()&&e.height/e.width>2},feedbackButton:null,createFeedbackBtn:function(){if("undefined"!=typeof wx&&"function"==typeof wx.createFeedbackButton){var e=wx.createFeedbackButton({type:"text",text:"\u610f\u89c1\u53cd\u9988",style:{left:10,top:10,width:45,height:20,lineHeight:20,backgroundColor:"#16161630",color:"#ffffff80",textAlign:"center",fontSize:10,borderRadius:5}});return this.feedbackButton=e,e}return null},showFeedbackBtn:function(){this.feedbackButton&&this.feedbackButton.show()},hideFeedbackBtn:function(){this.feedbackButton&&this.feedbackButton.hide()},isIos:function(){return c.isIos()},isAndroid:function(){return c.isAndroid()},checkWxVersion:function(e){return c.checkWxVersion(e)}};l.createFeedbackBtn(),l._initSDK(),l._checkVideoLoaded(),window.WxSDK=l,t.exports=l,o.default=l,e("WxSDK+Controller"),e("WxSDK+Post"),e("WxSDK+Reprot"),e("WxSDK+Share"),t.exports=o.default,cc._RF.pop()},{"../common/Define":"Define",Common:"Common",CommonNode:"CommonNode",EventCenter:"EventCenter",SettingHandler:"SettingHandler","WxSDK+Controller":"WxSDK+Controller","WxSDK+Post":"WxSDK+Post","WxSDK+Reprot":"WxSDK+Reprot","WxSDK+Share":"WxSDK+Share",sdk:"sdk"}],pddSDK:[function(e,t,o){"use strict";cc._RF.push(t,"dd2f030OSVPbIrK4WOI6cgy","pddSDK");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../../data/DateTimerHandler"));e("WxSDK");var i={game_id:GAME_ID,goodsMap:{},getPDDGoodsList:function(e,t){console.log("\u83b7\u53d6\u62fc\u591a\u591a\u5546\u54c1\u6570\u636e"),"undefined"!=typeof wx&&this._request("https://ex.xiaoyouxiqun.com/pdd/get_goods.php",{game_id:this.game_id},function(o){if(o.data&&o.data.data){console.log("\u62c9\u53d6\u62fc\u591a\u591a\u5546\u54c1\u6570\u636e\u6210\u529f");var n=o.data.data.goods_list;e&&e(n)}else console.log("\u62c9\u53d6\u62fc\u591a\u591a\u5546\u54c1\u6570\u636e\u9519\u8bef"),t&&t()},function(e){console.log("\u62c9\u53d6\u62fc\u591a\u591a\u5546\u54c1\u6570\u636e\u5931\u8d25:",e),t&&t()})},getPDDHotGoodsList:function(e,t){console.log("\u83b7\u53d6\u62fc\u591a\u591a\u70ed\u95e8\u5546\u54c1\u6570\u636e"),"undefined"!=typeof wx&&this._request("https://ex.xiaoyouxiqun.com/pdd/get_top_goods.php",{game_id:this.game_id},function(o){if(o.data&&o.data.data){console.log("\u62c9\u53d6\u62fc\u591a\u591a\u70ed\u95e8\u5546\u54c1\u6570\u636e\u6210\u529f");var n=o.data.data.list;e&&e(n)}else console.log("\u62c9\u53d6\u62fc\u591a\u591a\u70ed\u95e8\u5546\u54c1\u6570\u636e\u9519\u8bef"),t&&t()},function(e){console.log("\u62c9\u53d6\u62fc\u591a\u591a\u5546\u54c1\u6570\u636e\u5931\u8d25:",e),t&&t()})},tid:0,refreshPDDGoodsList:function(e,t,o,n){var i=this;clearTimeout(this.tid),t()&&(console.log("\u5237\u65b0\u62fc\u591a\u591a\u6570\u636e\u4e2d"),this.getPDDHotGoodsList(function(e){i.goodsMap={},i._addListToMap(e),o&&o(),i.getPDDGoodsList(function(e){i._addListToMap(e)},n)},n),this.tid=setTimeout(function(){i.refreshPDDGoodsList(e,t,o,n)},60*e*1e3))},_addListToMap:function(e){var t=!0,o=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=i.value;this._addGoodsToMap(r)}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}},_addGoodsToMap:function(e){this.goodsMap[e.goods_id]||(this.goodsMap[e.goods_id]=e)},getGenerateUrl:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(console.log("\u83b7\u53d6\u62fc\u591a\u591a\u63a8\u5e7f\u94fe\u63a5"),"undefined"!=typeof wx){var i={game_id:this.game_id,goods_id_list:"["+e+"]",p_id:t};this._request("https://ex.xiaoyouxiqun.com/pdd/generate_url.php",i,function(e){if(e.data&&e.data.data){var t=e.data.data;console.log("\u83b7\u53d6\u62fc\u591a\u591a\u63a8\u5e7f\u94fe\u63a5\u6210\u529f:",t);var i=t.goods_promotion_url_list[0].we_app_info.page_path,a=t.goods_promotion_url_list[0].we_app_info.app_id,r=t.goods_promotion_url_list[0].goods_detail;o&&o({app_path:i,app_id:a,goods_detail:r})}else console.log("\u62c9\u53d6\u62fc\u591a\u591a\u63a8\u5e7f\u94fe\u63a5\u9519\u8bef:",e),n&&n()},function(e){console.log("\u62c9\u53d6\u62fc\u591a\u591a\u6570\u636e\u5931\u8d25"),n&&n(e)})}},_request:function(e,t,o,n){wx.request({url:e,header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},method:"POST",data:t,success:o,fail:n})},toPddMiniApp:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;console.log("\u8df3\u8f6c\u62fc\u591a\u591a\u5c0f\u7a0b\u5e8f:",e,t),"undefined"!=typeof wx&&wx.navigateToMiniProgram({appId:e,path:t,success:function(e){console.log("\u8df3\u8f6c\u62fc\u591a\u591a\u5c0f\u7a0b\u5e8f\u6210\u529f!"),o&&o()},fail:function(e){console.log("\u8df3\u8f6c\u62fc\u591a\u591a\u5c0f\u7a0b\u5e8f\u5931\u8d25!",e),n&&n(e)}})},hasCoupon:function(){if("undefined"==typeof wx)return!0;var e=this._getMapValueList();if(e.length>0){var t=!0,o=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.coupon_remain_quantity>0)return!0}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}return!1},checkShowCoupon:function(e){return 1===WxSDK.pdd_toggle&&(n.default.pddPopTime>WxSDK.ppd_pop_time_day?(console.log("\u62fc\u591a\u591a\u4f18\u60e0\u5238:\u4eca\u65e5\u5f39\u51fa\u9650\u5236\u5df2\u7528\u5b8c,\u4e0d\u518d\u5c55\u793a"),!1):n.default.pddShowTime1>WxSDK.pdd_show_time_day?(console.log("\u62fc\u591a\u591a\u4f18\u60e0\u5238:\u4eca\u65e5\u5f00\u542f\u6b21\u6570\u5df2\u7528\u5b8c,\u4e0d\u518d\u5c55\u793a"),!1):e<WxSDK.pdd_limit_score?(console.log("\u62fc\u591a\u591a\u4f18\u60e0\u5238:\u5f97\u5206\u6761\u4ef6\u4e0d\u8db3,\u4e0d\u5c55\u793a"),!1):this.hasCoupon()?(console.log("\u62fc\u591a\u591a\u4f18\u60e0\u5238\u53ef\u4ee5\u5c55\u793a:\u5269\u4f59\u6b21\u6570("+n.default.pddShowTime1+"),\u5f97\u5206\u8fbe\u6210("+e+">"+WxSDK.pdd_limit_score+")"),!0):(console.log("\u62fc\u591a\u591a\u4f18\u60e0\u5238:\u4f18\u60e0\u5238\u4e0d\u8db3,\u4e0d\u5c55\u793a"),!1))},getNumGoods:function(e){var t=this._getMapValueList();if(t.length>0){var o=t.filter(function(e){return e.coupon_remain_quantity>0});return this._getRandomCount(o,e)}return[]},_getRandomCount:function(e,t){if(t>e.length)return console.log("\u8d85\u51fa\u6570\u7ec4\u957f\u5ea6"),e;for(var o=e.slice(0),n=e.length,i=n-t,a=void 0,r=void 0;n-- >i;)a=o[r=Math.floor((n+1)*Math.random())],o[r]=o[n],o[n]=a;return o.slice(i)},getMaxDiscount:function(e){var t=0,o=!0,n=!1,i=void 0;try{for(var a,r=e[Symbol.iterator]();!(o=(a=r.next()).done);o=!0){var s=a.value;s.coupon_discount>t&&(t=s.coupon_discount)}}catch(e){n=!0,i=e}finally{try{!o&&r.return&&r.return()}finally{if(n)throw i}}return t/100},_getMapValueList:function(){var e=[];for(var t in this.goodsMap)e.push(this.goodsMap[t]);return e}};window.pddSDK=t.export=i,cc._RF.pop()},{"../../data/DateTimerHandler":"DateTimerHandler",WxSDK:"WxSDK"}],sdk:[function(e,t,o){"use strict";cc._RF.push(t,"e879dg8ETtLnoKQ1/3NX8CF","sdk");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){var e;return(e=console).info.apply(e,arguments)},a={init:function(e){var t=e.game_id,o=e.game_version,n=e.videoId,a=e.bannerId,r=e.onBannerPlaced,h=void 0===r?l:r,d=e.onBannerResize,p=void 0===d?u:d,f=e.autoPullInterval,_=void 0===f?3:f,g=e.autoPullAllConfig,v=void 0===g||g,m=e.autoPullMainConfig,y=void 0===m||m,S=e.autoPullShare,w=void 0===S||S,b=e.autoPullInsideAds,C=void 0===b||b,P=e.autoPullWallAds,E=void 0!==P&&P,T=e.needReportTime,D=void 0!==T&&T,L=e.printLog,A=void 0===L||L,x=e.saveLog,R=void 0===x||x;this.game_id=t,this.game_version=o,this.video_ids=Array.isArray(n)?n:n?[n]:[],this.banner_ids=Array.isArray(a)?a:a?[a]:[],this.onBannerPlaced=h,this.onBannerResize=p,this.autoPullInterval=_,this.autoPullMainConfig=y,this.autoPullShare=w,this.autoPullInsideAds=C,this.autoPullWallAds=E,this.needReportTime=D,i=A?function(){var e;return(e=console).info.apply(e,arguments)}:function(){},function(e){e&&c?(console.log=function(){s.log.apply(console,arguments),c.log.apply(c,arguments)},console.info=function(){s.info.apply(console,arguments),c.info.apply(c,arguments)},console.warn=function(){s.warn.apply(console,arguments),c.warn.apply(c,arguments)},console.debug=function(){s.debug.apply(console,arguments),c.debug.apply(c,arguments)}):(console.log=s.log,console.info=s.info,console.warn=s.warn,console.debug=s.debug)}(R),this.sys=window.wx&&wx.getSystemInfoSync?wx.getSystemInfoSync():{},i("\u6e38\u620f\u7248\u672c: ",this.game_version),i("SDK\u7248\u672c: ",this.version),this.banner_ids=this._shuffle(this.banner_ids),this.video_ids=this._shuffle(this.video_ids),this.video_ids.length>0&&this._loadRewardedVideoAd(),window.wx&&wx.offShow(this._runOnShowCallback),window.wx&&wx.onShow(this._runOnShowCallback),this.autoPullAllConfig=v},version:"0.1.7",game_id:"",game_version:1,pullCfg:!0,lastPullTime:0,_firstPull:!1,get autoPullAllConfig(){return this._autoPullAllConfig},set autoPullAllConfig(e){this.enablePullConfigOnShow(e)},banner_ids:[],banner_index:0,bannerMethod:{placedTop:function(e,t,o){return{width:o,top:0,left:.5*(e-o)}},placedBottom:l,resizeTop:function(e,t,o,n,i,a){return{top:0,left:a}},resizeBottom:u},onBannerPlaced:l,onBannerResize:u,video_ids:[],video_index:0,conf:{share_flag:-1,invite_flag:-1,prize_flag:-1,banner_refresh_interval:-1},insideAds:{desc:"\u5185\u63a8\u5e7f\u544a",name:"get_list",url:"https://list.xiaoyouxiqun.com/get_list.php",list:[],conf:{},onChanged:null,hasAds:function(){return(!window.wx||"function"==typeof wx.navigateToMiniProgram)&&Array.isArray(this.list)&&this.list.length>0},user_id:""},wallAds:{desc:"\u8bd5\u73a9\u5899",name:"get_wall",url:"https://list.xiaoyouxiqun.com/get_wall.php",list:[],conf:{},onChanged:null,hasAds:function(){return(!window.wx||"function"==typeof wx.navigateToMiniProgram)&&Array.isArray(this.list)&&this.list.length>0},user_id:""},onRewardsADClosed:null,onRewardsADLoaded:null,onRemoteLoaded:null,onFirstConfigComplete:null,sys:{},pullMainConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a._getRemoteConfig(e,t),a._firstPull=!0},pullOtherConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inside:!0,wall:!0,share:!0},t={inside:!0,wall:!0,share:!0};a.extend(t,e),(e=t).inside&&a._getAds(a.insideAds),e.wall&&a._getAds(a.wallAds),e.share&&a._getRemoteShareConfig()},enablePullConfigOnShow:function(e){this._autoPullAllConfig=e,a.offShow("sdk"),e&&a.onShow("sdk",function(e){var t=(new Date).getTime()/1e3-a.lastPullTime;a.pullCfg&&t>a.autoPullInterval?(a.lastPullTime=(new Date).getTime()/1e3,a.autoPullMainConfig&&a.pullMainConfig(),a.pullOtherConfig({inside:a.autoPullInsideAds,wall:a.autoPullWallAds,share:a.autoPullShare})):a.pullCfg=!0},0,!a._firstPull)},onShow:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this._onShowList.findIndex(function(t){return t.name==e});if(-1!==i){var a=this._onShowList[i];a.callback=t,a.order=o}else this._onShowList.push({name:e,callback:t,order:o});n&&window.wx&&t&&t(wx.getLaunchOptionsSync())},offShow:function(e){var t=this._onShowList.findIndex(function(t){return t.name==e});return t>=0&&this._onShowList.splice(t,1),t>=0},getUserInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i("SDK.getUserInfo"),this._checkWx(t,o)&&wx.getUserInfo({withCredentials:!0,lang:"zh_CN",success:e,fail:t,complete:o})},getUserInfoForce:function(e,t,o){var n=this;i("SDK.getUserInfoForce"),this._checkWx(t,o)&&(this.showLoading("\u8bf7\u7a0d\u5019...",!0),setTimeout(function(){n.getUserInfo(function(t){n.hideLoading(),e&&e(t),o&&o()},function(a){a.errMsg.indexOf("auth deny")>-1||a.errMsg.indexOf("auth denied")>-1?(n.hideLoading(),n.showModal("\u63d0\u793a","\u6e38\u620f\u9700\u8981\u60a8\u6388\u6743\u5934\u50cf\u548c\u7528\u6237\u540d\u4fe1\u606f",function(a){n.openSetting(function(a){n.hideLoading(),i("\u4e00\u76f4\u7b49\u5f85\u6388\u6743"),n.getUserInfoForce(e,t,o)},function(e){n.hideLoading(),t&&t(e),o&&o()})},function(e){n.hideLoading(),t&&t(e),o&&o()})):(n.hideLoading(),t&&t(a),o&&o())})},100))},updateScore:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i("SDK.updateScore "+JSON.stringify(e)),this._checkWx(o,n,"setUserCloudStorage")){var a=this._objectToKVArray(e);i("kv array "+JSON.stringify(a)),wx.setUserCloudStorage({KVDataList:a,success:t,fail:o,complete:n})}},enableShare:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i("SDK.enableShare"),this._checkWx(o,n,"showShareMenu")&&(this._shareEnabled||wx.showShareMenu({withShareTicket:!0,success:function(o){t._shareEnabled=!0,e&&e(o)},fail:function(e){o&&o(e),n&&n(e)}}))},onShare:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(i("SDK.onShare"),this._checkWx(r,s)){var c=[],l=[];Array.isArray(e)?e.forEach(function(e){return c.push(e)}):c.push(e),Array.isArray(t)?t.forEach(function(e){return l.push(e)}):l.push(t);var u=function(e){a.pullCfg=!1;var t="",i="";if(0!=c.length){var u=Math.round(1e11*Math.random())%c.length;t=c[u]}if(0!=l.length){var h=Math.round(1e11*Math.random())%l.length;i=l[h]}return{title:t,imageUrl:i,query:o||"",success:n,fail:r,complete:s}};this._shareEnabled?wx.onShareAppMessage(u):this.enableShare(function(){wx.onShareAppMessage(u)},r,s)}},offShare:function(){i("SDK.offShare"),this._checkWx()&&wx.offShareAppMessage()},onShareWithCallback:function(e){i("SDK.onShareWithCallback"),this._checkWx()&&(this._shareEnabled?wx.onShareAppMessage(e):this.enableShare(function(){wx.onShareAppMessage(e)}))},offShareWithCallback:function(e){i("SDK.offShareWithCallback"),this._checkWx()&&wx.offShareAppMessage(e)},share:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(i("SDK.share"),this._checkWx(r,s)){a.pullCfg=!1;var l={title:e,imageUrl:t,query:o||"",success:n,fail:r,complete:s,cancel:c};this._shareEnabled?wx.shareAppMessage(l):this.enableShare(function(){wx.shareAppMessage(l)},r,s)}},subMsg:function(e,t){i("SDK.subMsg"),this._checkWx(t,null,"getOpenDataContext")&&wx.getOpenDataContext().postMessage(e)},showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;i("SDK.showToast"),this._checkWx(n,a)&&wx.showToast({title:e,icon:"none",image:r||void 0,duration:t||1500,success:o,fail:n,complete:a})},showModal:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;i("SDK.showModal"),this._checkWx(n,a)&&wx.showModal({title:e,content:t,showCancel:!1,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",success:o,fail:n,complete:a})},openSetting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i("SDK.openSetting"),this._checkWx(t,o)&&wx.openSetting({success:e,fail:t,complete:o})},showLoading:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;i("SDK.showLoading"),this._checkWx(n,a,"showLoading")&&wx.showLoading({title:e,mask:t,onSuccess:o,onFail:n,onComplete:a})},hideLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i("SDK.hideLoading"),this._checkWx(t,o,"hideLoading")&&wx.hideLoading({onSuccess:e,onFail:t,onComplete:o})},_rewardsAdLoaded:!1,hasVideo:function(){return i("SDK.hasVideo"),this._videoAd&&this._videoAd.isReady?this._videoAd.isReady():this.video_ids.length>0&&this._videoAd&&this._rewardsAdLoaded},showVideo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i("SDK.showVideo"),this.video_ids.length>0?this._videoAd?(this.onRewardsADClosed=e,this._videoAd.load().then(function(){i("\u5e7f\u544a\u5bf9\u8c61: ",t._videoAd),t._videoAd.show().then(function(){t._rewardsAdLoaded=!1,n&&n(),i("\u89c6\u9891\u5e7f\u544a\u64ad\u653e\u6210\u529f!")}).catch(function(e){i("\u89c6\u9891\u5e7f\u544a\u64ad\u653e\u5931\u8d25: ",e),o&&o(e)})}).catch(function(e){i("\u89c6\u9891\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25: ",e),o&&o(e)})):(i("\u89c6\u9891\u5e7f\u544a\u7ec4\u4ef6\u672a\u521b\u5efa!"),o&&o({errMsg:"\u89c6\u9891\u5e7f\u544a\u7ec4\u4ef6\u672a\u521b\u5efa!"})):(i("\u672a\u542f\u7528\u89c6\u9891\u5e7f\u544a!"),o&&o({errMsg:"\u672a\u542f\u7528\u89c6\u9891\u5e7f\u544a!"}))},_bannerTimer:0,_bannerVisible:!1,_bannerHasShow:!1,showBanner:function(){var e=this;if(i("SDK.showBanner"),this._bannerVisible=!1,this._bannerHasShow=!0,this.banner_ids.length>0){var t=function(t){t>0&&(clearTimeout(e._bannerTimer),e._bannerTimer=setTimeout(function(){e._banner&&(i("\u5b9a\u65f6\u79fb\u9664\u6a2a\u5e45\u5e7f\u544a"),e._banner.destroy(),e._banner=null,e._bannerVisible=!1),i("\u5b9a\u65f6\u91cd\u65b0\u663e\u793a\u6a2a\u5e45\u5e7f\u544a"),e._bannerTimer=setTimeout(function(){e.showBanner()},60)},1e3*t))},o=function(){i("\u6a2a\u5e45\u5e7f\u544a\u663e\u793a\u6210\u529f!"),e._bannerVisible=!0,t(e.conf.banner_refresh_interval)},n=function(o){i("\u6a2a\u5e45\u5e7f\u544a\u663e\u793a\u5931\u8d25! ",o),i("\u5c06\u5728"+e.conf.banner_refresh_interval+"\u79d2\u540e\u91cd\u8bd5(hideBanner\u4f1a\u53d6\u6d88\u91cd\u8bd5)"),t(e.conf.banner_refresh_interval)},a=function(){e._createBannerAd(function(){e._banner.show().then(function(){o()}).catch(function(e){n(e)})},function(e){n(e)})};clearTimeout(this._bannerTimer),this._banner?this._banner.show().then(function(){o()}).catch(function(e){a()}):a()}else i("SDK.showBanner: \u65e0\u6a2a\u5e45\u5e7f\u544aID!")},hideBanner:function(){i("SDK.hideBanner"),this._bannerVisible=!1,this._bannerHasShow=!1,this._banner&&this._banner.hide(),clearTimeout(this._bannerTimer),this._bannerTimer=0},removeBanner:function(){i("SDK.removeBanner"),this._bannerVisible=!1,this._banner&&(this._banner.destroy(),this._banner=null),this._bannerTimer&&(clearTimeout(this._bannerTimer),this._bannerTimer=0)},showImage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i("SDK.showImage"),this._checkWx(o,n)&&wx.previewImage({current:e,urls:[e],success:function(e){a.pullCfg=!1,t(e)},fail:o,complete:n})},showInsideAds:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i("SDK.showInsideAds, id:",e.app_id," path:",e.app_path);e.app_id,e.app_path;window.wx&&"function"==typeof wx.navigateToMiniProgram&&e.app_id?wx.navigateToMiniProgram({appId:e.app_id,path:e.app_path,extraData:"",success:function(e){i("\u8df3\u8f6c\u81f3\u5c0f\u7a0b\u5e8f\u6210\u529f: ",e),t&&t(e)},fail:function(e){i("\u8df3\u8f6c\u81f3\u5c0f\u7a0b\u5e8f\u5931\u8d25: ",e),o&&o()},complete:n}):(i("\u4e0d\u652f\u6301\u8df3\u8f6c\u81f3\u5c0f\u7a0b\u5e8f"),o&&o(),n&&n())},getShareConfig:function(e){if(!this._shareConfig)return null;var t=this._shareConfig.findIndex(function(t){return t.position_id==e});if(-1==t)return null;var o=this._shareConfig[t];return o.share_pic_local?(i("\u4f7f\u7528\u8fdc\u7a0b\u5206\u4eab\u914d\u7f6e: ",e,"  config: ",o),o):null},shareStat:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.request({url:"https://share.xiaoyouxiqun.com/report.php",data:{position_id:e,share_id:t,self:o},success:function(e){i("\u5206\u4eab\u7edf\u8ba1\u63d0\u4ea4\u6210\u529f: ",e)},fail:function(e){i("\u5206\u4eab\u7edf\u8ba1\u63d0\u4ea4\u5931\u8d25: ",e)}})},compareVersion:function(e,t){"string"!=typeof e&&(e=e.toString?e.toString():"0"),"string"!=typeof t&&(t=t.toString?t.toString():"0");for(var o=e.split("."),n=t.split("."),i=Math.max(o.length,n.length),a=0,r=0;r<i&&0==(a=(parseInt(o[r])||0)-(parseInt(n[r])||0));++r);return a},checkWxVersion:function(e){return this._checkWx()?this.compareVersion(this.sys.version,e):-1},checkWxSdkVersion:function(e){return this._checkWx()?this.compareVersion(this.sys.SDKVersion||"1.0.1",e):-1},isIos:function(){return!!this._checkWx()&&("ios"==this.sys.platform||this.sys.system.indexOf("iOS")>=0)},isAndroid:function(){return!!this._checkWx()&&("android"==this.sys.platform||this.sys.system.indexOf("Android")>=0)},isIphoneX:function(){return!!this._checkWx()&&!!this.sys.model.match("iPhone X")},reportTime:function(e,t,o){var n=this;window.wx&&Promise.all([this.promisify(wx.getBatteryInfo),this.promisify(wx.getNetworkType)]).then(function(a){var r=n.sys||{},s={sdk_version:r.SDKVersion,version:r.version,model:r.model,system:r.system,battery_level:a[0].level,network_type:a[1].networkType,game_id:n.game_id,tag:e,code:t,time_used:o};i("\u51c6\u5907\u4e0a\u62a5\u8bf7\u6c42\u65f6\u95f4: ",s),n.request({url:"https://report.xiaoyouxiqun.com/report_time.php",data:{data:JSON.stringify(s)},success:function(e){i("\u4e0a\u62a5\u8bf7\u6c42\u65f6\u95f4\u6210\u529f: ",e)},fail:function(e){i("\u4e0a\u62a5\u8bf7\u6c42\u65f6\u95f4\u5931\u8d25: ",e)}})})},reportAdsClick:function(e,t){var o=this;window.wx&&this.getUserIdOrCode(e,function(n){n.page=e,n.tag=t;var a=wx.getLaunchOptionsSync();n.reserve=a.query&&a.query.agent||"official",o.request({url:"https://report.xiaoyouxiqun.com/report_click.php",data:n,success:function(o){i("\u4e0a\u62a5\u70b9\u51fb["+e+", "+t+"]\u6210\u529f: ",o)},fail:function(o){i("\u4e0a\u62a5\u70b9\u51fb["+e+", "+t+"]\u5931\u8d25: ",o)}})})},promisify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e;if("string"==typeof e){if(!window.wx||!window.wx[e])return Promise.reject({errMsg:"[SDK.promisify]\u5931\u8d25: \u65b9\u6cd5"+e+"\u5728\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u4e0d\u5b58\u5728!"});o=window.wx[e]}return o?new Promise(function(e,n){t.success=function(t){return e(t)},t.fail=function(e){return n(e)},o(t)}):Promise.reject({errMsg:"[SDK.promisify]\u5931\u8d25: \u65b9\u6cd5\u5728\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u4e0d\u5b58\u5728!"})},setStorage:function(e,t){var o=JSON.stringify({v:t});window.wx?wx.setStorage({key:e,data:o}):window.localStorage&&window.localStorage.setItem(e,o)},getStorageSync:function(e){var t="",o=null;window.wx?t=wx.getStorageSync(e):window.localStorage&&(t=window.localStorage.getItem(e));try{o=JSON.parse(t).v}catch(e){o=null}return o},getStorage:function(e,t){window.wx?t&&wx.getStorage({key:e,success:function(e){var o=null;try{o=JSON.parse(e.data).v}catch(e){o=null}t(o)},fail:function(e){t(null)}}):window.localStorage?t&&t(this.getStorageSync(e)):t&&t(null)},_getUserIdKey:function(e){return"wx_uid_"+e},getSavedUserId:function(e){return this.getStorageSync(this._getUserIdKey(e))||""},getUserCode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._checkWx(t,null,"login")&&wx.login({success:function(t){i("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u6210\u529f: ",t);var o=t.code;e&&e({code:o})},fail:function(e){i("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u5931\u8d25: ",e),t&&t(e)}})},getUserIdOrCode:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._checkWx(n,null,"checkSession")&&this.getStorage(this._getUserIdKey(e),function(e){e?wx.checkSession({success:function(t){i("\u767b\u5f55\u672a\u8d85\u65f6, \u4f7f\u7528\u672c\u5730user_id"),o&&o({user_id:e})},fail:function(e){i("\u767b\u5f55\u8d85\u65f6, \u91cd\u65b0\u5fae\u4fe1\u767b\u5f55: ",e),t.getUserCode(o,n)}}):(i("\u672c\u5730\u65e0user_id, \u4f7f\u7528\u5fae\u4fe1\u767b\u5f55\u83b7\u53d6code"),t.getUserCode(o,n))})},saveUserId:function(e,t){t&&t.data&&t.data.user_id&&this.setStorage(this._getUserIdKey(e),t.data.user_id)},request:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{url:url,data:data,success:success,fail:fail,complete:complete};this._checkWx(e.fail,e.complete,"request")&&(!e.data&&(e.data={}),!e.data.game_id&&(e.data.game_id=this.game_id),!e.data.version&&(e.data.version=this.game_version),!e.method&&(e.method="POST"),!e.header&&(e.header={"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}),i("\u53d1\u9001\u7f51\u7edc\u8bf7\u6c42: ",e),wx.request(e))},getAddons:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this._checkWx(null,null,"getLaunchOptionsSync"))return{};var i=wx.getLaunchOptionsSync(),r=n||{};return e&&(r.cid=i.query&&i.query.cid?i.query.cid:""),t&&(r.agent=i.query&&i.query.agent?i.query.agent:"official"),o&&a.sys&&a.sys.platform&&"string"==typeof a.sys.platform&&(r.os=a.sys.platform.toLowerCase(),"android"!=r.os&&"ios"!=r.os&&(r.os="android")),r},getDataFromRes:function(e){if(e&&200==e.statusCode&&e.data){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(o){t=e.data}return t}return null},isPlainObject:function(e){return"object"===(void 0===e?"undefined":n(e))&&(!e.constructor||e.constructor.prototype===Object.prototype)},extend:function(){var e,t,o,i,r,s,c=arguments[0]||{},l=1,u=arguments.length,h=!1;for("boolean"==typeof c&&(h=c,c=arguments[1]||{},l=2),"object"!==(void 0===c?"undefined":n(c))&&"function"!=typeof c&&(c={}),u===l&&(c=this,--l);l<u;l++)if(null!=(e=arguments[l]))for(t in e)o=c[t],c!==(i=e[t])&&(h&&i&&(a.isPlainObject(i)||(r=Array.isArray(i)))?(r?(r=!1,s=o&&Array.isArray(o)?o:[]):s=o&&a.isPlainObject(o)?o:{},c[t]=a.extend(h,s,i)):void 0!==i&&(c[t]=i));return c},_shareEnabled:!1,_checkWx:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"undefined"==typeof wx?(e&&e(),t&&t(),!1):!o||void 0!=wx[o]||(e&&e({code:999,errMsg:"\u8bf7\u5347\u7ea7\u4f60\u7684\u5fae\u4fe1\u7248\u672c!"}),t&&t(),!1)},_objectToKVArray:function(e){var t=[];if(e instanceof Object)for(var o in e)t.push({key:o,value:e[o]+""});else e instanceof Array&&(t=e);return t},_kvArrayToObject:function(e){var t={};return e.forEach(function(e){void 0!=e.key&&void 0!=e.value&&(t[e.key]=e.value)}),t},_onShowList:[],_runOnShowCallback:function(e){i("_runOnShowCallback: ",e),a._onShowList.sort(function(e,t){return t.order-e.order}),a._onShowList.slice(0).forEach(function(t){t&&t.callback&&t.callback(e)})},_getRemoteConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getAddons(!0,!1,!0),s=(new Date).getTime();this.request({url:"https://list.xiaoyouxiqun.com/conf.php",data:r,success:function(o){var n=(new Date).getTime();t.needReportTime&&t.reportTime("conf",0,n-s);var r=t.getDataFromRes(o);0==r.code&&r.conf?(t.conf=r.conf,(r.conf.video_ids||r.conf.video_id)&&(a._addVideoId(r.conf.video_ids||r.conf.video_id),a.video_ids.length>0&&!a.hasVideo()&&a._loadRewardedVideoAd()),(r.conf.banner_ids||r.conf.banner_id)&&(a._addBannerId(r.conf.banner_ids||r.conf.banner_id),a.banner_ids.length>0&&!a._bannerVisible&&a._bannerHasShow&&a.showBanner()),i("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u6210\u529f: ",o),a.onRemoteLoaded&&a.onRemoteLoaded(t.conf)):i("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u6210\u529f(\u4f46code!=0\u6216conf\u4e0d\u5b58\u5728): ",o),e&&e(o)},fail:function(e){var n=(new Date).getTime();t.needReportTime&&t.reportTime("conf",1,n-s),i("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u5931\u8d25: ",e),o&&o(e)},complete:function(e){console.log("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u5b8c\u6210"),null!==a.onFirstConfigComplete&&(a.onFirstConfigComplete(),a.onFirstConfigComplete=null,n&&n())}})},_shareConfig:null,_getRemoteShareConfig:function(){var e=this;this.request({url:"https://share.xiaoyouxiqun.com/share_list.php",success:function(t){var o=e.getDataFromRes(t);0==o.code&&Array.isArray(o.share)?(i("\u8fdc\u7a0b\u62c9\u53d6\u5206\u4eab\u914d\u7f6e\u6210\u529f: ",o),e._shareConfig=o.share,e._loadShareImage()):(i("\u8fdc\u7a0b\u62c9\u53d6\u5206\u4eab\u914d\u7f6e\u5931\u8d25: ",t),e._shareConfig=null)},fail:function(t){i("\u8fdc\u7a0b\u62c9\u53d6\u5206\u4eab\u914d\u7f6e\u5931\u8d25: ",t),e._shareConfig=null}})},_downloadedFiles:[],_loadShareImage:function(){var e=this,t=this._shareConfig,o=[],n=function(e,n){o.push(e+JSON.stringify(n)),o.length>=t.length&&i("\u4e0b\u8f7d\u5206\u4eab\u56fe\u7247\u5b8c\u6210: ",o)};t.forEach(function(t,o){var i=e._downloadedFiles.findIndex(function(e){return e.url==t.share_pic});if(-1!=i){var a=e._downloadedFiles[i];return t.share_pic_local=a.file,void n("\u4f7f\u7528\u5df2\u7ecf\u4e0b\u597d\u7684\u6587\u4ef6:",a.file)}setTimeout(function(){if("devtools"==e.sys.platform)return t.share_pic_local=t.share_pic,e._downloadedFiles.push({url:t.share_pic,file:t.share_pic}),void n("\u4e0b\u8f7d\u6587\u4ef6\u6210\u529f:",t);wx.downloadFile({url:t.share_pic,header:{},success:function(o){200==o.statusCode?(n("\u4e0b\u8f7d\u6587\u4ef6\u6210\u529f:",o),t.share_pic_local=o.tempFilePath,e._downloadedFiles.push({url:t.share_pic,file:o.tempFilePath})):n("\u4e0b\u8f7d\u6587\u4ef6\u51fa\u9519:",o)},fail:function(e){n("\u4e0b\u8f7d\u6587\u4ef6\u51fa\u9519:",e)}})},200*o)})},_getAds:function(e){var t=this;e.url&&this.getUserIdOrCode(e.name,function(o){var n=t.getAddons(!1,!0,!0,o);t.request({url:e.url,data:n,success:function(o){var n=t.getDataFromRes(o);n&&0==n.code?(t.saveUserId(e.name,o),i("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u6210\u529f: ",n),e.list=Array.isArray(n.list)?n.list:[],e.conf=n.conf||{},e.onChanged&&e.onChanged(e)):i("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",o)},fail:function(t){i("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",t)}})},function(t){i("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",t)})},_bannerResetPosition:!1,_createBannerAd:function(e,t){var o=this;if(i("SDK._createBannerAd"),this._checkWx(null,null,"createBannerAd")){if(0!=this.banner_ids.length){this._banner&&(this._banner.destroy(),this._banner=null),this.banner_index=(this.banner_index+1)%this.banner_ids.length;var n=this.banner_ids[this.banner_index];i("\u521b\u5efa\u6a2a\u5e45\u5e7f\u544a("+this.banner_index+"): "+n);var a=this.sys.screenWidth,r=this.sys.screenHeight;return this._bannerResetPosition=!1,this._banner=wx.createBannerAd({adUnitId:n,style:this.onBannerPlaced(a,r,300)}),this._banner.onResize&&this._banner.onResize(function(e){if(!o._bannerResetPosition){var t=o.onBannerResize(a,r,e.width,e.height,o._banner.style.top,o._banner.style.left);o._banner.style.top!=t.top&&(o._banner.style.top=t.top),o._banner.style.left!=t.left&&(o._banner.style.left=t.left),o._bannerResetPosition=!0}}),this._banner.onLoad(e),this._banner.onError(t),this._banner}i("SDK._createBannerAd: \u65e0\u6a2a\u5e45\u5e7f\u544aID")}else i("\u5fae\u4fe1\u7248\u672c\u4e0d\u652f\u6301\u6a2a\u5e45\u5e7f\u544a!")},_loadRewardedVideoAd:function(){if(i("SDK._loadRewardedVideoAd"),this._checkWx(null,null,"createRewardedVideoAd")){var e=this.video_ids[this.video_index];i("\u521b\u5efa\u89c6\u9891\u5e7f\u544a("+this.video_index+"): "+e),this._videoAd=wx.createRewardedVideoAd({adUnitId:e}),i("\u89c6\u9891\u5e7f\u544a\u5df2\u521b\u5efa: ",this._videoAd),this._bindVideoEvent()}else i("\u5fae\u4fe1\u7248\u672c\u4e0d\u652f\u6301\u89c6\u9891\u5e7f\u544a!")},_bindVideoEvent:function(){var e=this;this._rewardsAdEventBind||(this._videoAd.onClose(function(t){if(i("\u770b\u5b8c\u5e7f\u544a\u56de\u8c03\u53c2\u6570: ",t),e.onRewardsADClosed){var o=!t||void 0===t.isEnded||t.isEnded;e.onRewardsADClosed(o)}}),this._videoAd.onLoad(function(){i("\u4e00\u6761\u89c6\u9891\u5e7f\u544a\u52a0\u8f7d\u6210\u529f!"),e._rewardsAdLoaded=!0,e.onRewardsADLoaded&&e.onRewardsADLoaded()}),this._videoAd.onError(function(t){if(i("\u52a0\u8f7d\u4e00\u6761\u89c6\u9891\u5e7f\u544a\u65f6\u51fa\u9519\u4e86: ",t),e._rewardsAdLoaded=!1,e.video_index+=1,e.video_index<15){var o=e.video_ids[e.video_index%e.video_ids.length];i("\u91cd\u65b0\u52a0\u8f7d\u89c6\u9891\u5e7f\u544a("+e.video_index+"): "+o),e._videoAd=wx.createRewardedVideoAd({adUnitId:o})}}),this._rewardsAdEventBind=!0)},_addBannerId:function(e){this._mergeAdsId(this.banner_ids,e,"banner_index")},_addVideoId:function(e){this._mergeAdsId(this.video_ids,e,"video_index")},_mergeAdsId:function(e,t,o){i("SDK._mergeAdsId: ",t),i("\u6dfb\u52a0\u5e7f\u544aID\u524d: ids("+e+"), "+o+"("+this[o]+")");var n=e.length,a=(t+"").split(",").filter(function(e){return e});if(a.length>0){(a=a.map(function(e){return e.trim?e.trim():e})).forEach(function(t){return e.push(t)});for(var r=e.length-1;r>=0;--r)for(var s=r-1;s>=0;--s)if(!e[r]||e[r]==e[s]){e.splice(r,1);break}}var c=e.length;c>n&&(this[o]%=c),i("\u6dfb\u52a0\u5e7f\u544aID\u524d: ids("+e+"), "+o+"("+this[o]+")")},_shuffle:function(e){for(var t,o,n=e.length;0!==n;)o=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[o],e[o]=t;return e}};if(void 0!==t&&(t.exports=a),window.SDK=a,"undefined"!=typeof wx&&"function"==typeof wx.getUpdateManager){var r=wx.getUpdateManager();r.onCheckForUpdate(function(e){i("hasUpdate:"+e.hasUpdate)}),r.onUpdateReady(function(){r.applyUpdate()}),r.onUpdateFailed(function(){})}var s={log:console.log,info:console.info,warn:console.warn,debug:console.debug},c=window.wx&&"function"==typeof wx.getLogManager?wx.getLogManager():null;function l(e,t,o){return{width:o,top:t-104,left:.5*(e-o)}}function u(e,t,o,n,i,a){return{top:t-n,left:a}}cc._RF.pop()},{}],tableView:[function(e,t,o){"use strict";cc._RF.push(t,"d8c65EIEItMuLWP+VKx8bei","tableView");var n=cc.Enum({Horizontal:0,Vertical:1}),i=cc.Enum({None:0,Up:1,Down:2,Left:3,Rigth:4}),a=cc.Enum({LEFT_TO_RIGHT__TOP_TO_BOTTOM:0,TOP_TO_BOTTOM__LEFT_TO_RIGHT:1}),r=cc.Enum({Scroll:0,Flip:1});var s=cc.Class({extends:cc.ScrollView,editor:!1,properties:{_data:null,_minCellIndex:0,_maxCellIndex:0,_paramCount:0,_count:0,_cellCount:0,_showCellCount:0,_groupCellCount:null,_scrollDirection:i.None,_cellPool:null,_page:0,_pageTotal:0,_touchLayer:cc.Node,_loadSuccess:!1,_initSuccess:!1,_scheduleInit:!1,cell:{default:null,type:cc.Prefab,notify:function(e){}},ScrollModel:{default:0,type:n,notify:function(e){this.ScrollModel===n.Horizontal?(this.horizontal=!0,this.vertical=!1,this.verticalScrollBar=null):(this.vertical=!0,this.horizontal=!1,this.horizontalScrollBar=null)},tooltip:"\u6a2a\u5411\u7eb5\u5411\u6ed1\u52a8"},ViewType:{default:0,type:r,notify:function(e){this.ViewType===r.Flip?this.inertia=!1:this.inertia=!0},tooltip:"\u4e3aScroll\u65f6,\u4e0d\u505a\u89e3\u91ca\n\u4e3aFlipw\u65f6\uff0c\u5728Scroll\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u7ffb\u9875\u7684\u884c\u4e3a"},isFill:{default:!1,tooltip:"\u5f53\u8282\u70b9\u4e0d\u80fd\u94fa\u6ee1\u4e00\u9875\u65f6\uff0c\u9009\u62e9isFill\u4e3atrue\u4f1a\u586b\u5145\u8282\u70b9\u94fa\u6ee1\u6574\u4e2aview"},Direction:{default:0,type:a,tooltip:"\u89c4\u5b9acell\u7684\u6392\u5217\u65b9\u5411"},pageChangeEvents:{default:[],type:cc.Component.EventHandler,tooltip:"\u4ec5\u5f53ViewType\u4e3apageView\u65f6\u6709\u6548\uff0c\u521d\u59cb\u5316\u6216\u7ffb\u9875\u65f6\u89e6\u53d1\u56de\u8c03\uff0c\u5411\u56de\u8c03\u4f20\u5165\u4e24\u4e2a\u53c2\u6570\uff0c\u53c2\u6570\u4e00\u4e3a\u5f53\u524d\u5904\u4e8e\u54ea\u4e00\u9875\uff0c\u53c2\u6570\u4e8c\u4e3a\u4e00\u5171\u591a\u5c11\u9875"}},statics:{_cellPoolCache:{}},onLoad:function(){var e=this;s._tableView.push(this);var t=this.node.destroy;this.node.destroy=function(){e.clear(),t.call(e.node)};var o=this.node._onPreDestroy;this.node._onPreDestroy=function(){e.clear(),o.call(e.node)}},onDestroy:function(){for(var e in this._cellPool&&this._cellPool.clear(),s._tableView)if(s._tableView[e]===this)return void s._tableView.splice(e)},_addListenerToTouchLayer:function(){this._touchLayer=new cc.Node;var e=this._touchLayer.addComponent(cc.Widget);e.isAlignTop=!0,e.isAlignBottom=!0,e.isAlignLeft=!0,e.isAlignRight=!0,e.top=0,e.bottom=0,e.left=0,e.right=0,e.alignMode=cc.Widget.AlignMode,this._touchLayer.parent=this._view},_setStopPropagation:function(){this.node.on("touchstart",function(e){e.stopPropagation()}),this.node.on("touchmove",function(e){e.stopPropagation()}),this.node.on("touchend",function(e){e.stopPropagation()}),this.node.on("touchcancel",function(e){e.stopPropagation()})},_initCell:function(e,t){if(this.ScrollModel===n.Horizontal&&this.Direction===a.TOP_TO_BOTTOM__LEFT_TO_RIGHT||this.ScrollModel===n.Vertical&&this.Direction===a.LEFT_TO_RIGHT__TOP_TO_BOTTOM)for(var o=parseInt(e.name)*e.childrenCount,i=0;i<e.childrenCount;++i){var s=e.children[i].getComponent("viewCell");s&&(s._cellInit_(this),s.init(o+i,this._data,t,[o,i]))}else if(this.ViewType===r.Flip)for(var c=Math.floor(parseInt(e.name)/this._showCellCount),l=c*this._showCellCount*e.childrenCount,u=0;u<e.childrenCount;++u){var h=e.children[u].getComponent("viewCell");h&&(h._cellInit_(this),h.init(this._showCellCount*u+c%this._showCellCount+l,this._data,t,[u+c*e.childrenCount,u]))}else for(var d=0;d<e.childrenCount;++d){var p=e.children[d].getComponent("viewCell");p&&(p._cellInit_(this),p.init(d*this._count+parseInt(e.name),this._data,t,[d,d]))}},_setCellPosition:function(e,t){this.ScrollModel===n.Horizontal?(e.x=0===t?-this.content.width*this.content.anchorX+e.width*e.anchorX:this.content.getChildByName(String(t-1)).x+e.width,e.y=(e.anchorY-this.content.anchorY)*e.height):(e.y=0===t?this.content.height*(1-this.content.anchorY)-e.height*(1-e.anchorY):this.content.getChildByName(String(t-1)).y-e.height,e.x=(e.anchorX-this.content.anchorX)*e.width)},_addCell:function(e){var t=this._getCell();this._setCellAttr(t,e),this._setCellPosition(t,e),t.parent=this.content,this._initCell(t)},_setCellAttr:function(e,t){e.setSiblingIndex(t>=parseInt(e.name)?this._cellCount:0),e.name=t.toString()},_addCellsToView:function(){for(var e=0;e<=this._maxCellIndex;++e)this._addCell(e)},_getCell:function(){if(0===this._cellPool.size()){var e=cc.instantiate(this.cell),t=new cc.Node;t.anchorX=.5,t.anchorY=.5;var o=0;if(this.ScrollModel===n.Horizontal){t.width=e.width;var i=Math.floor(this.content.height/e.height);t.height=this.content.height;for(var a=0;a<i;++a)e||(e=cc.instantiate(this.cell)),e.x=(e.anchorX-.5)*e.width,e.y=t.height/2-e.height*(1-e.anchorY)-o,o+=e.height,e.parent=t,e=null}else{t.height=e.height;var r=Math.floor(this.content.width/e.width);t.width=this.content.width;for(var s=0;s<r;++s)e||(e=cc.instantiate(this.cell)),e.y=(e.anchorY-.5)*e.height,e.x=-t.width/2+e.width*e.anchorX+o,o+=e.width,e.parent=t,e=null}this._cellPool.put(t)}return this._cellPool.get()},_getCellSize:function(){var e=this._getCell(),t=e.getContentSize();return this._cellPool.put(e),t},_getGroupCellCount:function(){var e=this._getCell(),t=e.childrenCount;return this._cellPool.put(e),t},clear:function(){if(this.content){for(var e=this.content.childrenCount-1;e>=0;--e)this._cellPool.put(this.content.children[e]);this._cellCount=0,this._showCellCount=0}},reload:function(e){void 0!==e&&(this._data=e);for(var t=this.content.childrenCount-1;t>=0;--t)this._initCell(this.content.children[t],!0)},_getCellPoolCacheName:function(){return this.ScrollModel===n.Horizontal?this.cell.name+"h"+this.content.height:this.cell.name+"w"+this.content.width},_initTableView:function(){this._scheduleInit=!1,this._cellPool&&this.clear();var e=this._getCellPoolCacheName();s._cellPoolCache[e]||(s._cellPoolCache[e]=new cc.NodePool("viewCell")),this._cellPool=s._cellPoolCache[e],this._cellSize=this._getCellSize(),this._groupCellCount=this._getGroupCellCount(),this._count=Math.ceil(this._paramCount/this._groupCellCount),this.ScrollModel===n.Horizontal?(this._view.width=this.node.width,this._view.x=(this._view.anchorX-this.node.anchorX)*this._view.width,this._cellCount=Math.ceil(this._view.width/this._cellSize.width)+1,this.ViewType===r.Flip?this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.width/this._cellSize.width):this._cellCount=this._count,this._showCellCount=this._cellCount,this._pageTotal=1):(this._pageTotal=Math.ceil(this._count/(this._cellCount-1)),this._count=this._pageTotal*(this._cellCount-1),this._showCellCount=this._cellCount-1):this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.width/this._cellSize.width):this._cellCount=this._count,this._showCellCount=this._cellCount):this._showCellCount=this._cellCount-1,this.content.width=this._count*this._cellSize.width,this.stopAutoScroll(),this.scrollToLeft()):(this._view.height=this.node.height,this._view.y=(this._view.anchorY-this.node.anchorY)*this._view.height,this._cellCount=Math.ceil(this._view.height/this._cellSize.height)+1,this.ViewType===r.Flip?this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.height/this._cellSize.height):this._cellCount=this._count,this._showCellCount=this._cellCount,this._pageTotal=1):(this._pageTotal=Math.ceil(this._count/(this._cellCount-1)),this._count=this._pageTotal*(this._cellCount-1),this._showCellCount=this._cellCount-1):this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.height/this._cellSize.height):this._cellCount=this._count,this._showCellCount=this._cellCount):this._showCellCount=this._cellCount-1,this.content.height=this._count*this._cellSize.height,this.stopAutoScroll(),this.scrollToTop()),this._changePageNum(1-this._page),this._lastOffset=this.getScrollOffset(),this._minCellIndex=0,this._maxCellIndex=this._cellCount-1,this._addCellsToView(),this._initSuccess=!0},initTableView:function(e,t){this._paramCount=e,this._data=t,this._loadSuccess?this._scheduleInit||this._initTableView():(this.ScrollModel===n.Horizontal?(this.horizontal=!0,this.vertical=!1):(this.vertical=!0,this.horizontal=!1),this.verticalScrollBar&&this.verticalScrollBar.node.on("size-changed",function(){this._updateScrollBar(this._getHowMuchOutOfBoundary())},this),this.horizontalScrollBar&&this.horizontalScrollBar.node.on("size-changed",function(){this._updateScrollBar(this._getHowMuchOutOfBoundary())},this),this._addListenerToTouchLayer(),this._setStopPropagation(),this.node.getComponent(cc.Widget)||this._view.getComponent(cc.Widget)||this.content.getComponent(cc.Widget)?(this.scheduleOnce(this._initTableView),this._scheduleInit=!0):this._initTableView(),this._loadSuccess=!0)},stopAutoScroll:function(){this._scheduleInit?this.scheduleOnce(function(){this.stopAutoScroll()}):(this._scrollDirection=i.None,cc.ScrollView.prototype.stopAutoScroll.call(this))},scrollToBottom:function(e,t){this._scheduleInit?this.scheduleOnce(function(){this.scrollToBottom(e,t)}):(this._scrollDirection=i.Up,cc.ScrollView.prototype.scrollToBottom.call(this,e,t))},scrollToTop:function(e,t){this._scheduleInit?this.scheduleOnce(function(){this.scrollToTop(e,t)}):(this._scrollDirection=i.Down,cc.ScrollView.prototype.scrollToTop.call(this,e,t))},scrollToLeft:function(e,t){this._scheduleInit?this.scheduleOnce(function(){this.scrollToLeft(e,t)}):(this._scrollDirection=i.Rigth,cc.ScrollView.prototype.scrollToLeft.call(this,e,t))},scrollToRight:function(e,t){this._scheduleInit?this.scheduleOnce(function(){this.scrollToRight(e,t)}):(this._scrollDirection=i.Left,cc.ScrollView.prototype.scrollToRight.call(this,e,t))},scrollToOffset:function(e,t,o){if(this._scheduleInit)this.scheduleOnce(function(){this.scrollToOffset(e,t,o)});else{var a=this.getScrollOffset(),r=e.sub(a);this.ScrollModel===n.Horizontal?r.x>0?this._scrollDirection=i.Left:r.x<0&&(this._scrollDirection=i.Rigth):r.y>0?this._scrollDirection=i.Up:r.y<0&&(this._scrollDirection=i.Down),cc.ScrollView.prototype.scrollToOffset.call(this,e,t,o)}},scrollToCell:function(e,t,o){var n=this._cellSize,i=n.height*e-this.content.parent.height/2+n.height/2;this.scrollToOffset(cc.v2(0,i),t,o)},addScrollEvent:function(e,t,o){var n=new cc.Component.EventHandler;n.target=e,n.component=t,n.handler=o,this.scrollEvents.push(n)},removeScrollEvent:function(e){for(var t in this.scrollEvents){if(this.scrollEvents[t].target===e)return void this.scrollEvents.splice(t,1)}},clearScrollEvent:function(){this.scrollEvents=[]},addPageEvent:function(e,t,o){var n=new cc.Component.EventHandler;n.target=e,n.component=t,n.handler=o,this.pageChangeEvents.push(n)},removePageEvent:function(e){for(var t in this.pageChangeEvents){if(this.pageChangeEvents[t].target===e)return void this.pageChangeEvents.splice(t,1)}},clearPageEvent:function(){this.pageChangeEvents=[]},scrollToNextPage:function(){this.scrollToPage(this._page+1)},scrollToLastPage:function(){this.scrollToPage(this._page-1)},scrollToPage:function(e){if(this.ViewType===r.Flip&&e!==this._page&&!(e<1||e>this._pageTotal)){var t=.3*Math.abs(e-this._page);if(this._changePageNum(e-this._page),this._initSuccess){var o=this._view.width,n=this._view.height;o=(this._page-1)*o,n=(this._page-1)*n,this.scrollToOffset({x:o,y:n},t)}else this.scheduleOnce(function(){var e=this._view.width,o=this._view.height;e=(this._page-1)*e,o=(this._page-1)*o,this.scrollToOffset({x:e,y:o},t)})}},getCells:function(e){var t=this,o=function(){var o=[],n=function e(t,o){if(t.length<=1)return t;for(var n=Math.floor(t.length/2),i=t[n],a=[],r=[],s=0;s<t.length;s++)s!==n&&(o?o(t[s],i)?a.push(t[s]):r.push(t[s]):t[s]<=i?a.push(t[s]):r.push(t[s]));return e(a,o).concat([i],e(r,o))}(t.content.children,function(e,t){return parseInt(e.name)<parseInt(t.name)});for(var i in n){var a=n[i];for(var r in a.children)o.push(a.children[r])}e(o)};this._initSuccess?o():this.scheduleOnce(o)},getData:function(){return this._data},getGroupsRange:function(e){var t=this,o=function(){for(var o=[],n=t._minCellIndex;n<=t._maxCellIndex;n++)o.push(n);e(o)};this._initSuccess?o():this.scheduleOnce(o)},_changePageNum:function(e){this._page+=e,this._page<=0?this._page=1:this._page>this._pageTotal&&(this._page=this._pageTotal);var t=!0,o=!1,n=void 0;try{for(var i,a=this.pageChangeEvents[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.emit([this._page,this._pageTotal])}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}},_touchstart:function(e){this.ScrollModel===n.Horizontal?this.horizontal=!1:this.vertical=!1},_touchmove:function(e){if(this.horizontal===this.vertical){var t=e.getStartLocation(),o=e.getLocation();if(this.ScrollModel===n.Horizontal){if(Math.abs(o.x-t.x)<=7)return}else if(Math.abs(o.y-t.y)<=7)return;this.ScrollModel===n.Horizontal?this.horizontal=!0:this.vertical=!0}},_touchend:function(e){this.ScrollModel===n.Horizontal?this.horizontal=!0:this.vertical=!0,this.ViewType===r.Flip&&this._pageTotal>1&&this._pageMove(e)},_pageMove:function(e){var t=this._view.width,o=this._view.height;if(this.ViewType===r.Flip){var a=this.getScrollOffset(),s=this.getMaxScrollOffset();if(this.ScrollModel===n.Horizontal){if(a.x>=0||a.x<=-s.x)return;if(o=0,Math.abs(e.getLocation().x-e.getStartLocation().x)>this._view.width/4)if(this._scrollDirection===i.Left){if(!(this._page<this._pageTotal))return;this._changePageNum(1)}else if(this._scrollDirection===i.Rigth){if(!(this._page>1))return;this._changePageNum(-1)}}else{if(a.y>=s.y||a.y<=0)return;if(t=0,Math.abs(e.getLocation().y-e.getStartLocation().y)>this._view.height/4)if(this._scrollDirection===i.Up){if(!(this._page<this._pageTotal))return;this._changePageNum(1)}else if(this._scrollDirection===i.Down){if(!(this._page>1))return;this._changePageNum(-1)}}t=(this._page-1)*t,o=(this._page-1)*o,this.scrollToOffset({x:t,y:o},.3)}},_getBoundingBoxToWorld:function(e){var t=e.convertToWorldSpace(cc.v2(0,0));return cc.rect(t.x,t.y,e.width,e.height)},_updateCells:function(){if(this.ScrollModel===n.Horizontal){if(this._scrollDirection===i.Left){if(this._maxCellIndex<this._count-1){var e=this._getBoundingBoxToWorld(this._view);do{var t=this.content.getChildByName(String(this._minCellIndex)),o=this._getBoundingBoxToWorld(t);if(!(o.xMax<=e.xMin))break;t.x=this.content.getChildByName(String(this._maxCellIndex)).x+t.width,this._minCellIndex++,this._maxCellIndex++,this._setCellAttr(t,this._maxCellIndex),o.xMax+(this._maxCellIndex-this._minCellIndex+1)*t.width>e.xMin&&this._initCell(t)}while(this._maxCellIndex!==this._count-1)}}else if(this._scrollDirection===i.Rigth&&this._minCellIndex>0){var a=this._getBoundingBoxToWorld(this._view);do{var r=this.content.getChildByName(String(this._maxCellIndex)),s=this._getBoundingBoxToWorld(r);if(!(s.xMin>=a.xMax))break;r.x=this.content.getChildByName(String(this._minCellIndex)).x-r.width,this._minCellIndex--,this._maxCellIndex--,this._setCellAttr(r,this._minCellIndex),s.xMin-(this._maxCellIndex-this._minCellIndex+1)*r.width<a.xMax&&this._initCell(r)}while(0!==this._minCellIndex)}}else if(this._scrollDirection===i.Up){if(this._maxCellIndex<this._count-1){var c=this._getBoundingBoxToWorld(this._view);do{var l=this.content.getChildByName(String(this._minCellIndex)),u=this._getBoundingBoxToWorld(l);if(!(u.yMin>=c.yMax))break;l.y=this.content.getChildByName(String(this._maxCellIndex)).y-l.height,this._minCellIndex++,this._maxCellIndex++,this._setCellAttr(l,this._maxCellIndex),u.yMin-(this._maxCellIndex-this._minCellIndex+1)*l.height<c.yMax&&this._initCell(l)}while(this._maxCellIndex!==this._count-1)}}else if(this._scrollDirection===i.Down&&this._minCellIndex>0){var h=this._getBoundingBoxToWorld(this._view);do{var d=this.content.getChildByName(String(this._maxCellIndex)),p=this._getBoundingBoxToWorld(d);if(!(p.yMax<=h.yMin))break;d.y=this.content.getChildByName(String(this._minCellIndex)).y+d.height,this._minCellIndex--,this._maxCellIndex--,this._setCellAttr(d,this._minCellIndex),p.yMax+(this._maxCellIndex-this._minCellIndex+1)*d.width>h.yMin&&this._initCell(d)}while(0!==this._minCellIndex)}},_getScrollDirection:function(){var e=this.getScrollOffset(),t=this._lastOffset;this._lastOffset=e,e=e.sub(t),this.ScrollModel===n.Horizontal?e.x>0?this._scrollDirection=i.Rigth:e.x<0?this._scrollDirection=i.Left:this._scrollDirection=i.None:e.y<0?this._scrollDirection=i.Down:e.y>0?this._scrollDirection=i.Up:this._scrollDirection=i.None},update:function(e){cc.ScrollView.prototype.update.call(this,e),this._initSuccess&&this._cellCount!==this._showCellCount&&1!==this._pageTotal&&(this._getScrollDirection(),this._updateCells())}});s._tableView=[],s.reload=function(){for(var e in s._tableView)s._tableView[e].reload()},s.clear=function(){for(var e in s._tableView)s._tableView[e].clear()},cc.tableView=window.tableView=t.export=s,cc._RF.pop()},{}],viewCell:[function(e,t,o){"use strict";cc._RF.push(t,"8050b8ocaBMMapm2smDpJvw","viewCell");var n=cc.Class({extends:cc.Component,properties:{tableView:{default:null,visible:!1},_isCellInit_:!1,_longClicked_:!1},_cellAddMethodToNode_:function(){this.node.clicked=this.clicked.bind(this)},_cellAddTouch_:function(){},_cellInit_:function(e){this.tableView=e},_longClicked:function(){this._longClicked_=!1,this.node.emit(cc.Node.EventType.TOUCH_CANCEL),this.longClicked()},longClicked:function(){},clicked:function(){},init:function(e,t,o,n){},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){!0===this.node.active&&0!==this.node.opacity&&(this._longClicked_||(this._longClicked_=!0,this.scheduleOnce(this._longClicked,1.5)))},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(){this._longClicked_&&(this._longClicked_=!1,this.unschedule(this._longClicked))},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.clicked(),this._longClicked_&&(this._longClicked_=!1,this.unschedule(this._longClicked))},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){this._longClicked_&&(this._longClicked_=!1,this.unschedule(this._longClicked))},this)},onDisable:function(){this.node.targetOff(this)}});cc.viewCell=window.viewCell=t.exports=n,cc._RF.pop()},{}]},{},["Common","CommonNode","Define","SubViewController","GameManager","LoadingManager","SceneBase","AniManager","DoorLayer","GameLayer","GameUI","LoadingLayer","GuideLayer","HonorMissionCell","HonorPanel","PddCouponPanel","PddGoodsPanel","PropGetPanel","PropUsePanel","RankCell","RankPanel","ResultPanel","RevivePanel","ShortcutGetPanel","ShortcutPanel","TestPanel","TipsPanel","Block","CouponAni","DelayShowButton","HonorIcon","PropNode","RewardButton","ScoreEffect","ShortcutButton","UnAutoGreyButton","PPToggle","tableView","viewCell","DateTimerHandler","GameHandler","HonorHandler","HonorMission","ReportHandler","ServerHandler","ShapeBlocks","ShapeFactory","ShortcutHandler","Server","WxSDK+Controller","WxSDK+Post","WxSDK+Reprot","WxSDK+Share","WxSDK","InsideAds2","JNodePool","ADSNode","FeedbackBtn","GameClubBtn","UserInfoBtn","WxBtn","pddSDK","sdk","ActionBase","DragNode","FollowController","LanguageController","LoadingNodeBase","PopLayerBase","SwitchNode","ToastBase","UnitBase","CCActionConvert","CCConvert","ConfigHandler","DataHandler","LanguageHandler","SettingHandler","PP","PPNodePool","PPNodePoolExtend","Base64","ClassModule","EventCenter","FileUtils","LoaderUtils","SoundUtils","StorageUtils","TaskStackHandler"]);